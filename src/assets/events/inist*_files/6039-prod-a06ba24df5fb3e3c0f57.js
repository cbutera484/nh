"use strict";(globalThis.webpackChunk_multimediallc_cb_ts=globalThis.webpackChunk_multimediallc_cb_ts||[]).push([[6039],{4316:(e,t,i)=>{i.d(t,{s:()=>a});var s=i(7623),o=i(8423),n=i(1779);class l{constructor(e,t){this.player=document.createElement("video"),this.source=document.createElement("source"),this.loadedData=!1,this.player.style.minHeight="135px",this.player.style.cursor="pointer",this.player.style.margin="auto",this.player.dataset.testid="user-video",this.player.oncontextmenu=e=>(e.preventDefault(),!1),this.player.setAttribute("webkit-playsinline",""),this.player.setAttribute("playsinline",""),this.player.setAttribute("preload","auto"),this.player.setAttribute("autoplay","true"),this.player.controls=e,this.player.muted=t}addSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video/mp4";this.source=document.createElement("source"),this.source.type=t,this.source.src=e,this.player.appendChild(this.source),this.player.load()}removeSource(){this.source.parentElement===this.player&&(this.source.src="",this.player.removeChild(this.source))}play(){function e(e){"AbortError"===e.name||error(`DOMError: playing video ${e}`)}if((0,s.lT)())try{this.player.play()}catch(t){e(t)}else this.player.play().then(()=>{}).catch(e)}pause(){this.player.pause()}}const h=window.videojs,r=window.Hls;class a extends l{constructor(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var l,h,r;(super(e,t),this.videojsActive=!1,this.activatedEvent=new o.c_("videoJSActivated"),this.opts={techOrder:["html5"],html5:{hlsjsConfig:{maxMaxBufferLength:240,manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:500,maxRetryDelayMs:1e3},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:3,retryDelayMs:500,maxRetryDelayMs:1e3},errorRetry:{maxNumRetry:3,retryDelayMs:1e3,maxRetryDelayMs:2e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:500,maxRetryDelayMs:1e3},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e3}}},startFragPrefetch:!0}},fluid:!0,children:["mediaLoader","posterImage","textTrackDisplay","bigPlayButton","controlBar","errorDisplay","textTrackSettings","resizeManager"],userActions:{doubleClick:()=>{}},controlBar:{children:["playToggle","progressControl","currentTimeDisplay","timeDivider","durationDisplay"],volumePanel:!1}},this.player.style.minHeight="",void 0!==this.opts.controlBar&&!1!==this.opts.controlBar)&&(i&&(null===(l=this.opts.controlBar.children)||void 0===l||l.push("muteToggle"),this.opts.controlBar.muteToggle={},(0,s.OF)()||(null===(h=this.opts.controlBar.children)||void 0===h||h.push("volumeControl"),this.opts.controlBar.volumeControl={})),((0,n.T1)()||(0,s.OF)())&&(null===(r=this.opts.controlBar.children)||void 0===r||r.push("fullscreenToggle")),t&&(this.opts.muted=!0),this.player.setAttribute("class","video-js vjs-big-play-centered vjs-cbcustom"))}activateVideoJS(){this.videojsActive||(this.videojsActive=!0,void 0!==h.Html5Hlsjs&&h.Html5Hlsjs.addHook("beforeinitialize",(e,t)=>{t.on(r.Events.MANIFEST_LOADED,(e,t)=>{debug("MANIFEST_LOADED",t)}),t.on(r.Events.MANIFEST_LOADED,()=>{t.startLoad()}),t.on(r.Events.LEVEL_SWITCHED,()=>{debug("LEVEL_SWITCHED")})}),this.videojsPlayer=h(this.player,this.opts),this.videojsPlayer.addClass("vjs-cbcustom"),this.videojsPlayer.addClass("vjs-has-started"),this.videojsPlayer.autoplay(!0),this.activatedEvent.fire(void 0),this.videojsPlayer.qualityPickerPlugin())}addSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video/mp4";this.activateVideoJS(),this.videojsPlayer.src({src:e,type:t})}removeSource(){this.videojsActive&&this.videojsPlayer.reset()}die(){this.videojsActive&&this.videojsPlayer.reset()}play(){if(!this.videojsActive)return;const e=this.videojsPlayer.play();void 0!==e&&e.catch(e=>{"AbortError"===e.name||error(`DOMError: playing video ${e}`)})}pause(){this.videojsActive&&this.videojsPlayer.pause()}}},6039:(e,t,i)=>{i.d(t,{R3:()=>K});var s=i(7623),o=i(6784),n=i(2709),l=i(3955),h=i(7407),r=i(2146),a=i(4947),d=i(9447),c=i(9512),p=i(213),m=i(5216),y=i(6844),u=i(8423),g=i(74),v=i(9461),x=i(1679),C=i(5330),f=i(7773);const S=new u.c_("photosetPurchasedEvent");class b extends n.u{constructor(e,t,i){super(),this.photoset=e,this.context=t,this.sizing=i,this.mediaSection=document.createElement("div"),this.bottomSection=document.createElement("div"),this.hiResLink=document.createElement("a"),this.element.style.display="block",this.element.style.position="relative",this.element.style.width="100%",this.element.style.height="auto",this.mediaSection.style.width="100%",this.mediaSection.style.height="auto",this.mediaSection.style.minHeight="200px",this.element.appendChild(this.mediaSection),this.bottomSection.style.width="100%",this.bottomSection.style.height="40px",this.bottomSection.style.position="relative";const s=document.createElement("div");if(s.dataset.testid="created-at",(0,d.fZ)(s,"createdAt"),s.style.height="20px",s.style.lineHeight="20px",s.style.position="absolute",s.style.top="0px",s.style.right="8px",s.style.fontSize="12px",s.style.textAlign="right",s.style.marginTop="2px",s.textContent=`${a.R.uploadedText} ${this.photoset.created}`,this.bottomSection.appendChild(s),this.photoset.isVideo&&!this.photoset.videoHasSound&&!this.photoset.pendingApproval){const e=document.createElement("div");e.style.height="20px",e.style.lineHeight="20px",e.style.position="absolute",e.style.top="0px",e.style.left="8px",e.style.fontSize="12px",e.style.textAlign="left",e.style.marginTop="2px",e.textContent=`${a.R.audioRemovedText}`,this.bottomSection.appendChild(e)}(0,d.fZ)(this.hiResLink,"link"),this.hiResLink.style.display="none",this.hiResLink.style.height="20px",this.hiResLink.style.lineHeight="20px",this.hiResLink.style.position="absolute",this.hiResLink.style.top="0px",this.hiResLink.style.left="0px",this.hiResLink.style.fontSize="12px",this.hiResLink.style.textAlign="left",this.hiResLink.style.marginTop="2px",this.hiResLink.target="_blank",this.hiResLink.dataset.testid="hi-res-link",this.hiResLink.onmouseenter=()=>{this.hiResLink.style.textDecoration="underline"},this.hiResLink.onmouseleave=()=>{this.hiResLink.style.textDecoration="none"},this.photoset.isVideo||(this.hiResLink.textContent=a.R.hiResImage),this.bottomSection.appendChild(this.hiResLink),this.element.appendChild(this.bottomSection),this.photoset.userCanAccess||this.addLockOverlay()}next(){}previous(){}playPause(){}resize(e){this.sizing=e,void 0!==this.lockOverlay&&this.lockOverlay.parentElement===this.mediaSection&&(this.lockOverlay.style.width=`${this.sizing.maxPhotoWidth}px`,this.lockOverlay.style.height=`${this.sizing.placeholderHeight}px`,void 0!==this.lockPurchaseBlock&&(this.lockPurchaseBlock.style.left=(this.sizing.maxPhotoWidth-f.bk)/2+"px",this.lockPurchaseBlock.style.top=(this.sizing.placeholderHeight-f.C3)/2+"px"))}confirmLoggedIn(e){(0,y.ok)()&&(v.Bm.current.isMobile?g.pL.fire(!1):(0,p.mf)(e,()=>{g.pL.fire(!1)}))}purchasePhotoset(){(0,y.ok)()?g.pL.fire(!1):v.Bm.current.isNoninteractiveUser?(0,p.Q$)(a.R.internalStaffPurchase):(0,p.mf)(this.photoset.isVideo?a.R.purchaseVideoText(this.photoset.tokens):a.R.purchasePhotosText(this.photoset.numPhotos,this.photoset.tokens),()=>{(0,m.KF)(`photo_videos/purchase_photoset/${this.photoset.id}/`,{pvTab:"True"}).then(e=>{const t=new c.N6(e.responseText);t.getBoolean("success")?((0,h.bT)("PhotosetPurchased",{photoset_id:this.photoset.id}),S.fire(this.photoset.id),this.photoset.userCanAccess=!0,this.removeLockOverlay(),this.loadContent()):void 0!==t.getStringOrUndefined("error")?t.getBoolean("tokens_error")?(0,x.qr)(`${t.getString("error")}  ${a.R.pressPurchaseTokens}`,v.Bm.current.PurchaseEventSources.TOKEN_SOURCE_PURCHASE_MEDIA):(0,x.qr)(t.getString("error"),v.Bm.current.PurchaseEventSources.TOKEN_SOURCE_LOW_TOKEN_BALANCE):(0,p.Q$)(this.photoset.isVideo?a.R.purchasedVideo:a.R.purchasedPhotoSet)}).catch(e=>{error("Purchase Error",e)})})}joinFanClub(){(0,y.ok)()?g.pL.fire(!1):this.context.hasFanClub?v.Bm.current.isNoninteractiveUser?(0,p.Q$)(a.R.internalStaffFanClub):(0,p.mf)(a.R.joinFanClubPage(this.context.room),()=>{(0,h.bT)("PhotosetJoinFanclubClicked",{photoset_id:this.photoset.id}),window.location.href=(0,m._Y)(`/fanclub/join/${this.context.room}/`)}):(0,p.Q$)(a.R.fanClubDisabledText(this.context.room))}removeLockOverlay(){void 0!==this.lockOverlay&&this.lockOverlay.parentElement===this.mediaSection&&this.mediaSection.removeChild(this.lockOverlay)}addLockOverlay(){this.lockOverlay=document.createElement("div"),this.lockOverlay.style.position="relative",this.lockOverlay.style.width=`${this.sizing.maxPhotoWidth}px`,this.lockOverlay.style.height=`${this.sizing.placeholderHeight}px`,this.lockOverlay.style.margin="0 auto",this.lockOverlay.style.overflow="hidden",this.lockOverlay.style.zIndex="2";const e=document.createElement("img");e.src=this.photoset.coverUrl,e.style.width="100%",e.style.height="100%",e.style.filter="blur(8px)",this.lockOverlay.appendChild(e),this.lockPurchaseBlock=this.purchaseBlock(),this.lockOverlay.appendChild(this.lockPurchaseBlock),this.mediaSection.appendChild(this.lockOverlay)}purchaseBlock(){const e=document.createElement("div");e.style.width=`${f.bk}px`,e.style.height=`${f.C3}px`,e.dataset.testid="media-purchase-block",(0,d.fZ)(e,"lockOverlayBg"),(0,d.fZ)(e,"rgba"),e.style.borderRadius="10px",e.style.position="absolute",e.style.left=(this.sizing.maxPhotoWidth-f.bk)/2+"px",e.style.top=(this.sizing.placeholderHeight-f.C3)/2+"px",e.style.textAlign="center";const t=document.createElement("div");t.style.width="100%";const i=document.createElement("div");var s;(0,d.fZ)(i,"previewText"),i.style.fontSize="16px",i.style.height="40px",i.dataset.testid="unlock-text",i.textContent=this.photoset.isVideo?a.R.unlockVideoText(`${(s=this.photoset.videoDuration)>60?`${a.R.minutes(Math.floor(s/60))} `:""}${a.R.seconds(s%60)}`):a.R.unlockPhotosText(this.photoset.numPhotos),t.appendChild(i);let o=40;switch((0,C.HC)(this.photoset,this.context.hasFanClub).labelType){case C.s5:const e=this.createButton(a.R.joinFanClubTextCAPS(w(this.context.room)),()=>{this.joinFanClub()}),i=document.createElement("div");(0,d.fZ)(i,"previewText"),i.textContent=a.R.orSimple,i.style.fontSize="14px",i.style.height="30px",i.style.lineHeight="30px",i.style.marginBottom="1px";const s=this.createButton(`${this.photoset.tokens} ${a.R.tokenOrTokensTextCAPS(this.photoset.tokens)}`,()=>{this.purchasePhotoset()},!0);t.appendChild(e),t.appendChild(i),t.appendChild(s),o+=80;break;case C.T$:const n=this.createButton(a.R.joinFanClubTextCAPS(w(this.context.room)),()=>{this.joinFanClub()});t.appendChild(n),o+=25;break;case C.x2:const l=this.createButton(`${this.photoset.tokens} ${a.R.tokenOrTokensTextCAPS(this.photoset.tokens)}`,()=>{this.purchasePhotoset()});t.appendChild(l),o+=25}if(this.photoset.isVideo&&!this.photoset.videoHasSound&&!this.photoset.pendingApproval){const e=document.createElement("div");(0,d.fZ)(e,"previewText"),e.style.fontSize="14px",e.style.height="40px",e.style.lineHeight="54px",e.style.marginBottom="1px",e.textContent=`${a.R.audioRemovedText}`,t.appendChild(e)}return t.style.position="relative",t.style.top=(f.C3-o)/2-5+"px",e.appendChild(t),e}replaceHighResLink(e){this.photoset.isVideo||""===e||((0,y.ok)()?(this.hiResLink.href="#",this.hiResLink.style.display="block",this.hiResLink.onclick=e=>{e.preventDefault(),this.confirmLoggedIn(a.R.loggedInToViewHiRes)}):(this.hiResLink.href=(0,m._Y)(e),this.hiResLink.style.display="block"))}createButton(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=document.createElement("div");return s.dataset.testid="unlock-button",s.textContent=e,s.style.width="250px",s.style.lineHeight="25px",s.style.borderWidth="1px",s.style.borderStyle="solid",s.style.borderRadius="4px",s.style.fontSize="12px",s.style.textAlign="center",s.style.cursor="pointer",s.onclick=t,(0,d.fZ)(s,"previewText"),(0,d.fZ)(s,"buttonBgColor"),(0,d.fZ)(s,"buttonBorder"),(0,d.fZ)(s,"rgba"),(0,d.fZ)(s,"gradient"),i&&(0,d.fZ)(s,"grey"),s.style.position="relative",s.style.left="50px",s}}function w(e){return e.length<=18?e.toUpperCase():`${e.substr(0,15)}...`.toUpperCase()}var k=i(5389),P=i(4754),T=i(9650);class E extends b{constructor(e,t,i){super(e,t,i),this.images=[],this.index=0,this.imageCircles=[],this.imageCirclesDiv=document.createElement("div"),this.activeDotIndex=0,this.contentLoaded=!1,this.styleArrows(),this.styleImageCircles(),this.bottomSection.appendChild(this.imageCirclesDiv),this.photoset.userCanAccess&&this.loadContent(),window.setTimeout(()=>{this.repositionChildren()},0)}loadContent(){if(this.contentLoaded)return;this.contentLoaded=!0;const e=()=>({domEl:(new T.Q).element,loaded:!1,url:""});for(;this.images.length<this.photoset.numPhotos;)this.images.push(e());this.mediaSection.appendChild(this.images[0].domEl),this.repositionChildren(),(0,C.Q5)(this.photoset.id).then(t=>{for(t.length!==this.photoset.numPhotos&&(this.photoset.numPhotos=t.length,this.styleImageCircles(),this.showHideArrows());t.length>this.images.length;)this.images.push(e());for(;t.length<this.images.length;)this.images.pop();for(let e=0;e<t.length;e+=1)this.replaceLoadingImage(t[e],e);this.replaceHighResLink(t[0])}).catch(e=>{this.contentLoaded=!1,error("GetPhotoURLs",e)}),this.showHideArrows()}replaceLoadingImage(e,t){const i=this.images[t];i.url=e;const s=document.createElement("img");s.dataset.testid="media-photo",s.style.height="100%",s.style.width="100%",s.src=e,s.dataset.testid="user-photo",s.onload=()=>{let e,t;for(i.loaded=!0,s.naturalWidth>s.naturalHeight?(e=Math.min(s.naturalWidth,this.sizing.maxPhotoWidth),t=Math.floor(e*s.naturalHeight/s.naturalWidth)):(t=Math.min(s.naturalHeight,this.sizing.maxPhotoWidth,f.ay),e=Math.floor(t*s.naturalWidth/s.naturalHeight)),i.domEl.style.background="none",i.domEl.style.width=`${e}px`,i.domEl.style.height=`${t}px`;null!==i.domEl.firstChild;)i.domEl.removeChild(i.domEl.firstChild);i.domEl.appendChild(s),this.repositionChildren()}}repositionChildren(){super.repositionChildren();const e=e=>{this.arrowContainers.repositionArrows(e),this.imageCirclesDiv.style.left=(this.sizing.detailWidth-this.imageCirclesDiv.offsetWidth)/2+"px"},t=this.images[this.index];if(void 0===t)return void e(this.mediaSection.offsetHeight);if(!t.loaded){const i=t.domEl.firstChild;return t.domEl.style.width=`${this.sizing.maxPhotoWidth}px`,t.domEl.style.height=`${this.sizing.placeholderHeight}px`,i.style.top=(this.sizing.placeholderHeight-30)/2+"px",i.style.left=(this.sizing.maxPhotoWidth-30)/2+"px",void e(this.sizing.placeholderHeight)}const i=t.domEl.firstChild;let s,o;i.naturalWidth>i.naturalHeight?(s=Math.min(i.naturalWidth,this.sizing.maxPhotoWidth),o=Math.floor(s*i.naturalHeight/i.naturalWidth)):(o=Math.min(i.naturalHeight,this.sizing.maxPhotoWidth,f.ay,window.innerHeight),s=Math.floor(o*i.naturalWidth/i.naturalHeight)),t.domEl.style.width=`${s}px`,t.domEl.style.height=`${o}px`,e(o)}next(){if(this.photoset.numPhotos<2||!this.photoset.userCanAccess)return;const e=this.index;this.index=(this.index+1)%this.photoset.numPhotos,this.changeActiveCircle(),this.changeActiveImage(e)}previous(){if(this.photoset.numPhotos<2||!this.photoset.userCanAccess)return;const e=this.index;0===this.index?this.index=this.photoset.numPhotos-1:this.index-=1,this.changeActiveCircle(),this.changeActiveImage(e)}changeActiveImage(e){const t=this.images[e];t.domEl.parentElement===this.mediaSection&&this.mediaSection.removeChild(t.domEl);const i=this.images[this.index];this.mediaSection.appendChild(i.domEl),this.replaceHighResLink(i.url),this.repositionChildren()}showHideArrows(){this.photoset.numPhotos<2?this.arrowContainers.hideArrows():this.arrowContainers.showArrows()}styleArrows(){this.arrowContainers=new P.m(e=>{this.previous()},e=>{this.next()},this.photoset.userCanAccess),this.showHideArrows(),this.mediaSection.appendChild(this.arrowContainers.leftContainer),this.mediaSection.appendChild(this.arrowContainers.rightContainer)}bigCircle(e){e.style.height="8px",e.style.width="8px",e.style.padding="2px"}mediumCircle(e){e.style.height="6px",e.style.width="6px",e.style.padding="3px"}smallCircle(e){e.style.height="4px",e.style.width="4px",e.style.padding="4px"}styleImageCircles(){for(this.imageCircles=[];null!==this.imageCirclesDiv.firstChild;)this.imageCirclesDiv.removeChild(this.imageCirclesDiv.firstChild);const e=Math.min(5,this.photoset.numPhotos);if(!(e<2)){this.imageCirclesDiv.style.width=12*e+"px",this.imageCirclesDiv.style.height="15px",this.imageCirclesDiv.style.position="absolute",this.imageCirclesDiv.style.marginTop="2px",this.imageCirclesDiv.style.top="0px";for(let t=0;t<e;t+=1){const i=document.createElement("img");this.photoset.numPhotos<=5?this.bigCircle(i):3===t&&5===e?this.mediumCircle(i):4===t&&5===e?this.smallCircle(i):this.bigCircle(i),i.style.display="inline-block",i.src=0===t?`${STATIC_URL}dot-blue.svg`:`${STATIC_URL}dot-gray.svg`,this.imageCircles.push(i),this.imageCirclesDiv.appendChild(i)}}}changeActiveCircle(){if(!(this.imageCircles.length<2))if(this.imageCircles[this.activeDotIndex].src=`${STATIC_URL}dot-gray.svg`,this.index===this.photoset.numPhotos-1?this.activeDotIndex=Math.min(this.imageCircles.length-1,4):this.activeDotIndex=Math.min(this.index,3),this.imageCircles[this.activeDotIndex].src=`${STATIC_URL}dot-blue.svg`,this.photoset.numPhotos<=5)for(const e of this.imageCircles)this.bigCircle(e);else switch(this.activeDotIndex){case 0:case 1:case 2:this.restyleActiveFirstThreeDots();break;case 3:this.restyleActiveFourthDot();break;case 4:this.restyleActiveFifthDot()}}restyleActiveFirstThreeDots(){for(let e=0;e<this.imageCircles.length;e+=1){const t=this.imageCircles[e];e<3?this.bigCircle(t):3===e?this.mediumCircle(t):this.smallCircle(t)}}restyleActiveFourthDot(){for(let e=0;e<this.imageCircles.length;e+=1){const t=this.imageCircles[e];this.index===this.photoset.numPhotos-2&&4===e?this.bigCircle(t):3===this.index&&0===e||4===e||3!==this.index&&1===e||4===e?this.mediumCircle(t):3!==this.index&&0===e?this.smallCircle(t):this.bigCircle(t)}}restyleActiveFifthDot(){for(let e=0;e<this.imageCircles.length;e+=1){const t=this.imageCircles[e];0===e?this.smallCircle(t):1===e?this.mediumCircle(t):this.bigCircle(t)}}}var D=i(8861),L=i(4316);let R=!0;class A extends b{constructor(e,t,i){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(e,t,i),this.autoplay=o,this.videoContainer=document.createElement("div"),this.playing=!1,this.videoDataLoaded=!1,this.contentLoaded=!1,this.videoContainer.style.display="none",this.videoContainer.style.position="relative",this.videoContainer.style.overflow="hidden",this.mediaSection.appendChild(this.videoContainer),this.video=new L.s(!0,R&&(0,s.OF)(),e.videoHasSound),R=!1,this.videoContainer.style.maxWidth=`${this.sizing.maxMediaWidth}px`,this.videoContainer.style.margin="0 auto",this.videoContainer.style.cursor="pointer",this.video.player.style.backgroundColor="black",this.videoContainer.appendChild(this.video.player),this.photoset.userCanAccess&&this.loadContent()}repositionChildren(){let e,t;if(super.repositionChildren(),this.video instanceof L.s){if(!this.video.videojsActive)return;e=this.video.videojsPlayer.videoHeight(),t=this.video.videojsPlayer.videoWidth()}else{if(!this.videoDataLoaded)return;e=this.video.player.videoHeight,t=this.video.player.videoWidth,this.video.player.style.height="auto",this.video.player.style.width="100%"}const i=t/e;let s;s=e>t?window.innerHeight*i-200:t,this.videoContainer.style.maxWidth=`${Math.max(s,300)}px`,this.videoContainer.style.height="auto"}loadContent(){if(this.contentLoaded)return;if(this.contentLoaded=!0,!this.photoset.videoIsReady){const e=new T.Q(!0,!0);return void this.addChild(e,this.mediaSection)}const e=new T.Q(!0);this.addChild(e,this.mediaSection),(0,C.gV)(this.photoset.id).then(t=>{var i,s;const o=e=>{const t=(0,D.oD)(e);void 0!==t&&(localStorage.setItem(e,t),(0,D.Yj)(e))};o("cbv_vol"),o("cbv_mute");const n=null!==(i=localStorage.getItem("cbv_vol"))&&void 0!==i?i:".5",l=null!==(s=localStorage.getItem("cbv_mute"))&&void 0!==s?s:"0";if(this.replaceHighResLink(t),this.video.addSource(t),this.video instanceof L.s){const t=this.video.videojsPlayer;this.video.videojsPlayer.on("loadeddata",()=>{e.parent===this&&this.removeChild(e),t.volume(Number(n)),t.muted("1"===l),this.videoContainer.style.display="block",this.videoDataLoaded=!0,this.repositionChildren()}),this.video.videojsPlayer.on("contextmenu",e=>(e.preventDefault(),e.stopPropagation(),!1)),this.video.videojsPlayer.on("volumechange",()=>{const e=t.volume(),i=t.muted()||0===e?"1":"0";localStorage.setItem("cbv_vol",e.toString()),localStorage.setItem("cbv_mute",i)}),this.video.videojsPlayer.on("play",()=>{this.playing=!0}),this.video.videojsPlayer.on("pause",()=>{this.playing=!1}),this.video.videojsPlayer.on("ended",()=>{this.playing=!1}),this.autoplay||this.video.videojsPlayer.one("play",()=>{this.video.pause()}),this.video.videojsPlayer.on("error",e=>{error(`MediaVideo: VideoJs: ${e.message}`)})}else this.video.player.onloadeddata=()=>{this.removeChild(e),this.video.player.volume=Number(n),this.video.player.muted="1"===l,this.videoContainer.style.display="block",this.videoDataLoaded=!0,this.repositionChildren()},this.video.player.oncontextmenu=e=>(e.preventDefault(),e.stopPropagation(),!1),this.video.player.onvolumechange=()=>{const e=this.video.player.volume,t=this.video.player.muted||0===e?"1":"0";localStorage.setItem("cbv_vol",e.toString()),localStorage.setItem("cbv_mute",t)},this.video.player.onplay=()=>{this.playing=!0},this.video.player.onpause=()=>{this.playing=!1},this.video.player.onended=()=>{this.playing=!1},this.video.player.onerror=e=>{error(`MediaVideo: HTML5: ${e}`)}}).catch(e=>{this.contentLoaded=!1,error(`GetVideoURL: ${e}`)})}playPause(){this.playing?this.video.pause():this.video.play()}}const M=(screen.width/2-425).toString(),$=`resizable,dependent,scrollbars,height=768,width=850,top=${(screen.height/2-384).toString()},left=${M}`;class H extends n.u{constructor(e){super(),this.isCb2=e,this.infoSection=document.createElement("div"),this.mediaSection=document.createElement("div"),this.seen={},this.element.dataset.testid="photo-video-detail",this.element.style.width=`${f.Xw.detailWidth}px`,this.element.style.height="auto",this.element.style.minHeight="10px",this.element.style.position="relative",this.element.style.userSelect="text",this.element.style.webkitUserSelect="text",this.infoSection.style.width="100%",this.infoSection.style.marginBottom="15px",this.mediaSection.style.width="100%",this.mediaSection.style.userSelect="none",this.mediaSection.style.webkitUserSelect="none",this.element.appendChild(this.infoSection),this.element.appendChild(this.mediaSection)}repositionChildren(){this.element.style.width=`${f.Xw.detailWidth}px`,void 0!==this.mediaElement&&this.mediaElement.resize(f.Xw)}clearPhotoset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";this.clearInfoSection(e),this.clearLinks(),void 0!==this.mediaElement&&this.mediaElement.element.parentElement===this.mediaSection&&(this.mediaSection.removeChild(this.mediaElement.element),this.mediaElement=void 0)}replacePhotoset(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.clearPhotoset(),this.replaceInfoSection(e,t),this.addLinks(e,t),void 0!==this.seen[e.id]?this.mediaElement=this.seen[e.id]:(this.mediaElement=e.isVideo?new A(e,t,f.Xw,i):new E(e,t,f.Xw),e.legacyVideo||(this.seen[e.id]=this.mediaElement)),void 0!==this.mediaElement&&(this.addChild(this.mediaElement,this.mediaSection),this.mediaElement.repositionChildrenRecursive(),this.mediaElement.playPause(),o&&((0,s.J8)().scrollTop=this.element.offsetTop-100))}clearInfoSection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";this.infoSection.textContent=e}clearLinks(){if(void 0!==this.actionLinksSection)for(;null!==this.actionLinksSection.firstChild;)this.actionLinksSection.removeChild(this.actionLinksSection.firstChild)}replaceInfoSection(e,t){if(this.infoSection.textContent="",e.failedApproval){const i=document.createElement("div");(0,d.fZ)(i,"errorMessage"),i.style.padding="15px",i.style.borderWidth="1px",i.style.borderStyle="solid",i.style.borderRadius="4px",i.style.margin="5px 0",i.style.fontSize="18px",i.style.whiteSpace="pre-line",i.style.textAlign="center",i.textContent=`${a.R.failedApprovalText}: ${e.rejectionNotes}`,t.isBroadcaster&&(i.textContent+=`\r\n${a.R.removeOffendingItemsText}`),this.infoSection.appendChild(i)}else if(e.videoErrorProcessing){const e=document.createElement("div");(0,d.fZ)(e,"errorMessage"),e.style.padding="15px",e.style.borderRadius="4px",e.style.margin="5px 0",e.style.fontSize="18px",e.style.whiteSpace="pre-line",e.style.textAlign="center",e.textContent=`${a.R.videoProcessingError}`,t.isBroadcaster&&(e.textContent+=`\r\n${a.R.videoReupload}`),this.infoSection.appendChild(e)}const i=document.createElement("div");i.dataset.testid="media-title",(0,d.fZ)(i,"title"),i.style.textAlign="left",i.style.fontSize="18px",i.style.display="block",i.style.fontWeight="bold";const s=document.createElement("span");if(s.textContent=`${e.name}`,i.appendChild(s),!0===this.isCb2){const s=document.createElement("a");s.title=`${a.R.openInNewWindowText}`,s.href=(0,m._Y)(`/photo_videos/photoset/detail/${t.room}/${e.id}/`),s.style.marginLeft="2px",s.style.padding="0 5px";const o=document.createElement("div");(0,d.fZ)(o,"popoutIcon"),o.style.display="inline-block",o.style.height="15px",o.style.width="15px",o.style.position="relative",o.style.top="2px",s.appendChild(o),s.onmouseenter=()=>{s.style.textDecoration="underline"},s.onmouseleave=()=>{s.style.textDecoration="none"},s.onclick=e=>{e.preventDefault(),(0,k.gr)(s.href,"_blank",$)},i.appendChild(s)}if(this.infoSection.appendChild(i),e.isVideo&&!e.videoIsReady&&!e.videoErrorProcessing){const e=document.createElement("div");(0,d.fZ)(e,"videoProcessing"),e.style.textAlign="left",e.style.fontSize="14px",e.style.display="block",e.style.marginTop="15px",e.style.marginBottom="15px",e.style.wordWrap="break-word",e.textContent=a.R.videoBeingProcessed,this.infoSection.appendChild(e)}const o=document.createElement("div");o.dataset.testid="media-description",o.style.textAlign="left",o.style.fontSize="14px",o.style.display="block",o.style.marginTop="15px",o.style.marginBottom="15px",o.style.wordWrap="break-word",o.style.whiteSpace="pre-line",o.textContent=`${e.description}`,this.infoSection.appendChild(o)}addLinks(e,t){(t.isBroadcaster||t.isStaff)&&(void 0===this.actionLinksSection&&(this.actionLinksSection=document.createElement("div"),this.actionLinksSection.style.margin="5px 0",this.element.appendChild(this.actionLinksSection)),(0,C.Q8)(e.id).then(e=>{const t=this.actionLinksSection;if(t.innerHTML=e,this.isCb2){const e=t.querySelectorAll("#broadcaster_links a, #staff_links a");for(const t of e)t.onclick=e=>{e.preventDefault(),(0,k.gr)(t.href,void 0,$)}}const i=t.querySelector("#staff_delete_photoset_button"),s=t.querySelector("#staff_delete_photoset"),o=t.querySelector("#staff_unmute_video_button"),n=t.querySelector("#staff_unmute_video");null!==i&&null!==s&&(i.onclick=()=>{(0,p.mf)("Are you sure you want to remove this item?",()=>{s.submit()})}),null!==o&&null!==n&&(o.onclick=()=>{(0,p.mf)("Are you sure you want to unmute?",()=>{n.submit()})})}).catch(()=>{}))}previous(){void 0!==this.mediaElement&&this.mediaElement.previous()}next(){void 0!==this.mediaElement&&this.mediaElement.next()}playPause(){void 0!==this.mediaElement&&this.mediaElement.playPause()}}var O=i(5581),_=i(5020),I=i(9603);class W extends n.u{constructor(e,t,i){super(),this.photoset=e,this.context=t,this.sizing=i,this.anchor=document.createElement("a"),this.element.style.position="relative",this.element.style.display="inline-block",this.element.style.width=`${this.sizing.cardWidth}px`,this.element.style.height="120px",this.element.style.boxSizing="border-box",this.element.style.margin=`0px ${this.sizing.cardMargin}px ${i.cardMargin+1}px`,this.element.style.verticalAlign="middle",this.element.style.overflow="visible",this.element.dataset.testid="photo-video-preview",(0,s.lT)()||(this.element.title=e.name),this.element.onmouseenter=()=>{this.element.style.cursor="pointer",this.element.style.textDecoration="underline"},this.element.onmouseleave=()=>{this.element.style.cursor="default",this.element.style.textDecoration="none"},this.anchor.href=(0,m._Y)(`/photo_videos/photoset/detail/${this.context.room}/${this.photoset.id}/`),this.anchor.onclick=t=>{t.metaKey||t.ctrlKey||(t.preventDefault(),(0,O.WO)(e,"PVTab"),C.tW.fire({request:{photoset:this.photoset,context:this.context,autoplay:!0,scroll:!0},pushState:!0}))},this.element.appendChild(this.anchor);const o=document.createElement("img");if(o.dataset.testid="photo-video-preview-image",(0,d.fZ)(o,"previewBorder"),o.src=this.photoset.coverUrl,o.width=150,o.height=100,o.style.borderWidth="1px",o.style.borderStyle="solid",o.style.borderRadius="3%",o.style.display="block",this.anchor.appendChild(o),!this.photoset.userCanAccess||this.context.isBroadcaster?this.addPurchaseOverlay():this.photoset.userCanAccess&&this.photoset.userHasPurchased&&this.addPurchasedBadge(),this.photoset.isVideo){const e=document.createElement("img");if(e.src=`${STATIC_URL}video.svg`,e.height=18,e.style.position="absolute",e.style.top="8px",e.style.right="8px",e.dataset.testid="videoIcon",this.anchor.appendChild(e),!this.photoset.videoHasSound&&!this.photoset.pendingApproval){const e=document.createElement("img");e.src=`${STATIC_URL}no-audio.svg`,e.height=18,e.style.position="absolute",e.style.top="8px",e.style.right="32px",e.dataset.testid="noSoundIcon";const t=(0,I.q)({content:a.R.audioRemovedText,hasHTML:!1,width:175,divotPosition:_.Wi.Bottom,divotLeftOrTop:"90px"});t.style.textAlign="center",t.dataset.testid="noSoundTooltip";const i=document.createElement("span");t.appendChild(i),this.anchor.appendChild(t),e.onmouseenter=()=>{t.style.display="block",t.style.left="12px",t.style.top="-50px"},e.onmouseleave=()=>{t.style.display="none"},this.anchor.appendChild(e)}}const n=document.createElement("div");n.dataset.testid="title",(0,d.fZ)(n,"link"),n.textContent=this.photoset.name,n.style.fontSize=`${this.sizing.fontSize}px`,n.style.left="0px",n.style.maxWidth="145px",n.style.whiteSpace="nowrap",n.style.textOverflow="ellipsis",n.style.overflow="hidden",n.style.lineHeight="16px",this.anchor.appendChild(n)}addPurchasedBadge(){const e=document.createElement("span");e.dataset.testid="purchased-badge",(0,d.fZ)(e,"purchasedBadge"),e.style.position="absolute",e.style.top="80px",e.style.right="8px",e.style.padding="1px 3px",e.style.lineHeight="12px",e.style.borderRadius="2px",e.style.fontSize="9px",e.textContent=a.R.purchasedCAPS,this.anchor.appendChild(e)}addPurchaseOverlay(){if((0,C.HC)(this.photoset,this.context.hasFanClub).labelType===C.jC)return;this.lockOverlay=document.createElement("div"),this.lockOverlay.style.height="101px",this.lockOverlay.style.width="151px",this.lockOverlay.style.borderRadius="3%",(0,d.fZ)(this.lockOverlay,"lockOverlayBg"),(0,d.fZ)(this.lockOverlay,"rgba"),this.lockOverlay.style.position="absolute",this.lockOverlay.style.top="0px",this.lockOverlay.style.left="0px";const e=document.createElement("img");e.src=`${STATIC_URL}lock.svg`,e.width=18,e.height=18,e.style.marginLeft="-9px",e.style.marginTop="-9px",e.style.position="absolute",e.style.left="50%",e.style.top="48%",e.style.padding="4px",e.style.border="none",e.dataset.testid="lock-icon",this.lockOverlay.appendChild(e),this.anchor.appendChild(this.lockOverlay),""!==this.photoset.labelText&&(this.badge=document.createElement("span"),(0,d.fZ)(this.badge,"tokenText"),this.badge.innerText=this.photoset.labelText,this.badge.style.backgroundColor=this.photoset.labelColor,this.badge.style.color="#fff",this.badge.style.position="absolute",this.badge.style.bottom="18px",this.badge.style.right="0px",this.badge.style.margin="8px",this.badge.style.fontSize="9px",this.badge.style.padding="1px 3px",this.badge.style.lineHeight="12px",this.badge.style.borderRadius="2px",this.badge.dataset.testid="token-badge",this.anchor.appendChild(this.badge))}removePurchaseOverlay(){void 0!==this.lockOverlay&&this.lockOverlay.parentElement===this.anchor&&(void 0!==this.badge&&this.badge.parentElement===this.anchor&&this.anchor.removeChild(this.badge),this.anchor.removeChild(this.lockOverlay),this.addPurchasedBadge())}}var z=i(1372),B=i(369),j=i(520),F=i(6909);const V={fontSize:"13px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",width:"auto",height:"auto",position:"absolute",display:"none",overflow:"",cursor:"default",top:"0px",left:"0px"},N={width:"149px",maxHeight:"450px",overflowY:"auto",overflowX:"hidden",position:"relative",boxSizing:"border-box",padding:"8px",borderRadius:"0px 4px 4px 4px",WebkitBorderRadius:"0px 4px 4px 4px"};var U;!function(e){e.NewestFirst="Newest First",e.PriceLowToHigh="Price (low to high)",e.PriceHighToLow="Price (high to low)",e.TopSellers="Top Sellers",e.FanclubOnly="Fan Club Only"}(U||(U={}));const Z=[U.NewestFirst,U.PriceLowToHigh,U.PriceHighToLow,U.TopSellers,U.FanclubOnly];class q extends j.s{constructor(e,t){super(e),this.mediaType=t,this.collectionSetsSort=new u.c_("sortCollectionSet"),this.element.dataset.testid="psDropdown",this.element.style.marginTop="5px",this.element.style.boxShadow="rgb(0 0 0 / 20%) 0px 4px 16px 0px",B.oO.listen(()=>{this.isShown()&&this.hideElement()})}initAddChildren(){this.connectedOverlay=new X,this.addChild(this.connectedOverlay)}createBaseElement(e){return(0,z.tT)("div",{className:"psSortingDropdown",colorClass:d.aG.tabActiveColor,style:V},(0,z.tT)("div",{className:"psSortingContainer",style:N,colorClass:[d.aG.tabActiveBgColor,"tabBorderNoHover"]},this.createOptions()))}createOptions(){return Z.map(e=>{const t={};return(0,s.Xb)()&&(t.onTouchEnd=()=>{this.collectionSetsSort.fire({mediaType:this.mediaType,sortDirection:e})}),(0,z.tT)("div",{...t,className:"psSortingOption",onClick:()=>{this.collectionSetsSort.fire({mediaType:this.mediaType,sortDirection:e})},style:{marginBottom:"1px",padding:"4px",fontSize:"12px",fontWeight:"normal",fontFamily:"UbuntuRegular",cursor:"pointer"}},e)})}}class X extends F.g{positionAndStyle(e,t,i,s){super.positionAndStyle(e,t,i,s),this.element.style.backgroundColor="unset"}}var J;!function(e){e.Picture="picture",e.Video="video"}(J||(J={}));const Q=16;class K extends n.u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this.initialized=!1,this.isShowing=!1,this.dataLoading=!1,this.element.id="PhotoVideos",this.element.style.position="static",this.element.style.padding=`${f.iD+6}px ${f.iD}px ${f.iD}px ${f.iD-f.li-5}px`,this.element.style.boxSizing="border-box",this.element.className="photovideos-container",this.element.tabIndex=-1,this.detailSection=new H(e),this.detailSection.element.style.paddingLeft=`${f.li+5}px`,this.detailSection.element.classList.add("photoVideoDetailSection"),this.detailSection.element.dataset.testid="photo-video-detail-section";const t=document.createElement("div");t.dataset.testid="media-contents",this.element.appendChild(t),(0,r.PF)(this.element,"text"),t.appendChild(this.detailSection.element),this.videoSet=new Y(J.Video),this.videoSet.element.style.position="relative",this.videoSet.element.dataset.testid="video-set-section",this.videoSet.element.style.overflow="visible",t.appendChild(this.videoSet.element),this.pictureSet=new Y(J.Picture),this.pictureSet.element.style.position="relative",this.pictureSet.element.dataset.testid="picture-set-section",t.appendChild(this.pictureSet.element),C.tW.listen(e=>{void 0===e?this.detailSection.clearPhotoset(""):this.detailSection.replacePhotoset(e.request.photoset,e.request.context,e.request.autoplay,e.request.scroll)}),S.listen(e=>{this.photosets=this.photosets.map(t=>(t.id===e&&(t.userCanAccess=!0),t)),this.photosets.filter(t=>t.id===e)[0].isVideo?this.videoSet.removeOverlay(e):this.pictureSet.removeOverlay(e)}),(0,o.wu)("keydown",this.element,e=>{switch(e.keyCode){case 37:e.preventDefault(),e.stopPropagation(),this.detailSection.previous();break;case 32:e.preventDefault(),this.detailSection.playPause();break;case 39:e.preventDefault(),e.stopPropagation(),this.detailSection.next()}}),null!==new URLSearchParams(window.location.search).get("refresh_opener")&&null!==window.opener&&window.opener.location.reload()}initRoom(e,t,i){this.initialized=!0,this.room=e,this.detailSection.clearPhotoset(),this.pictureSet.reset(e),this.videoSet.reset(e),void 0!==t&&this.loadContent(i,!1,t),this.dataLoading=!1,this.isShowing&&this.loadContent(void 0,!1)}repositionChildren(){void 0!==this.parent?(0,f.eJ)(this.parent.element):null!==this.element.parentElement&&(0,f.eJ)(this.element.parentElement),this.pictureSet.repositionChildrenRecursive(),this.videoSet.repositionChildrenRecursive(),this.detailSection.repositionChildrenRecursive()}show(e){if(!this.isShowing)if(this.isShowing=!0,(0,h.bT)("PhotosetTabOpened"),this.element.style.height="",this.element.style.minHeight="250px",this.element.style.width="",this.element.style.padding=`${f.iD+6}px ${f.iD}px ${f.iD}px ${f.iD-f.li-5}px`,void 0!==e&&((0,s.J8)().scrollTop=this.element.offsetTop-100),this.dataLoading){if(void 0!==e)for(const t of this.photosets)t.id===e&&C.tW.fire({request:{photoset:t,context:this.context,autoplay:!1,scroll:!0},pushState:!0})}else this.loadContent(e)}hide(){this.isShowing=!1,this.element.style.height="0px",this.element.style.minHeight="",this.element.style.width="0px",this.element.style.padding="0px"}checkBeforeSwitch(e){e()}loadContent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(!this.initialized)return;const s=this.room;this.dataLoading=!0,this.pictureSet.reset(s),this.videoSet.reset(s);const o=i=>{if(s!==this.room)return;this.context=i;const o=i.photosets.filter(e=>!e.isVideo),n=i.photosets.filter(e=>e.isVideo);if(this.photosets=i.photosets,0===this.photosets.length?(this.detailSection.clearInfoSection(""),this.pictureSet.showNoneText()):(this.pictureSet.context=this.context,this.pictureSet.generateCollectionSection(o),this.videoSet.context=this.context,this.videoSet.generateCollectionSection(n)),0!==this.photosets.length){let i;if(void 0===e||isNaN(e)){const e=this.photosets.filter(e=>e.userCanAccess);i=e.length>0?e[0]:this.photosets[0]}else i=this.photosets.filter(t=>t.id===e)[0];C.tW.fire({request:{photoset:i,context:this.context,autoplay:!1,scroll:t},pushState:!0})}};void 0!==i?o(i):(0,C.kP)(s).then(o)}}class Y extends n.u{constructor(e){super(),this.titleSection=document.createElement("div"),this.toggleSort=document.createElement("div"),this.titleContainer=document.createElement("div"),this.collectionSetDiv=document.createElement("div"),this.showMore=document.createElement("div"),this.sortDirection=U.NewestFirst,this.showMoreClicked=!1,this.collectionType=e,(0,l.ZM)(this.titleContainer,{marginTop:e===J.Picture?"10px":"0px",paddingLeft:`${f.li+5}px`}),(0,l.ZM)(this.titleSection,{textAlign:"left",display:"inline-block",fontSize:"16px",fontWeight:"bold"}),(0,l.ZM)(this.toggleSort,{paddingLeft:"8px",display:"none",fontSize:"14px",cursor:"pointer"}),this.toggleSort.className="psToggleSort",this.toggleSort.dataset.testid="psToggleSort",this.toggleSort.textContent=`Filter by: ${this.sortDirection}`;const t=document.createElement("div");t.className="psDropDownArrow",this.toggleSort.appendChild(t),this.titleContainer.appendChild(this.titleSection),this.titleContainer.appendChild(this.toggleSort),this.element.appendChild(this.titleContainer),this.stylePhotoSetsDiv(),this.collectionSetDiv.classList.add("photoSetsDiv"),this.collectionSetDiv.dataset.testid="photoSetsDiv",this.element.appendChild(this.collectionSetDiv),void 0!==this.psDropdown&&null!==this.psDropdown||(this.psDropdown=new q(this.toggleSort,this.collectionType))}cleanup(){void 0!==this.psDropdown&&null!==this.psDropdown&&document.body.removeChild(this.psDropdown.element)}showNoneText(){const e=document.createElement("div");(0,d.fZ)(e,"psContainer"),e.style.display="inline-block",e.style.padding="0 5px",e.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif";const t=document.createElement("div");(0,d.fZ)(t,"contentText"),t.dataset.testid="noneText",t.style.marginLeft=`${f.li}px`,t.textContent=a.R.noPicsVideos,t.style.height="16px",e.appendChild(t),this.collectionSetsContainer=e,this.collectionSetDiv.appendChild(this.collectionSetsContainer)}removeOverlay(e){this.collectionsets=this.collectionsets.map(t=>(t.id===e&&(t.userCanAccess=!0),t));for(const t of this.collectionsetPreviews)t.photoset.id===e&&t.removePurchaseOverlay()}reset(e){this.toggleSort.style.display="none",this.psDropdown.isShown()&&this.psDropdown.hideElement(),this.room=e,void 0!==this.psDropdownListener&&null!==this.psDropdownListener&&this.psDropdownListener.removeListener(),this.removePhotoVideoSection(),this.replaceTitleSection(!0)}initListener(){this.toggleSort.style.display="inline-block",this.toggleSort.onclick=()=>{(0,s.Xb)()&&(0,l.EF)(this.psDropdown.element,this.toggleSort)&&(this.psDropdown.element.style.marginTop="20px")},this.psDropdownListener=this.psDropdown.collectionSetsSort.listen(e=>{let{sortDirection:t,mediaType:i}=e;if(i===this.collectionType){this.sortDirection=t,this.toggleSort.textContent=`Filter by: ${this.sortDirection}`;const e=document.createElement("div");e.classList.add("psDropDownArrow"),this.toggleSort.appendChild(e),this.sortCollectionSets(this.sortDirection)}},!1)}sortCollectionSets(e){this.emptyCollectionSetContainer();let t=[];switch(e){case U.NewestFirst:t=this.collectionsetPreviews.sort((e,t)=>{const i=e.photoset.id,s=t.photoset.id;return i>s?-1:i<s?1:0});break;case U.PriceLowToHigh:t=this.collectionsetPreviews.sort((e,t)=>{const i=e.photoset.tokens,s=t.photoset.tokens;if(0===i&&i===s){const i=e.photoset.fanClubOnly?1:0,s=t.photoset.fanClubOnly?1:0;return i<s?-1:i>s?1:0}return i<s?-1:i>s?1:0});break;case U.PriceHighToLow:t=this.collectionsetPreviews.sort((e,t)=>{const i=e.photoset.tokens,s=t.photoset.tokens;if(0===i&&i===s){const i=e.photoset.fanClubOnly?1:0,s=t.photoset.fanClubOnly?1:0;return i>s?-1:i<s?1:0}return i>s?-1:i<s?1:0});break;case U.TopSellers:t=this.collectionsetPreviews.sort((e,t)=>{const i=e.photoset.purchaseCount,s=t.photoset.purchaseCount;return i>s?-1:i<s?1:0});break;case U.FanclubOnly:t=this.collectionsetPreviews.filter(e=>{const t=e.photoset.visibility;return this.context.hasFanClub?"fanclub_only"===t||"fanclub_or_purchase"===t:"fanclub_only"===t}).sort((e,t)=>{const i=e.photoset.id,s=t.photoset.id;return i>s?-1:i<s?1:0})}0===t.length&&C.tW.fire(void 0);const i=t.filter(e=>e.photoset.pendingApproval||e.photoset.failedApproval);if(t=t.filter(e=>!e.photoset.pendingApproval&&!e.photoset.failedApproval),this.context.isBroadcaster&&(t=t.concat(i)),void 0!==this.collectionSetsContainer){this.showMoreClicked||(t=t.slice(0,Q));for(const e of t)this.collectionSetsContainer.appendChild(e.element)}const s=this.collectionsets.length===Q?Q:15;!this.showMoreClicked&&t.length>s&&this.addShowMore()}generateCollectionSection(e){this.collectionsetPreviews=[],this.collectionsets=e;const t=document.createElement("div");(0,d.fZ)(t,"psContainer"),t.style.display="inline-block",t.style.padding="0 5px",t.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif";const i=this.collectionsets.length===Q?Q:15;for(let e=0;e<this.collectionsets.length;e++){const s=this.collectionsets[e],o={fontSize:f.J,cardWidth:f.nP,cardMargin:f.li},n=new W(s,this.context,o);this.collectionsetPreviews.push(n),e<i&&t.appendChild(n.element)}this.collectionSetsContainer=t,this.collectionsets.length>Q&&(this.addShowMore(),this.styleShowMore()),this.collectionsets.length>0&&(this.replaceTitleSection(),this.initListener()),this.collectionSetDiv.appendChild(t),this.sortCollectionSets(this.sortDirection)}replaceTitleSection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.titleSection.textContent=e?"":this.collectionType===J.Picture?a.R.roomPicsText(G(this.room)):a.R.roomVidsText(G(this.room))}stylePhotoSetsDiv(){this.collectionSetDiv.style.margin="9px 0",this.collectionSetDiv.style.lineHeight="15px",this.collectionSetDiv.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif"}removePhotoVideoSection(){void 0!==this.collectionSetsContainer&&(this.collectionSetDiv.removeChild(this.collectionSetsContainer),this.collectionSetsContainer=void 0),this.collectionsetPreviews=[]}addMorePhotoVideos(){this.emptyCollectionSetContainer(),void 0!==this.collectionSetsContainer&&this.sortCollectionSets(this.sortDirection)}styleShowMore(){this.showMore.style.position="relative",this.showMore.style.display="inline-block",this.showMore.style.width=`${f.nP}px`,this.showMore.style.height="120px",this.showMore.style.lineHeight="100px",this.showMore.style.boxSizing="border-box",this.showMore.style.margin=`0px ${f.li}px 17px`,this.showMore.style.textAlign="center",this.showMore.style.overflow="hidden",this.showMore.style.verticalAlign="middle",this.showMore.style.cursor="pointer",this.showMore.onmouseenter=()=>{this.showMore.style.textDecoration="underline"},this.showMore.onmouseleave=()=>{this.showMore.style.textDecoration="none"},this.showMore.onclick=()=>{this.showMoreClicked=!0,this.removeShowMore(),this.addMorePhotoVideos()};const e=document.createElement("div");e.dataset.testid="show-more",(0,d.fZ)(e,"showMoreText"),e.style.fontFamily="UbuntuMedium, Arial, Helvetica, sans-serif",e.style.fontSize="14px",e.textContent=this.collectionType===J.Picture?a.R.morePics:a.R.moreVideos,this.showMore.appendChild(e)}removeShowMore(){this.showMore.parentElement===this.collectionSetsContainer&&this.collectionSetsContainer.removeChild(this.showMore)}addShowMore(){this.showMoreClicked=!1,void 0!==this.collectionSetsContainer&&this.collectionSetsContainer.appendChild(this.showMore)}emptyCollectionSetContainer(){if(void 0!==this.collectionSetsContainer){let e=this.collectionSetsContainer.lastElementChild;for(;null!==e;)this.collectionSetsContainer.removeChild(e),e=this.collectionSetsContainer.lastElementChild}}}function G(e){return e.replace(/^\w/,e=>e.toUpperCase())}},7773:(e,t,i)=>{i.d(t,{C3:()=>a,J:()=>o,Xw:()=>c,ay:()=>d,bk:()=>r,eJ:()=>p,iD:()=>s,li:()=>l,nP:()=>n});const s=15,o=14,n=152,l=8,h=n+2*l,r=350,a=240,d=1100,c={detailWidth:704,maxMediaWidth:704,maxPhotoWidth:600,placeholderHeight:396};function p(e){const t=e.offsetWidth;c.detailWidth=Math.max(460,h*Math.floor((t-2*s+2*l)/h)-2*l),c.maxMediaWidth=Math.min(c.detailWidth,1400),c.maxPhotoWidth=c.maxMediaWidth-104,c.placeholderHeight=Math.floor(9*c.maxMediaWidth/16)}},9650:(e,t,i)=>{i.d(t,{Q:()=>l});var s=i(2709),o=i(1224),n=i(7773);class l extends s.u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.isVideo=e,this.loadingImg=document.createElement("img");const i=n.Xw.placeholderHeight,s=this.isVideo?n.Xw.maxMediaWidth:n.Xw.maxPhotoWidth;this.element.style.position="relative",this.element.style.width=`${s}px`,this.element.style.height=`${i}px`,this.element.style.margin="0 auto",this.element.dataset.testid="media-placeholder-image",o.mG.isWhiteLabel||(this.element.style.backgroundImage=`url("${STATIC_URL}no_thumbnail.svg")`,this.element.style.backgroundRepeat="no-repeat",this.element.style.backgroundSize="cover",this.element.style.webkitBackgroundSize="cover",this.element.style.backgroundPosition="center"),t||(this.loadingImg.style.width="30px",this.loadingImg.style.height="30px",this.loadingImg.style.position="absolute",this.loadingImg.style.top="50%",this.loadingImg.style.left="50%",this.loadingImg.style.transform="translate(-50%, -50%)",this.loadingImg.src=`${STATIC_URL}loading.gif`,this.loadingImg.dataset.testid="loading-spinner",this.element.appendChild(this.loadingImg))}repositionChildren(){super.repositionChildren();const e=n.Xw.placeholderHeight,t=this.isVideo?n.Xw.maxMediaWidth:n.Xw.maxPhotoWidth;this.element.style.width=`${t}px`,this.element.style.height=`${e}px`}}}}]);
//# sourceMappingURL=6039-prod-a06ba24df5fb3e3c0f57.js.map