"use strict";(globalThis.webpackChunk_multimediallc_cb_ts=globalThis.webpackChunk_multimediallc_cb_ts||[]).push([[8713],{1456:(e,t,i)=>{i.d(t,{q:()=>y});var s=i(8638),a=i(9512),n=i(9447),o=i(4873),r=i(369),l=i(1848),d=i(2939),c=i(2709),h=i(3955),p=i(8713),m=i(4947),u=i(5216);class g extends o.g2{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("a"),this.isActiveRoom=!1,this.element.classList.add("gender-tab"),this.element.dataset.paction="TopTab",(0,n.fZ)(this.element,"tabElement"),this.isActiveRoom=i,this.isActiveRoom&&this.element.classList.add("active"),void 0!==t&&(this.element.href=(0,u._Y)(t)),this.element.innerText=e,(0,h.ZM)(this.element,g.genderTabStyles),this.updateStyles(),(0,h.JR)(this.element,{ignoreTouch:!0}).listen(e=>{this.updateStyles(),e&&!this.isActiveRoom?this.element.classList.add("hover"):this.element.classList.remove("hover")}),this.onCollapseEvent.listen(()=>{this.updateStyles()})}updateStyles(){this.isActiveRoom?((0,n.fZ)(this.element,"activeRoom"),(0,h.ZM)(this.element,{fontSize:"15px",padding:"4px 11px 4px",maxWidth:"180px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"default",position:"static"})):(0,n.fZ)(this.element,"inactiveRoom"),(0,n.fZ)(this.element,"tabElementLink")}}g.genderTabStyles={width:"",position:"relative",display:"inline-block",cssFloat:"left",boxSizing:"border-box",padding:"5px 11px 4px",marginRight:"2px",fontFamily:"UbuntuMedium, Helvetica, Arial, sans-serif",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px 4px 0 0",fontSize:"13px",textDecoration:"none",cursor:"pointer",lineHeight:"1.3"};var b=i(9268);class y extends c.u{get maxAvailableNonTabSpace(){const e=this.activeRoomTab.element.offsetWidth+this.gendersCollapseTab.element.offsetWidth;return this.tabsRow.element.offsetWidth-e}constructor(e){super(),(0,n.fZ)(this.element,"genderTabs"),(0,n.fZ)(this.element,n.aG.bgColor),(0,n.fZ)(this.element,n.aG.navigationAlt2BgImage),(0,n.fZ)(this.element,n.aG.navigationAlt2BgColor),(0,n.fZ)(this.element,n.aG.tabSectionBorder),(0,h.ZM)(this,{position:"relative",overflow:"visible",padding:"0 10px 0 32px",backgroundPosition:"bottom",boxSizing:"border-box",height:"27px",marginTop:"11px",font:"1em 'UbuntuRegular',Arial,Helvetica,sans-serif"}),this.element.classList.add("top-section"),(0,p.j)()||(0,r.Rk)(this,500,1003,[{name:"paddingLeft",min:8,max:32},{name:"paddingRight",min:4,max:16}]),this.tabsRow=new l.m,(0,h.ZM)(this.tabsRow,{position:"static",overflow:"hidden",height:"27px"});const t=new l.m(this.tabsRow);(0,h.ZM)(t,{overflow:"visible",position:"relative",height:"27px",width:"100%"}),this.activeRoomTab=new g(`${m.R.roomTitleMessage(e)}`,void 0,!0),this.activeRoomTab.element.title=`${(0,a.VE)(e)}'s Cam`,this.activeRoomTab.element.dataset.pactionName="ActiveRoom",this.tabsRow.addChild(this.activeRoomTab),this.createGenderTabs(),this.gendersCollapseTab=new o.Dw(new g(o.Dw.DOTDOTDOT_TEXT).element),this.styleCollapsedDropdown(),this.gendersCollapseTab.element.style.fontSize="13px",this.gendersCollapseTab.setSpacerWidth(10),this.tabsRow.addChild(this.gendersCollapseTab),this.gendersCollapseTab.element.classList.add("nooverlay"),(0,b.Nb)(this.tabsRow.element),this.addChild(t),((0,p.j)()?d.BR:d.X0).listen(e=>{this.setActiveRoomTab(e.dossier.room)})}createGenderTabs(){this.tabsRow.addChild(new g(s.i._({id:"WDelzC",message:"WOMEN"}),"/female-cams/")),this.tabsRow.addChild(new g(s.i._({id:"OyyTfC",message:"MEN"}),"/male-cams/")),this.tabsRow.addChild(new g(s.i._({id:"uQLof0",message:"COUPLES"}),"/couple-cams/")),this.tabsRow.addChild(new g(s.i._({id:"1yC3iy",message:"TRANS"}),"/trans-cams/"))}setActiveRoomTab(e){this.activeRoomTab.element.innerText=`${(0,a.VE)(e)}'s Cam`,this.activeRoomTab.element.title=`${(0,a.VE)(e)}'s Cam`}styleCollapsedDropdown(){(0,h.ZM)(this.gendersCollapseTab.dropDown,{width:"108px",paddingTop:"10px",paddingBottom:"5px"})}}},3128:(e,t,i)=>{i.d(t,{G:()=>l});var s=i(2543),a=i(9447),n=i(2709),o=i(3955),r=i(5963);class l extends n.u{constructor(e){super(),this.roomContentsPadding=4,(0,a.fZ)(this.element,"BaseRoomContents"),(0,o.ZM)(this.element,{position:"relative",display:"block",height:"auto",borderStyle:"solid",borderWidth:"1px",borderRadius:"4px",padding:`${this.roomContentsPadding}px`,margin:"12px 0 17px 12px",overflow:"visible",boxSizing:"border-box",width:"calc(100% - 22px)"});const t=document.createElement("div");if(t.innerText=e.deniedMessage,t.dataset.testid="denied-notice",(0,o.ZM)(t,{fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif",fontSize:"12px",fontWeight:"bold",margin:"13px 0"}),this.element.appendChild(t),e.isFollowing){const t=document.createElement("div");(0,o.ZM)(t,{position:"absolute",top:"16px",right:"16px",height:"20px",width:"150px"}),this.element.appendChild(t);const i=new r.zR(this.element,e.roomName);t.appendChild(i.element),i.showUnfollow(e.followNotificationFrequency),s._g.listen("followingEvent",t=>{t.roomName===e.roomName&&(t.following||i.hideElement())})}}}},3192:(e,t,i)=>{i.d(t,{t3:()=>Fe,UO:()=>De,XS:()=>Ae});var s=i(8638),a=i(6784),n=i(213),o=i(4354),r=i(4947),l=i(9757);class d extends o.y{constructor(){super(),this.hasUnsavedChanges=!1,(0,a.wu)("beforeunload",window,e=>{if(this.hasUnsavedChanges)return e.preventDefault(),r.R.warnOnClosingDirty})}createContent(e){var t,i;t=this.element,i={onDirtyStateChange:e=>{this.hasUnsavedChanges=e}},new(l.c.get("PayPerMessage"))({onDirtyStateChange:null==i?void 0:i.onDirtyStateChange},t)}parseData(e){throw new Error("Method not implemented.")}checkBeforeSwitch(e){this.hasUnsavedChanges?(0,n.mf)(r.R.warnOnClosingDirty,()=>{e()}):e()}}var c=i(753),h=i(9461),p=i(1224),m=i(8423),u=i(6440),g=i(9060),b=i(7407),y=i(8713),f=i(5417),v=i(2709),x=i(6716);class w extends v.u{constructor(){super(),this.element.style.position="static";const e=l.c.get("ContestStats");this.reactComponent=new e({show:!1,withAdditionalDetails:!0,loadRoomRequestFire:e=>x.VZ.fire(e)},this.element)}show(){this.reactComponent.update({show:!0})}hide(){this.reactComponent.update({show:!1})}checkBeforeSwitch(e){e()}}var T=i(6452),_=i(2945),C=i(9512),S=i(9447),k=i(5216),R=i(5020);class E extends v.u{constructor(e){super("ul"),this.context=e,this.isLoading=!1,this.lastLoadedVote=0,this.hasLoadedData=!1,(0,S.fZ)(this.element,"gradient"),(0,S.fZ)(this.element,"SatisfactionRating"),this.element.style.width="",this.element.style.height="",this.element.style.listStyle="none",this.element.style.position="relative",this.element.style.margin="0",this.element.style.padding="0",this.element.style.overflow="visible",this.element.style.cssFloat="right",this.element.style.top="-4px",this.element.style.borderRadius="4px";const t=document.createElement("li");t.style.cssFloat="right",t.style.margin="0",t.style.listStyle="none",this.element.appendChild(t);const i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div");this.ratingHistory=document.createElement("div"),this.ratingHistoryTable=document.createElement("div"),t.appendChild(i),t.appendChild(s),t.appendChild(n),t.appendChild(this.ratingHistory),this.ratingHistory.appendChild(this.ratingHistoryTable),i.style.marginRight="4px",i.style.display="inline-block",i.style.cursor="default",s.style.display="none",n.style.display="none",n.style.position="absolute",n.style.zIndex="1000",n.style.marginTop="6px",n.style.marginLeft="65px",n.style.width="0",n.style.height="0",n.style.borderLeft="5px solid transparent",n.style.borderRight="5px solid transparent",n.style.borderBottom="5px solid #0C6A93",this.ratingHistory.style.display="none",this.ratingHistoryTable.style.display="table",this.ratingHistoryTable.style.width="100%",(0,S.fZ)(s,"tooltip"),(0,S.fZ)(s,S.aG.defaultTooltipColor),s.style.position="absolute",s.style.zIndex="1000",s.style.marginTop="11px",s.style.marginLeft="-120px",s.style.width="225px",s.style.borderWidth="2px",s.style.borderStyle="solid",s.style.padding="0.5em 0.8em 0.8em 2em",s.style.borderRadius="6px",s.style.fontSize="14px",(0,S.fZ)(this.ratingHistory,"ratingHistory"),this.ratingHistory.style.borderWidth="3px",this.ratingHistory.style.borderStyle="solid",this.ratingHistory.style.width="300px",this.ratingHistory.style.height="auto",this.ratingHistory.style.maxHeight="300px",this.ratingHistory.style.overflowX="hidden",this.ratingHistory.style.overflowY="auto",this.ratingHistory.style.borderRadius="5px",this.ratingHistory.style.padding="2px",this.ratingHistory.style.position="absolute",this.ratingHistory.style.zIndex="1000",this.ratingHistory.style.marginTop="11px",this.ratingHistory.style.marginLeft="-165px";const o=this.createSatisfactionSpan(),l=this.createSatisfactionSpan(),d=this.createSatisfactionSpan();i.appendChild(o),i.appendChild(l),i.appendChild(d),o.style.position="relative",o.style.left="3px",d.style.position="relative",d.style.left="-3px",o.appendChild(this.createThumbPlaceholder()),d.appendChild(this.createThumbPlaceholder());const c=document.createElement("span"),h=D(!1),p=document.createElement("span"),m=document.createElement("span"),u=L(!1);l.appendChild(c),l.appendChild(h),l.appendChild(p),l.appendChild(u),l.appendChild(m),(0,S.fZ)(c,"voteText"),c.style.position="relative",c.style.top="-2px",c.style.marginRight="8px",c.style.paddingLeft="4px",p.style.position="relative",p.style.top="-2px",p.style.left="-8px",this.context.votePercent<=65?(0,S.fZ)(p,"lowPercent"):this.context.votePercent<=85?(0,S.fZ)(p,"mediumPercent"):(0,S.fZ)(p,"highPercent"),(0,S.fZ)(m,"voteText"),m.style.position="relative",m.style.top="-2px",m.style.marginLeft="8px",m.style.paddingRight="4px",c.innerText=`${this.context.upVotes}`,p.innerText=`${this.context.votePercent}%`,m.innerText=`${this.context.downVotes}`;const g=(0,R.Wj)("",S.aG.defaultTooltipColor,"150px",3);(0,S.fZ)(g,"divotTop");const b=document.createElement("span"),y=document.createElement("span"),f=document.createElement("span");b.innerText=r.R.thisIsSatisfactionScore,y.innerText=r.R.dataUpdatedOncePerDay,f.innerText=r.R.clickScoreToSeeHistory,s.appendChild(g),s.appendChild(b),s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),s.appendChild(y),s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),s.appendChild(f);let v=!1;t.onmouseover=()=>{v||(s.style.display="block")},t.onmouseleave=()=>{s.style.display="none"};const x=()=>{this.ratingHistory.style.display="none",n.style.display="none",v=!1,(0,a.Pf)("click",document.body,x)};let w=!0;t.onclick=e=>{e.preventDefault(),e.stopPropagation(),v?x():(v=!0,this.ratingHistory.style.display="",n.style.display="",s.style.display="none",(0,a.wu)("click",document.body,x),w&&(w=!1,this.ratingHistoryTable.innerText=`${r.R.fetchingHistory}...`,this.fetchRatingHistory()))},this.ratingHistory.onclick=e=>{e.stopPropagation()},this.ratingHistory.onscroll=()=>{this.isLoading||this.ratingHistory.scrollHeight+this.ratingHistory.scrollTop>=this.ratingHistory.offsetHeight&&this.fetchRatingHistory(this.lastLoadedVote)}}fetchRatingHistory(e){this.isLoading=!0,(0,k.Aw)(`api/ts/tipping/rating-history/?skip=${void 0===e?"":e}`).then(e=>{const t=function(e){const t=new C.N6(e),i={rating_votes:[]},s=t.getList("rating_votes");if(void 0!==s){const e=s.map(e=>({id:e.getNumber("id"),vote:e.getNumber("vote"),comment:e.getString("comment"),datetime:e.getString("datetime")}));i.rating_votes=e}return t.logUnusedDebugging("parse SatisfactionScore RatingHistory"),i}(e.responseText);if(0!==t.rating_votes.length){this.hasLoadedData||(this.ratingHistoryTable.innerText=""),this.isLoading=!1,this.hasLoadedData=!0;for(const e of t.rating_votes)this.ratingHistoryTable.appendChild(new N(e).element),this.lastLoadedVote=e.id}else this.hasLoadedData||(this.ratingHistoryTable.innerText=r.R.noHistoryToShow)}).catch(()=>{})}createSatisfactionSpan(){const e=document.createElement("span");return(0,S.fZ)(e,"satisfactionSpan"),e.style.display="inline-block",e.style.height="21px",e.style.minWidth="8px",e.style.fontFamily="'UbuntuMedium', Arial, Helvetica, sans-serif",e.style.fontSize="14px",e.style.paddingTop="2px",e}createThumbPlaceholder(){const e=document.createElement("span");return e.style.position="relative",e.style.top="1px",e.style.display="inline-block",e.style.height="16px",e.style.width="1px",e}}class N extends v.u{constructor(e){super(),(0,S.fZ)(this.element,"vote"),this.element.style.height="",this.element.style.width="",this.element.style.position="static",this.element.style.display="block",this.element.style.borderWidth="2px",this.element.style.borderStyle="solid",this.element.style.borderRadius="5px",this.element.style.minHeight="16px",this.element.style.margin="2px",this.element.style.padding="5px";const t=this.createCell();let i;const s=this.createCell(),a=document.createElement("span");a.style.marginRight="10px",a.style.display="inline-block",a.style.wordWrap="break-word",a.style.maxWidth="230px";const n=document.createElement("span");if((0,S.fZ)(n,"commentDate"),n.style.marginRight="10px",n.style.display="inline-block",n.style.whiteSpace="nowrap",e.vote>0?(i=D(!0),(0,S.fZ)(this.element,"positiveVote")):(i=L(!1),(0,S.fZ)(this.element,"negativeVote")),i.style.marginRight="16px",e.comment.length>25){a.innerText=`${e.comment.slice(0,22)}...`;const t=document.createElement("span");(0,S.fZ)(t,S.aG.hrefColor),t.innerText="more",t.style.marginLeft="5px",t.style.cursor="pointer",t.onclick=()=>{a.innerText=e.comment},a.appendChild(t)}else 0===e.comment.length?a.style.display="none":a.innerText=e.comment;n.innerText=new Date(e.datetime).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),this.element.appendChild(t),t.appendChild(i),this.element.appendChild(s),s.appendChild(a),s.appendChild(n)}createCell(){const e=document.createElement("div");return e.style.display="table-cell",e.style.verticalAlign="middle",e}}function D(e){const t=document.createElement("span");return t.style.position="relative",t.style.top="1px",t.style.background=`url(${STATIC_URL}thumb_sprites.png) no-repeat 0px ${e?"-16":"0"}px`,t.style.display="inline-block",t.style.height="16px",t.style.width="16px",t.style.marginRight="16px",t}function L(e){const t=document.createElement("span");return t.style.position="relative",t.style.top="1px",t.style.background=`url(${STATIC_URL}thumb_sprites.png) no-repeat -16px ${e?"-16":"0"}px`,t.style.display="inline-block",t.style.height="16px",t.style.width="16px",t}var A=i(9523),F=i(9275),M=i(2543),B=i(7871),O=i(718),P=i(2939),U=i(1452),I=i(5389);class H extends o.y{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.roomDossier=e,(0,S.fZ)(this.element,"appsTab"),this.hideNewLabel=t,P.BR.listen(()=>{this.showing&&this.load()}),P.X0.listen(e=>{e.chatConnection.event.appTabRefresh.listen(()=>{this.showing&&this.load(),void 0!==this.aspPanel&&this.aspPanel.notifyDirectoryPopUpsRefresh()})})}createContent(e){}createCbappsTable(e){const t=document.createElement("table");(0,S.fZ)(t,"table"),t.dataset.testid="cb-panel",t.style.width="850px",t.style.borderWidth="1px",t.style.borderStyle="solid",t.style.borderRadius="5px 5px 0 0",t.style.borderSpacing="0",t.appendChild(this.createCbappsTableHeader()),t.appendChild(this.createCbappsTableFooter());const i=document.createElement("tbody");t.appendChild(i);const s=[`${r.R.activeApp}:`,`${r.R.bot1}:`,`${r.R.bot2}:`,`${r.R.bot3}:`,`${r.R.bot4}:`,`${r.R.bot5}:`];for(let t=0;t<s.length;t+=1){const a=e[`slot${t}`],o=e[`previous_app_${t}`],l=0===t,d=document.createElement("tr");(0,S.fZ)(d,"row");const c=document.createElement("td"),h=document.createElement("legend"),p=document.createElement("td"),m=document.createElement("td");(0,S.fZ)(h,"label"),h.dataset.testid=`app-label-${t}`,h.innerText=s[t],h.style.padding="4px 8px",p.dataset.testid=`app-name-${t}`,void 0===a?((0,S.fZ)(p,"noneSelected"),p.innerText=r.R.noneSelected,p.style.fontStyle="italic"):p.innerText=a;const u=document.createElement("a");if(u.dataset.testid=`choose-app-btn-${t}`,(0,S.fZ)(u,S.aG.hrefColor),m.appendChild(u),m.style.paddingRight="8px",void 0===a?(u.href=(0,k._Y)(l?"/apps/":`/apps/bot/${t}/`),u.onclick=e=>{e.preventDefault(),(0,I.gr)(u.href,"_blank",I.fp)},u.innerText=l?r.R.chooseAnApp:r.R.chooseABot):((0,S.fZ)(u,"deactivate"),u.name=`/app/stop/${t}`,u.innerText=r.R.deactivateText,u.href="#",u.onclick=e=>{e.preventDefault(),(0,k.KF)(`app/stop/${t}/`,{}).then(()=>{this.load()}).catch(()=>{(0,n.Q$)("Error deactivating app")})}),void 0!==o){const e=document.createElement("span"),i=document.createElement("a");(0,S.fZ)(e,"orText"),e.innerText=` ${r.R.orSimple} `,(0,S.fZ)(i,S.aG.hrefColor),i.innerText=`${r.R.restart} "${o.app_name}"`,i.href=(0,k._Y)(`/app/startup/${o.app_slug}/?version=${o.app_version}&slot=${t}`),i.onclick=e=>{e.preventDefault(),(0,I.gr)(i.href,"_blank",I.fp)},m.appendChild(e),m.appendChild(i)}c.style.width="150px",m.style.textAlign="right",i.appendChild(d),c.appendChild(h),d.appendChild(c),d.appendChild(p),d.appendChild(m)}return t}createCbappsTableHeader(){const e=document.createElement("thead"),t=document.createElement("tr"),i=document.createElement("th");return i.dataset.testid="cbapps-header",i.colSpan=3,i.innerText=`v1 ${r.R.appsAndBots}`,i.style.textAlign="left",i.style.fontSize="13px",i.style.borderRadius="5px 5px 0 0",i.style.padding="7px 10px",i.style.fontWeight="normal",(0,S.fZ)(i,"header"),t.appendChild(i),e.appendChild(t),e}createCbappsTableFooter(){const e=document.createElement("tfoot"),t=document.createElement("tr"),i=document.createElement("td");return i.dataset.testid="cbapps-footer",i.innerHTML=r.R.v1AppsAndBotsFooterText(),i.colSpan=3,i.style.padding="7px 10px",i.style.fontSize="12px",t.appendChild(i),e.appendChild(t),e}loadContent(e,t){const i=document.createElement("div"),s=document.createElement("p");s.style.color="red",s.style.fontSize="18px",this.element.appendChild(i);const a=document.createElement("p");if(a.style.width="580px",a.style.fontSize="13px",a.style["-webkit-font-smoothing"]="antialiased",a.innerHTML=r.R.appsTabDescription,a.dataset.test="apps-description",i.appendChild(a),void 0!==t){let e={};void 0!==this.aspPanel&&(e=this.aspPanel.appDirectoryPopUps);const s={authUrl:this.roomDossier.aspAuthUrl,savedApps:[],appDirectoryPopUps:e,hideNewLabel:this.hideNewLabel};s.savedApps=t.items,this.aspPanel=new O.p1(s),i.appendChild(this.aspPanel.render())}else s.textContent=r.R.appsLoadingErrorV2,i.appendChild(s);i.appendChild(document.createElement("br")),void 0!==e?i.appendChild(this.createCbappsTable(e)):(s.textContent=r.R.appsLoadingError,i.appendChild(s))}fetchCbappsData(){const e="api/ts/chat/app-and-bots/";return this.fetchData(e).then(t=>new Promise((i,s)=>{try{i(this.parseData(t.responseText))}catch(t){error("Error parsing response from resource",{path:e,reason:t.toString()}),s(t)}}))}load(){this.showingError=!1,Promise.all((0,U.rO)([this.fetchCbappsData(),(0,B.L8)()])).then(e=>{this.clearContent(),e.every(e=>"rejected"===e.status)?this.showErrorMessage():this.loadContent(...e.map(e=>e.value))}).catch(()=>{})}parseData(e){const t=new C.N6(e),i={slot0:t.getStringOrUndefined("slot0"),slot1:t.getStringOrUndefined("slot1"),slot2:t.getStringOrUndefined("slot2"),slot3:t.getStringOrUndefined("slot3"),slot4:t.getStringOrUndefined("slot4"),slot5:t.getStringOrUndefined("slot5"),previous_app_0:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_0")),previous_app_1:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_1")),previous_app_2:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_2")),previous_app_3:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_3")),previous_app_4:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_4")),previous_app_5:this.parsePreviousApp(t.getObjectStringOrUndefined("previous_app_5"))};return t.logUnusedDebugging("AppsAndBotsTab"),i}parsePreviousApp(e){if(void 0===e)return;const t=new C.N6(e);return{app_slug:t.getString("app_slug"),app_version:t.getString("app_version"),app_name:t.getString("app_name")}}}class Z extends o.y{constructor(e){super(),this.roomDossier=e,this.frameWidth="1180px",this.frameHeight="824px",(0,S.fZ)(this.element,"appsTab"),this.appDirectoryV3Url=h.Bm.current.appDirectoryV3Url,this.authToken=h.Bm.current.appDirectoryAuthToken,this.appDirectoryV3Enabled=h.Bm.current.appDirectoryV3Enabled,this.frame=document.createElement("iframe"),this.element.style.overflow="visible",this.setupMessageListeners(),(0,u.f)("AppDirV3DashboardLayout")&&this.setupIframeResize(),P.BR.listen(()=>{this.showing&&this.load()}),P.X0.listen(e=>{e.chatConnection.event.appTabRefresh.listen(()=>{var e,t,i;null===(e=this.frame.contentWindow)||void 0===e||e.postMessage("asp-tab-refresh",this.appDirectoryV3Url),!this.popOutWindow||null!==(t=this.popOutWindow)&&void 0!==t&&t.closed||null===(i=this.popOutWindow)||void 0===i||i.postMessage("asp-tab-refresh","*")})}),M._g.listen("colorModeChangeRequest",e=>{var t,i,s;null===(t=this.frame.contentWindow)||void 0===t||t.postMessage({func:"colorModeChange",mode:e},this.appDirectoryV3Url),!this.popOutWindow||null!==(i=this.popOutWindow)&&void 0!==i&&i.closed||null===(s=this.popOutWindow)||void 0===s||s.postMessage({func:"colorModeChange",mode:e},"*")})}createContent(e){}parseData(e){return{}}load(){this.showingError=!1,this.loadContent()}setupMessageListeners(){(0,a.wu)("message",window,e=>{var t;e.origin.toLowerCase()===this.appDirectoryV3Url.toLowerCase()&&("getToken"===e.data.func&&(null===(t=this.frame.contentWindow)||void 0===t||t.postMessage({func:"authToken",token:this.authToken},this.appDirectoryV3Url)),"show-cb-showcase"===e.data&&this.beginCbShowcase())})}setupIframeResize(){(0,a.wu)("message",window,e=>{if(e.origin.toLowerCase()===this.appDirectoryV3Url.toLowerCase()&&"resizeIframe"===e.data.func){const t=e.data.height;"number"==typeof t?this.frame.style.height=`${t}px`:error("Height value is invalid:",t)}})}loadContent(){if(void 0===this.container){this.container=document.createElement("div"),this.container.id="app-directory-v3-container";const e=document.createElement("div");if(e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="space-between",e.style.width=this.frameWidth,e.style.alignItems="center",e.appendChild(this.createContentTitle()),e.appendChild(this.createV3Toggle()),this.container.appendChild(e),this.appDirectoryV3Enabled)this.setupIframe(),e.style.maxWidth="100%",this.container.appendChild(this.frame);else{e.style.maxWidth="850px",e.style.marginBottom="-35px",e.style.marginLeft="22px";const t=new H(this.roomDossier,!0);this.container.appendChild(t.element),this.element.style.margin="0",this.element.style.paddingLeft="0",t.show()}this.element.appendChild(this.container)}}setupIframe(){const e=new URL(this.appDirectoryV3Url);e.searchParams.append("darkmode",(0,F.Ec)().toString()),e.searchParams.append("parent",window.location.origin),(0,u.f)("AppDirV3DashboardLayout")&&e.searchParams.append("useDashboardLayout","true"),this.frame.style.width=this.frameWidth,this.frame.style.height=this.frameHeight,this.frame.style.maxWidth="100%",this.frame.style.boxSizing="border-box",this.frame.style.borderStyle="solid",this.frame.style.borderWidth="1px",this.frame.style.borderRadius="5px 5px 0 0",this.frame.style.borderColor="var(--cbr-tooltip-border)",this.frame.allow="clipboard-write; fullscreen",this.frame.src=e.toString(),this.frame.id="app-directory-v3-iframe"}createV3Toggle(){const e=document.createElement("div");e.id="app-directory-v3-toggle";const t=l.c.get("AppDirToggle"),i=this.appDirectoryV3Enabled?"v3":"legacy";return this.appDirToggle=new t({value:i,onChange:e=>{e!==i&&this.showConfirmationPopup(e)},iframeLink:this.appDirectoryV3Url},e),e}switchAppDirectoryVersion(e){(0,k.KF)("/api/public/asp/toggle-v3-appdir/",{mode:e}).then(()=>{window.location.reload()})}hideConfirmationPopup(){this.confirmationModal&&this.confirmationModal.dispose()}showConfirmationPopup(e){const t=l.c.get("AppDirConfirmationModal");if(this.container){const i=document.createElement("div");i.id="app-directory-v3-toggle2",this.confirmationModal=new t({isOpen:!0,onClose:()=>this.hideConfirmationPopup(),onSave:()=>{this.switchAppDirectoryVersion(e)}},i),this.element.appendChild(i)}}finishCbShowcase(){this.appDirToggle.update({showShowcase:!1,onShowcaseClick:void 0})}beginCbShowcase(){this.appDirToggle.update({showShowcase:!0,onShowcaseClick:()=>this.finishCbShowcase()})}enableOutsideClickDetection(){this.outsideClickHandler||(this.outsideClickHandler=e=>{var t;const i=this.frame.getBoundingClientRect();e instanceof MouseEvent&&e.clientX>=i.left&&e.clientX<=i.right&&e.clientY>=i.top&&e.clientY<=i.bottom||null===(t=this.frame.contentWindow)||void 0===t||t.postMessage("outside-click",this.appDirectoryV3Url)},document.addEventListener("mousedown",this.outsideClickHandler),document.addEventListener("touchstart",this.outsideClickHandler))}disableOutsideClickDetection(){this.outsideClickHandler&&(document.removeEventListener("mousedown",this.outsideClickHandler),document.removeEventListener("touchstart",this.outsideClickHandler),this.outsideClickHandler=void 0)}createContentTitle(){const e=document.createElement("p");return e.style.fontFamily="UbuntuBold",e.style.fontWeight="bold",e.style.fontSize="16px",e.style.fontStyle="normal",e.textContent=s.i._({id:"eac4RD",message:"App Directory"}),e}}var $=i(1650),W=i(1372);class V extends o.y{constructor(){super(),this.tableHeaders=[r.R.broadcastDate,r.R.broadcastWeekday,r.R.broadcastLength,r.R.maxViewers,r.R.tokensTotal,r.R.avgTokensPerMin,r.R.avgTokensPerUser,r.R.chatMessagesTotal,r.R.avgMessagesPerUser],this.isLoading=!1,this.broadcasterStreamData=[],this.aggregateStreamData=[],this.daysBack=7,this.statsStartDate=this.calcStartAndEndDate(this.daysBack).start,this.statsEndDate=this.calcStartAndEndDate(this.daysBack).end,this.sortBy="default",this.sortOrder="default",this.handleDateSelection=e=>{const t=parseInt(e.target.value);this.daysBack=t,this.statsStartDate=this.calcStartAndEndDate(t).start,this.statsEndDate=this.calcStartAndEndDate(t).end,this.sortBy="default",this.sortOrder="default",this.getBroadcasterStats()},this.handleSortSelection=e=>{const t=e.target.value,i={default:"default",usersDesc:"maxUsers",tokensDesc:"tokensTotal",messagesDesc:"messagesTotal"};this.sortBy=i[t],this.sortOrder="default"===i[t]?"default":"desc","default"===this.sortOrder?this.getBroadcasterStats():(super.clearContent(),this.createContent())},this.calcStartAndEndDate(this.daysBack),this.getBroadcasterStats()}getBroadcasterStats(){this.isLoading||(this.isLoading=!0,super.clearContent(),(0,k.Aw)(`api/ts/accounts/broadcasters_stats/?start_datetime=${this.statsStartDate}%2000:00:00&end_datetime=${this.statsEndDate}%2000:00:00`).then(e=>{var t,i,s,a,n,o;const r=new C.N6(e.responseText);null!==(i=(t=r.parsed.aggregate_stats).avg_max_users_per_stream)&&void 0!==i||(t.avg_max_users_per_stream=0),null!==(a=(s=r.parsed.aggregate_stats).avg_tokens_per_stream)&&void 0!==a||(s.avg_tokens_per_stream=0),null!==(o=(n=r.parsed.aggregate_stats).avg_messages_per_stream)&&void 0!==o||(n.avg_messages_per_stream=0),this.parseAggregateData(r.parsed.aggregate_stats),this.parseStreamData(r.parsed),this.createContent()}).catch(e=>{debug("error getting broadcaster stats",e)}).finally(()=>{this.isLoading=!1}))}parseStreamData(e){this.broadcasterStreamData=e.stream_stats.map(e=>this.parseData(e))}createContent(){"default"!==this.sortBy&&"default"!==this.sortOrder&&this.sortTableData(this.sortBy,this.sortOrder);const e=(0,W.tT)("div",null,(0,W.tT)("h1",{style:{display:"inline-block"}},"Broadcaster Stats Dashboard"),(0,W.tT)(Y,{aggregateData:this.aggregateStreamData[0],daysBack:this.daysBack,handleDateSelection:this.handleDateSelection}),(0,W.tT)(q,{aggregateData:this.aggregateStreamData[0],sortBy:this.sortBy,sortOrder:this.sortOrder,handleSortSelection:this.handleSortSelection}),(0,W.tT)(z,{aggregateData:this.aggregateStreamData[0]}),(0,W.tT)(G,{headers:this.tableHeaders,data:this.broadcasterStreamData}));(0,S.fZ)(this.element,"TokenStatsTab"),this.element.appendChild(e)}parseData(e){const t=new C.N6(e),i={};return i.broadcastStart=t.getString("broadcast_start_time"),i.broadcastStartTime=new Date(t.getString("broadcast_start_time")).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric",hour12:!0,timeZoneName:"short"}),i.broadcastDayOfWeek=new Date(t.getString("broadcast_start_time")).toLocaleDateString(void 0,{weekday:"long"}),i.timeOnlineNice=t.getString("time_online_nice"),i.broadcastLengthSeconds=Math.round(100*(t.getNumber("broadcast_length_in_secs")+Number.EPSILON))/100,i.maxUsers=Math.round(100*(t.getNumber("max_users_in_stream")+Number.EPSILON))/100,i.tokensTotal=Math.round(100*(t.getNumber("tokens_total_in_stream")+Number.EPSILON))/100,i.avgTokensPerMin=Math.round(100*(t.getNumber("avg_tokens_per_minute")+Number.EPSILON))/100,i.avgTokensPerUser=Math.round(100*(t.getNumber("avg_tokens_per_join")+Number.EPSILON))/100,i.messagesTotal=Math.round(100*(t.getNumber("chat_messages_total_in_stream")+Number.EPSILON))/100,i.avgMessagesPerUser=Math.round(100*(t.getNumber("avg_messages_per_join")+Number.EPSILON))/100,t.logUnusedDebugging("BroadcastStatsTabStreamData"),i}parseAggregateData(e){const t=new C.N6(e),i={avgMaxUsersPerStream:isNaN(Math.round(100*(t.getNumber("avg_max_users_per_stream")+Number.EPSILON))/100)||Math.round(100*(t.getNumber("avg_max_users_per_stream")+Number.EPSILON))/100==0?"-":Math.round(100*(t.getNumber("avg_max_users_per_stream")+Number.EPSILON))/100,avgTokensPerStream:isNaN(Math.round(100*(t.getNumber("avg_tokens_per_stream")+Number.EPSILON))/100)||Math.round(100*(t.getNumber("avg_tokens_per_stream")+Number.EPSILON))/100==0?"-":Math.round(100*(t.getNumber("avg_tokens_per_stream")+Number.EPSILON))/100,avgMessagesPerStream:isNaN(Math.round(100*(t.getNumber("avg_messages_per_stream")+Number.EPSILON))/100)||Math.round(100*(t.getNumber("avg_messages_per_stream")+Number.EPSILON))/100==0?"-":Math.round(100*(t.getNumber("avg_messages_per_stream")+Number.EPSILON))/100};t.logUnusedDebugging("BroadcastStatsTabAggregateData"),this.aggregateStreamData=[],this.aggregateStreamData.push(i)}sortTableData(e,t){"tokensTotal"===e?this.broadcasterStreamData.sort((e,i)=>{var s,a;return null!==(s=e.tokensTotal)&&void 0!==s||(e.tokensTotal=0),null!==(a=i.tokensTotal)&&void 0!==a||(i.tokensTotal=0),"asc"===t?e.tokensTotal-i.tokensTotal:i.tokensTotal-e.tokensTotal}):"maxUsers"===e?this.broadcasterStreamData.sort((e,i)=>{var s,a;return null!==(s=e.maxUsers)&&void 0!==s||(e.maxUsers=0),null!==(a=i.maxUsers)&&void 0!==a||(i.maxUsers=0),"asc"===t?e.maxUsers-i.maxUsers:i.maxUsers-e.maxUsers}):"messagesTotal"===e&&this.broadcasterStreamData.sort((e,i)=>{var s,a;return null!==(s=e.messagesTotal)&&void 0!==s||(e.messagesTotal=0),null!==(a=i.messagesTotal)&&void 0!==a||(i.messagesTotal=0),"asc"===t?e.messagesTotal-i.messagesTotal:i.messagesTotal-e.messagesTotal})}calcStartAndEndDate(e){const t=new Date;t.setDate(t.getDate()+1);const i=new Date;return i.setDate(i.getDate()-e),{start:`${i.getFullYear()}-${i.getMonth()+1}-${i.getDate()}`,end:`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}}}const G=e=>(0,W.tT)("div",null,(0,W.tT)("div",{style:{fontSize:"12px",margin:"30px 0px 5px 0px"}},"Average messages and tokens are calculated per room join"),(0,W.tT)("table",{className:"tokenStatsTable",style:{width:"1000px",padding:"0px",margin:"0px 0px 30px",borderWidth:"1px",borderStyle:"solid",borderCollapse:"collapse",borderColor:"#E0E0E0"}},(0,W.tT)("tr",null,e.headers.map(e=>(0,W.tT)("th",{className:"rowHeader",style:{fontWeight:"normal"}},e))),e.data.map((e,t)=>t%2==0?(0,W.tT)(j,{data:e,evenOrOdd:"rowEven"}):(0,W.tT)(j,{data:e,evenOrOdd:"rowOdd"})))),z=e=>{const t={display:"inline-block",marginRight:"60px"};return(0,W.tT)("div",null,(0,W.tT)("div",null,(0,W.tT)("ul",{style:{listStyle:"none",margin:"60px 0 0 0",paddingLeft:"0px"}},(0,W.tT)("li",{style:t},"Average Max Viewers Per Stream: ",e.aggregateData.avgMaxUsersPerStream),(0,W.tT)("li",{style:t},"Average Tokens Per Stream: ",e.aggregateData.avgTokensPerStream),(0,W.tT)("li",{style:t},"Average Chat Messages Per Stream: ",e.aggregateData.avgMessagesPerStream))))},Y=e=>(0,W.tT)("span",null,(0,W.tT)("select",{style:{display:"inline-block",marginLeft:"calc(100% - 558px)",width:"125px"},onChange:e.handleDateSelection,className:"fieldInput"},7===e.daysBack?(0,W.tT)("option",{selected:!0,value:7,label:"Last 7 Days"}):(0,W.tT)("option",{value:7,label:"Last 7 Days"}),30===e.daysBack?(0,W.tT)("option",{selected:!0,value:30,label:"Last 30 Days"}):(0,W.tT)("option",{value:30,label:"Last 30 Days"}))),q=e=>(0,W.tT)("span",null,(0,W.tT)("select",{style:{display:"inline-block",marginLeft:"10px",width:"225px"},onChange:e.handleSortSelection,className:"fieldInput"},"default"===e.sortBy&&"default"===e.sortOrder?(0,W.tT)("option",{selected:!0,value:"default",label:"Sort By..."}):(0,W.tT)("option",{value:"default",label:"Sort By..."}),"maxUsers"===e.sortBy&&"desc"===e.sortOrder?(0,W.tT)("option",{selected:!0,value:"usersDesc",label:"Max Viewers- High to Low"}):(0,W.tT)("option",{value:"usersDesc",label:"Users - High to Low"}),"tokensTotal"===e.sortBy&&"desc"===e.sortOrder?(0,W.tT)("option",{selected:!0,value:"tokensDesc",label:"Total Tokens- High to Low"}):(0,W.tT)("option",{value:"tokensDesc",label:"Tokens - High to Low"}),"messagesTotal"===e.sortBy&&"desc"===e.sortOrder?(0,W.tT)("option",{selected:!0,value:"messagesDesc",label:"Total Messages- High to Low"}):(0,W.tT)("option",{value:"messagesDesc",label:"Messages - High to Low"}))),j=e=>{var t;const i=(null===(t=e.data.broadcastStart)||void 0===t?void 0:t.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}/i))||["0000-00-00"];return(0,W.tT)("tr",{style:{width:"1000px",padding:"0px",borderWidth:"1px",borderStyle:"solid",borderCollapse:"collapse",overflowX:"scroll",textAlign:"center"},className:e.evenOrOdd},(0,W.tT)("td",null,`${new Date(`${i[0]}T00:00:00`).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}, ${e.data.broadcastStartTime}`),(0,W.tT)("td",null,e.data.broadcastDayOfWeek),(0,W.tT)("td",null,e.data.timeOnlineNice),(0,W.tT)("td",null,e.data.maxUsers),(0,W.tT)("td",null,e.data.tokensTotal),(0,W.tT)("td",null,e.data.avgTokensPerMin),(0,W.tT)("td",null,e.data.avgTokensPerUser),(0,W.tT)("td",null,e.data.messagesTotal),(0,W.tT)("td",null,e.data.avgMessagesPerUser))};var X=i(1673),K=i(1244),J=i(3955);class Q extends o.y{constructor(){super(),(0,S.fZ)(this.element,"GamesTab"),this.setResourceUrl("api/ts/chat/games/")}createContent(e){const t=(e,t)=>{const i=(()=>{const e=document.createElement("table");return(0,J.ZM)(e,{borderCollapse:"collapse",marginBottom:"1em",width:"620px"}),e})(),s=document.createElement("tr"),a=document.createElement("td"),n=document.createElement("legend"),o=document.createElement("td"),l=document.createElement("td");(0,S.fZ)(n,"label"),o.style.color="grey",o.style.fontStyle="italic",o.dataset.testid="selected-game",o.innerText=void 0===e?r.R.noneSelected:e.name;const d=document.createElement("span"),c=document.createElement("a");if(c.href="#",void 0===e){if(c.innerText=r.R.chooseAGame,c.dataset.testid="choose-game-link",c.href=(0,k._Y)("/games/search_games/"),c.onclick=e=>{e.preventDefault(),(0,b.bT)("SelectGameClicked"),window.webRTCStartStop=X.Ve,window.selectGameChange=K.F.selectionChange,(0,I.gr)(c.href,"_blank",I.rR)},d.appendChild(c),void 0!==t){const e=document.createElement("span");(0,S.fZ)(e,"orText"),e.innerText=` ${r.R.orSimple} `,d.appendChild(e);const i=document.createElement("a");i.href="#",i.innerText=`Play "${t.name}" again`,i.onclick=s=>{s.preventDefault(),K.F.selectGame(t.uid).then(t=>{t||(d.removeChild(e),d.removeChild(i))}).catch(()=>{})},d.appendChild(i)}}else c.innerText=r.R.endGame,(0,S.fZ)(c,"deactivate"),c.onclick=e=>{e.preventDefault(),K.F.deselectGame()},d.appendChild(c);return l.appendChild(d),a.style.width="150px",l.style.textAlign="right",i.appendChild(s),a.appendChild(n),n.innerText=`${r.R.activeGame}:`,n.dataset.testid="active-game-label",s.appendChild(a),s.appendChild(o),s.appendChild(l),i},i=document.createElement("div");if(!(0,y.j)()){const s=(()=>{const e=document.createElement("div");return(0,S.fZ)(e,"tabSection"),(0,J.ZM)(e,{width:"620px",margin:"0.5em",padding:"0.25em 1.25em",borderRadius:"4px"}),e})();s.appendChild((e=>{const t=document.createElement("h1");return(0,J.ZM)(t,{fontSize:"1.75em",fontWeight:"bolder"}),t.innerText=e,t.dataset.testid="games-header",t})(r.R.games)),s.appendChild((e=>{const t=document.createElement("p");return t.innerHTML=e.replace(/\s{2,}/gm," "),t.style.width="90%",t})(r.R.gamesText(p.mG.sanitizedSiteName,p.mG.cbGamesUrl))).dataset.testid="games-text";let a=t(e.game_selection,e.previous_game_selection);s.appendChild(a),K.F.selectionChange.listen(i=>{const n=t(i,e.previous_game_selection);s.replaceChild(n,a),a=n,void 0!==i&&(e.previous_game_selection=i)},!1),i.appendChild(s)}this.element.appendChild(i)}parseData(e){const t=new C.N6(e),i={game_selection:this.parseGameSelection(t.getObjectStringOrUndefined("game_selection")),previous_game_selection:this.parseGameSelection(t.getObjectStringOrUndefined("previous_game_selection"))};return t.logUnusedDebugging("GamesTab"),K.F.selectionChange.fire(i.game_selection),i}parseGameSelection(e){if(void 0===e)return;const t=new C.N6(e);return{description:t.getString("description"),gameUrl:t.getString("game_url"),image:t.getString("image_64x64"),name:t.getString("name"),uid:t.getString("uid"),viewers:t.getNumberOrUndefined("viewers")}}}class ee extends o.y{constructor(){super(),this.isSupporter=!1,this.hasRoomLoaded=!1,this.wrapper=document.createElement("td"),(0,S.fZ)(this.element,"MembershipsTab"),(0,u.f)("SupporterCancelFB")&&(this.element.style.position="relative"),P.BR.listen(e=>{this.init(e.dossier)}),P.X0.listen(e=>{this.init(e.dossier)})}show(){if(super.show(),(0,u.f)("SupporterCancelFB")){const e=l.c.get("MembershipDurationContainer");this.reactCancelMembership=new e({cancelled:!1,membershipId:"",expiredAt:""},this.wrapper)}}hide(){super.hide(),(0,u.f)("SupporterCancelFB")&&null!==this.reactCancelMembership&&void 0!==this.reactCancelMembership&&this.reactCancelMembership.dispose()}init(e){this.hasRoomLoaded=!0,this.isSupporter=e.isSupporter,this.setResourceUrl("api/ts/tipping/memberships/"),this.showing&&this.load()}parseData(e){const t=new C.N6(e),i={num_memberships:t.getNumber("num_memberships"),memberships:this.parseMembership(t.getList("memberships")),expired_memberships:this.parseMembership(t.getList("expired_memberships")),active_social_media:this.parseSocialMedia(t.getList("active_social_media")),expired_social_media:this.parseSocialMedia(t.getList("expired_social_media"))};return t.logUnusedDebugging("MembershipsTab"),i}parseMembership(e){if(void 0===e)return[];const t=[];for(const i of e)t.push({type:i.getString("type"),name:i.getString("name"),cost:i.getStringWithNumbers("cost",!1),id:i.getNumberOrUndefined("id"),username:i.getStringOrUndefined("username"),cancelled:i.getBoolean("cancelled",void 0,!1),extendable:i.getBoolean("extendable",void 0,!1),nonrecurring:i.getBoolean("nonrecurring",void 0,!1),expired_at:i.getStringOrUndefined("expired_at"),created_at:i.getStringOrUndefined("created_at")});return t}parseSocialMedia(e){if(void 0===e)return[];const t=[];for(const i of e){const e=i.getMap("social_media");t.push({expiration_string:i.getString("expiration_string"),expires:i.getBoolean("expires"),extend_label:i.getString("extend_label"),extend_url:i.getString("extend_url"),social_media:{extendable:e.getBoolean("extendable"),format_duration:e.getString("format_duration"),id:e.getNumber("id"),owner:e.getString("owner"),title_name:e.getString("title_name"),token_price:e.getNumber("token_price"),is_fanclub_type:e.getBoolean("is_fanclub_type")}})}return t}createContent(e){this.hasRoomLoaded?(e.num_memberships>0?(this.element.appendChild(this.createHeader(r.R.activeMembershipsMessage(e.num_memberships))),this.element.appendChild(document.createElement("br")),this.element.appendChild(this.createMembershipsTable(e.memberships)),this.element.appendChild(this.createSocialMediaTable(e.active_social_media))):this.element.appendChild(this.createEmptyMembership()),e.expired_memberships.length>0&&(this.element.appendChild(this.createHeader(r.R.expiredFanClubMemberships)),this.element.appendChild(document.createElement("br")),this.element.appendChild(this.createExpiredFanClubTable(e.expired_memberships))),e.expired_social_media.length>0&&(this.element.appendChild(this.createHeader(r.R.expiredSocialMediaSubscriptions)),this.element.appendChild(document.createElement("br")),this.element.appendChild(this.createExpiredSocialMediaTable(e.expired_social_media)))):this.showLoadingMessage()}createEmptyMembership(){const e=document.createElement("div"),t=this.createHeader(r.R.noActiveMemberships);if(e.appendChild(t),e.appendChild(document.createElement("br")),!this.isSupporter){const t=document.createElement("span");t.innerHTML=r.R.upgradeToSupporter(`/supporter/upgrade/?source=${h.Bm.current.PurchaseEventSources.SUPPORTER_SOURCE_MEMBERSHIP_TAB}/`),e.appendChild(t)}return e}createHeader(e){const t=document.createElement("h2");return(0,S.fZ)(t,"membershipHeader"),t.innerText=e,t.style.fontSize="1.266em",t.style.fontFamily="'UbuntuMedium', Arial, Helvetica, sans-serif",t.style.fontWeight="normal",t.style.marginBottom="2px",t.style.borderBottomWidth="1px",t.style.borderBottomStyle="solid",t}createMembershipsTable(e){const t=document.createElement("table");for(const i of e){const e=document.createElement("tr"),s=this.createTableData(!0),a=this.createTableData(),n=this.createTableData();if("fanclub"===i.type&&s.appendChild(this.createUsernameLink(i.username)),s.appendChild(document.createTextNode(`${i.name}: `)),!0===i.nonrecurring?a.innerText=`${i.cost} ${r.R.tokenOrTokensText(Number(i.cost),!1)}`:a.innerText=r.R.monthlyCost(String(i.cost)),void 0!==i.expired_at){const e=!0===i.cancelled?r.R.expires:r.R.renews;n.innerText=`${e}: ${new Date(i.expired_at).toLocaleDateString()}`}n.appendChild(this.createDuration(i)),t.appendChild(e),e.appendChild(s),e.appendChild(a),(0,u.f)("SupporterCancelFB")&&"supporter"===i.type?(this.reactCancelMembership.update({cancelled:i.cancelled,membershipId:String(i.id),expiredAt:i.expired_at}),e.appendChild(this.wrapper)):e.appendChild(n)}return t}createDuration(e){const t=document.createElement("div");if(Boolean(e.extendable)){const i=document.createElement("a");(0,S.fZ)(i,S.aG.hrefColor),i.target="_blank",i.href=(0,k._Y)(`/fanclub/join/${e.username}/`),i.innerText=r.R.extendThreeMonths,i.style.display="block",t.appendChild(i)}const i=document.createElement("div");(0,S.fZ)(i,"membershipLightText"),i.innerText=`(${r.R.cantRenew})`,t.appendChild(i),Boolean(e.extendable)&&(i.style.display="none");const s=document.createElement("div");t.appendChild(s);const a=document.createElement("a");(0,S.fZ)(a,S.aG.hrefColor),a.href="#",a.innerText=r.R.cancelText.toLocaleLowerCase(),s.appendChild(a);let o="",l="";return"fanclub"===e.type?(o=r.R.fanclubCancelConfirmMessage(void 0!==e.username?e.username:""),l=r.R.fanclubCancelErrorMessage):"supporter"===e.type&&(o=r.R.supporterCancelConfirmMessage,l=r.R.supporterCancelErrorMessage),a.onclick=t=>{t.preventDefault(),(0,n.mf)(o,()=>{(0,k.KF)("tipping/memberships_panel/",{id:String(e.id)}).then(t=>{"True"===t.responseText.split(",")[1]?(Boolean(e.extendable)||(i.style.display="block"),s.style.display="none"):(i.style.display="none",s.style.display="block")}).catch(e=>{(0,n.Q$)(l)})})},Boolean(e.cancelled)?(Boolean(e.extendable)||(i.style.display="block"),s.style.display="none"):(i.style.display="none",s.style.display="block"),t}createSocialMediaTable(e){const t=document.createElement("table");for(const i of e){const e=document.createElement("tr"),s=this.createTableData(!0),a=this.createTableData(),n=this.createTableData();if(s.appendChild(this.createUsernameLink(i.social_media.owner)),s.appendChild(document.createTextNode(`'s ${i.social_media.title_name}:`)),i.social_media.is_fanclub_type||(a.innerText=`${i.social_media.token_price} ${r.R.tokenOrTokensText(i.social_media.token_price,!1)}`),i.expires){n.innerText=`${r.R.expires}: ${i.expiration_string}`;const e=document.createElement("div");if(i.social_media.extendable){const t=document.createElement("a");(0,S.fZ)(t,S.aG.hrefColor),t.style.display="block",t.innerText=i.extend_label,t.href=(0,k._Y)(i.extend_url),t.onclick=e=>{e.preventDefault(),(0,I.gr)(t.href,"_blank",I.NL)},e.appendChild(t)}else(0,S.fZ)(e,"membershipLightText"),e.innerText=`(${r.R.cantExtend})`;n.appendChild(e)}else{const e=document.createElement("div");(0,S.fZ)(e,"membershipLightText"),e.innerText=i.expiration_string,n.appendChild(e)}t.appendChild(e),e.appendChild(s),e.appendChild(a),e.appendChild(n)}return t}createExpiredSocialMediaTable(e){const t=document.createElement("table");for(const i of e){const e=document.createElement("tr"),s=this.createTableData(!0),a=this.createTableData(),n=this.createTableData();s.appendChild(this.createUsernameLink(i.social_media.owner)),s.appendChild(document.createTextNode(`'s ${i.social_media.title_name}:`)),i.social_media.is_fanclub_type||(a.innerText=`${i.social_media.token_price} ${r.R.tokenOrTokensText(i.social_media.token_price,!1)}`);const o=document.createElement("div");if(i.social_media.extendable){const e=document.createElement("a");(0,S.fZ)(e,S.aG.hrefColor),e.style.display="block",e.innerText=i.extend_label,e.href=(0,k._Y)(i.extend_url),e.onclick=t=>{t.preventDefault(),(0,I.gr)(e.href,"_blank",I.NL)},o.appendChild(e)}else(0,S.fZ)(o,"membershipLightText"),o.innerText=`(${r.R.cantRenew})`;n.appendChild(o),t.appendChild(e),e.appendChild(s),e.appendChild(a),e.appendChild(n)}return t}createExpiredFanClubTable(e){const t=document.createElement("table");for(const i of e){const e=document.createElement("tr"),s=this.createTableData(!0),a=this.createTableData(),n=this.createTableData();"fanclub"===i.type&&s.appendChild(this.createUsernameLink(i.username)),s.appendChild(document.createTextNode(`${i.name}:`)),void 0!==i.expired_at&&n.appendChild(document.createTextNode(`${r.R.expired}: ${new Date(i.expired_at).toLocaleDateString()}`));const o=document.createElement("div");if(Boolean(i.extendable)){const e=document.createElement("a");(0,S.fZ)(e,S.aG.hrefColor),e.href=(0,k._Y)(`/fanclub/join/${i.username}/`),e.innerText=r.R.renew,e.style.display="block",e.target="_blank",o.appendChild(e)}else(0,S.fZ)(o,"membershipLightText"),o.innerText=`(${r.R.cantRenew})`;n.appendChild(o),t.appendChild(e),e.appendChild(s),e.appendChild(a),e.appendChild(n)}return t}createTableData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=document.createElement("td");return(0,S.fZ)(t,"contentText"),t.style.width=e?"330px":"150px",t.style.fontFamily="'UbuntuMedium', Arial, Helvetica, sans-serif",t.style.paddingTop="4px",t}createUsernameLink(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=document.createElement("a");return(0,S.fZ)(t,"username"),t.innerText=(0,C.VE)(e),t.href=(0,k._Y)(`/${e}/`),t.style.font="12px 'UbuntuBold', Arial, Helvetica, sans-serif",t.style.display="inline-block",t}}var te=i(500),ie=i(8861),se=i(2758);const ae=e=>`rmFlgNtfnDis_${e}`;class ne extends v.u{constructor(e){super("div",e)}replaceCookieWithLocalStorage(e){"1"===(0,ie.oD)("rmFlgNtfnDis")&&(0,se.aR)(ae(e),"1",{days:60})}cacheRoomFlagNotificationDismissed(){(0,se.aR)(ae(this.roomName),"1",{days:60})}isEligibleForNotification(e,t){return this.replaceCookieWithLocalStorage(this.roomName),e&&!t&&"1"!==(0,se.y1)(ae(this.roomName))}createBaseElement(e,t){return(0,W.tT)("div",{style:{position:"relative"},"data-testid":"room-flag-notification-container"})}initData(e){var t;this.roomName=e.roomName,this.countryData=(0,te.BL)(null===(t=e.country)||void 0===t?void 0:t.toLowerCase());const i=!(0,te.pR)(this.countryData.flagCode);this.shouldDisplayNotification=!1,e.isBroadcastPage&&this.isEligibleForNotification(i,e.optInFlagDisplay)?this.shouldDisplayNotification=!0:e.optInFlagDisplay&&this.cacheRoomFlagNotificationDismissed()}renderNotification(e){if(!this.shouldDisplayNotification)return;const t=()=>{var t;this.cacheRoomFlagNotificationDismissed(),e.onCleanup(),null===(t=this.reactComponent)||void 0===t||t.dispose()},i=l.c.get("RoomFlagNotification");this.reactComponent=new i({countryCode:this.countryData.flagCode,countryName:this.countryData.flagName,onActivate:async()=>{const i=new FormData;return i.append("opt_in_flag_display","true"),(0,k.KF)("api/ts/accounts/editoptinflagdisplay/",i).then(()=>{t(),e.onActivated()}).catch(()=>{(0,n.Q$)(r.R.preferenceUpdateError)})},onDismiss:t,positioningEl:e.positioningEl},this.element),A.pf.listen(e=>e&&t())}}var oe=i(7623),re=i(8746),le=i(816);const de=()=>(0,W.tT)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},(0,W.tT)("g",{"clip-path":"url(#clip0_10707_246981)"},(0,W.tT)("path",{d:"M9.5 0.5L8.87 1.875L7.5 2.5L8.87 3.13L9.5 4.5L10.125 3.13L11.5 2.5L10.125 1.875M4.5 2L3.25 4.75L0.5 6L3.25 7.25L4.5 10L5.75 7.25L8.5 6L5.75 4.75M9.5 7.5L8.87 8.87L7.5 9.5L8.87 10.125L9.5 11.5L10.125 10.125L11.5 9.5L10.125 8.87",fill:"#288A09"})),(0,W.tT)("defs",null,(0,W.tT)("clipPath",{id:"clip0_10707_246981"},(0,W.tT)("rect",{width:"12",height:"12",fill:"white"}))));var ce=i(6861),he=i(1519),pe=i(7882),me=i(3049),ue=i(2146);class ge extends re.O{constructor(e,t){var i,s;super(e,t,{onSubmitSuccess:e=>{A.Go.fire({allowPrivateShows:"True"===e.get("allow_private_shows"),hasRoomPassword:Boolean(e.get("password_for_cam"))}),A.ek.fire({gender:String(e.get("gender")),subgender:String(e.get("subgender"))}),A.pf.fire("True"===e.get("opt_in_flag_display"));const t=e.get("opt_out_of_sharing_score");if(t!==h){let e;"True"===t?(e="false",h="True"):(e="true",h="False"),(0,b.bT)("SatisfactionScoreSettingsClicked",{Enabled:e})}const i=e.get("language");this.settingsSavedRequest.fire(!0),this.pageReloadNeeded&&!this.formHasChanged()&&((0,g.DV)()&&!p.mG.isWhiteLabel&&this.languageChanged?window.location.href=function(e){const t=`${window.location.pathname}${window.location.search}`;let i=window.location.hostname;-1!==i.indexOf("www.")&&(i=i.replace("www.",""));const s=i.match(/^(?:[a-z]{2}|zh-hans|zh-hant)\./);s&&(i=i.replace(s[0],""));let a="en"===e?i:`${null==e?void 0:e.toString()}.${i}`;return a=window.location.port?`${a}:${window.location.port}`:a,`${window.location.protocol}//${a}${t}`}(i):window.location.reload())},onSubmitError:()=>{this.settingsSavedRequest.fire(!1)},styles:{field:new be,input:new be,select:new ye,checkbox:new ve,multipleSelect:new ve,multipleCheckboxes:new fe}},!0),this.settingsSavedRequest=new m.c_("settingsSavedRequest"),this.pageReloadNeeded=!1,this.languageChanged=!1,this.element.style.paddingBottom="14px";const a=this.getField("toggle_browser_notifications");this.initializeBrowserNotificationCheckbox(a);const n=this.getField("gender"),o=this.getField("subgender"),l=e=>{if(void 0!==o){const t=o.getWidget();e.value===pe.YT.OldTrans||e.value===pe.YT.Trans?(t.style.display="inline",t.focus(),null==n||n.clearError()):(t.style.display="none",t.value="",null==o||o.clearError())}};if(this.placeSubgenderField(),void 0!==n){const e=n.getWidget();l(e),n.setOnChange(()=>{n.getValue()===pe.YT.Couple?n.updateLabelText(r.R.sexTextCouple):n.updateLabelText(r.R.sexText),l(e)})}null===(i=this.getField("language"))||void 0===i||i.setOnChange(()=>{(0,g.DV)()&&!p.mG.isWhiteLabel?(this.pageReloadNeeded=!0,this.languageChanged=!0):this.pageReloadNeeded=!0}),(0,y.j)()||this.removeField("language");const d=this.setupPremiumSection();this.setupFanClubSpying();let c=()=>{};(0,me.YW)()&&(c=this.setupF2FSection()),this.setupPrivatePriceListener(d,c);let h=null===(s=this.getField("opt_out_of_sharing_score"))||void 0===s?void 0:s.getValue();this.setTestIds()}handleAutoSaveAndUnsavedLabels(){const e=new he.a(()=>{this.triggerExternalSubmit()},{debounceType:1,bounceLimitMS:1e3}),t=this.getField("gender"),i=this.getField("subgender");for(const s of Object.keys(this.getFields())){const a=this.getField(s);void 0!==a&&a.fieldChanged.listen(()=>{"subgender"===a.getName()&&(null==t||t.setUnsaved(!0)),"gender"===a.getName()&&!0===(null==i?void 0:i.hasError())&&(null==i||i.clearError()),a.setUnsaved(!0),("gender"!==a.getName()||(null==t?void 0:t.getValue())!==pe.YT.OldTrans&&(null==t?void 0:t.getValue())!==pe.YT.Trans||document.activeElement!==t.getWidget()&&document.activeElement!==(null==i?void 0:i.getWidget()))&&e.callFunc()})}null==i||i.fieldTouched.listen(()=>{""===i.getValue()&&!0===(null==t?void 0:t.unsaved)&&e.callFunc()}),(0,a.wu)((0,oe.p0)(),window,()=>this.triggerExternalSubmit())}setTestIds(){const e={gender:"gender-selection",subgender:"subgender-selection",email:"email",email_when_follow_comes_on:"email-when-follow-comes-on",toggle_browser_notifications:"toggle-browser-notifications",app_dev_subscription:"app-dev-subscription",newsletter_subscription:"newsletter-subscription",show_cam_in_index:"show-cam-in-index",opt_in_flag_display:"opt-in-flag-display",password_for_cam:"password-for-cam",chat_rules:"chat-rules",block_from_countries:"block-from-countries",block_from_states:"block-from-states-regions",opt_out_of_sharing_info:"opt-out-of-sharing-info",opt_out_of_sharing_score:"opt-out-of-sharing-score",allow_private_shows:"allow-private-shows",allow_show_recordings:"allow-show-recordings",private_show_tokens_per_minute:"private-show-tokens-per-minute",private_show_minimum_minutes:"private-show-minimum-minutes",spy_on_private_show_tokens_per_minute:"spy-on-private-show-tokens-per-minute",allow_premium_private_shows:"allow-premium-private-shows",premium_private_show_tokens_per_minute:"premium-private-show-tokens-per-minute",premium_private_show_minimum_minutes:"premium-private-show-minimum-minutes"},t=this.getField("show_cam_to_genders");if(void 0!==t){const e=t.getField().querySelectorAll("input");for(const t of e)null!==t&&(t.dataset.testid="show-cam-to-genders-checkbox")}for(const t in e){const i=this.getField(t);void 0!==i&&(i.getWidget().dataset.testid=e[t])}}placeSubgenderField(){const e=this.getField("gender"),t=this.getField("subgender");if(void 0!==e&&void 0!==t){const i=e.getField().querySelector("td"),s=t.getField().querySelector("td");null!==i&&null!==s&&s.childNodes.forEach(e=>i.appendChild(e))}}createField(e){const t="settings_email"===new URLSearchParams(window.location.search).get("tab"),i=this.overrideBlockLocationField(e);if(void 0!==i)return i;if("toggle_browser_notifications"===e.name)return this.browserNotificationHelpText=document.createElement("div"),new le.Ru({...e,helpText:this.browserNotificationHelpText,onChange:e=>this.onBrowserNotificationCheckboxChange(this.data.extra.signed_username,e),styles:new xe});if("chat_rules"===e.name)return new le.fs({...e,styles:new ce.Gw});const s=this.overrideNotificationField(e);if(void 0!==s)return s;if("EmailField"===e.fieldType)return new le.pd({...e,defaultValue:""===e.defaultValue?r.R.noEmailOnFile:e.defaultValue,helpText:this.createEmailHelpText(this.data.initial[e.name],this.data.extra.verified_email),styles:t?new Te:new we});const a=this.overridePushServiceField(e);if(void 0!==a)return a;const n=this.overrideOptInFlagDisplayField(e);if(void 0!==n)return n;const o=this.overrideF2FFields(e);return void 0!==o?o:super.createField(e)}overrideBlockLocationField(e){return"block_from_countries"===e.name?(0,oe.Xb)()?new le.l6({...e,multiple:!0,styles:new ye}):new le.LP({...e,selectedHeader:r.R.blockedCountries,unselectedHeader:r.R.ableToView,styles:new fe}):"block_from_states"===e.name?(0,oe.Xb)()?new le.l6({...e,multiple:!0,styles:new ye}):new le.LP({...e,selectedHeader:r.R.blockedRegions,unselectedHeader:r.R.ableToView,styles:new fe}):void 0}overrideNotificationField(e){return"email_when_follow_comes_on"===e.name?new le.Ru({...e,onChange:e=>this.onFollowNotificationCheckboxChange(e),styles:new xe}):"app_dev_subscription"===e.name?new le.Ru({...e,onChange:e=>this.onAppDevNotificationCheckboxChange(e),styles:new xe}):"newsletter_subscription"===e.name?new le.Ru({...e,onChange:e=>this.onNewsletterNotificationCheckboxChange(e),styles:new xe}):void 0}overridePushServiceField(e){if("events_url"===e.name)return new le.pd({...e,styles:new _e})}createEmailHelpText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=document.createElement("div");if(""===e){const e=document.createElement("a");(0,S.fZ)(e,S.aG.hrefColor),e.innerText=r.R.addEmailAddress,e.href=(0,k._Y)("/accounts/change_email/"),e.target="_blank",e.dataset.testid="add-email-link",i.appendChild(e)}else if(t){const e=document.createElement("a");(0,S.fZ)(e,S.aG.hrefColor),e.innerText=r.R.changeEmailAddress,e.href=(0,k._Y)("/accounts/change_email/"),e.target="_blank",e.dataset.testid="change-email-link",i.appendChild(document.createTextNode(r.R.emailVerified)),i.appendChild(document.createElement("br")),i.appendChild(e)}else{const e=document.createElement("a");(0,S.fZ)(e,S.aG.hrefColor),e.innerText=r.R.resendVerificationEmail,e.href=(0,k._Y)("/emailvalidation/resend/"),e.target="_blank",e.dataset.testid="resend-email-link",e.onclick=t=>{t.preventDefault(),(0,k.KF)("emailvalidation/resend/",{}).then(()=>{i.replaceChild(document.createTextNode(`${r.R.verificationEmailSent}.`),e)}).catch(()=>{(0,n.Q$)(r.R.emailSendErrorMessage)})};const t=document.createElement("a");(0,S.fZ)(t,S.aG.hrefColor),t.innerText=r.R.changeEmailAddress,t.href=(0,k._Y)("/accounts/change_email/"),t.target="_blank",t.dataset.testid="change-email-link",i.appendChild(document.createTextNode(r.R.emailIsUnverifiedForNotificationsAndNewsletter)),i.appendChild(document.createElement("br")),i.appendChild(e),i.appendChild(document.createElement("br")),i.appendChild(t)}return i}setBrowserNotificationText(e){this.browserNotificationHelpText.innerText=e}fadeOutBrowserNotificationText(e){(0,ue.Ve)(this.browserNotificationHelpText,`opacity ${e}ms`),this.browserNotificationHelpText.style.opacity="0",window.setTimeout(()=>{this.setBrowserNotificationText(""),this.browserNotificationHelpText.style.opacity="1"},e)}initializeBrowserNotificationCheckbox(e){window.isBrowserNotificationSupported()?window.isBrowserNotificationDenied()?(e.setDisabled(!0),this.setBrowserNotificationText("Your browser has notifications off or blocked for this site. You must allow browser notifications in order to use this feature.")):window.isBrowserNotificationSupported()&&window.isSubscribedToBrowserNotifications(!0,()=>{e.setChecked(!0)}):(e.setDisabled(!0),this.setBrowserNotificationText("Browser Notifications are not currently supported on this browser, check back later for when we add support."))}onBrowserNotificationCheckboxChange(e,t){t.setDisabled(!0);const i=t.getChecked();i?window.subscribeUserToPush(e).then(()=>{this.setBrowserNotificationText("Browser notification setting saved."),window.setTimeout(()=>{window.isWebPushBrowserNotificationSupported()&&(t.setDisabled(!1),this.fadeOutBrowserNotificationText(500))},2e3),(0,b.bT)("PushNotificationSettingsUpdated",{new_status:!0,old_status:!1,location:"settings-tab"})}).catch(e=>{t.setDisabled(!0),t.setChecked(!1),void 0!==e&&400===e.status?window.setTimeout(()=>{t.setDisabled(!1),this.setBrowserNotificationText("Invalid subscription sent to server, please retry. If this continues, contact support.")},2e3):this.setBrowserNotificationText("Your browser has notifications off or blocked for this site. You must allow browser notifications in order to use this feature.")}):window.unsubscribeUserFromPush().then(()=>{this.setBrowserNotificationText("Browser notification setting saved."),window.setTimeout(()=>{this.fadeOutBrowserNotificationText(500)},1500),(0,b.bT)("PushNotificationSettingsUpdated",{new_status:!1,old_status:!0,location:"settings-tab"})}).then(()=>{window.setTimeout(()=>{t.setDisabled(!1)},2e3)});const s={checked:i};(0,b.bT)("FollowBrowserNotificationSettingsClicked",s)}onFollowNotificationCheckboxChange(e){const t={checked:e.getChecked()};(0,b.bT)("FollowEmailSettingsClicked",t)}onAppDevNotificationCheckboxChange(e){const t={checked:e.getChecked()};(0,b.bT)("AppDeveloperEmailsSettingsClicked",t)}onNewsletterNotificationCheckboxChange(e){const t={checked:e.getChecked()};(0,b.bT)("NewsletterEmailsSettingsClicked",t)}onOptInFlagDisplayCheckboxChange(e){const t={checked:e.getChecked()};(0,b.bT)("OptInFlagDisplayClicked",t)}overrideOptInFlagDisplayField(e){if("opt_in_flag_display"===e.name)return new le.Ru({...e,onChange:e=>this.onOptInFlagDisplayCheckboxChange(e),styles:new ve})}overrideF2FFields(e){if(["allow_f2f_private_shows","allow_f2f_show_recordings","appear_offline_when_f2f"].includes(e.name)){let t;return t="appear_offline_when_f2f"===e.name?[{label:s.i._({id:"oXOSPE",message:"Online"}),value:"False"},{label:s.i._({id:"6Aih4U",message:"Offline"}),value:"True"}]:[{label:s.i._({id:"1UzENP",message:"No"}),value:"False"},{label:s.i._({id:"l75CjT",message:"Yes"}),value:"True"}],new le.l6({...e,choices:t,styles:new ye})}}setupPremiumSection(){var e,t;const i=this.getField("allow_premium_private_shows"),s=null==i?void 0:i.getWidget(),a=this.getField("private_show_tokens_per_minute"),n=this.getField("allow_private_shows");if(void 0===a||void 0===s||void 0===n)return()=>{};const o=this.getField("premium_private_show_tokens_per_minute"),l=this.getField("spy_on_private_show_tokens_per_minute"),d=null==o?void 0:o.getWidget(),c=null===(e=this.getField("premium_private_show_minimum_minutes"))||void 0===e?void 0:e.getWidget(),h=""!==(null==o?void 0:o.getValue());s.selectedIndex=h?1:0,d.remove(1),d.options[0].text="-",this.updatePremiumAllowed(h,d,c),h?this.updatePremiumPrice(Number(a.getValue()),d,!0):this.updatePremiumPrice(0,d,!0);const p=e=>{void 0!==i&&(i.getHelpTextElement().innerText=0===e?r.R.premiumShowDisabled:r.R.premiumShowDesc)},m=()=>{"False"===n.getValue()?(s.selectedIndex=0,this.updatePremiumAllowed(!1,d,c),this.disableSelector(s)):this.enableSelector(s,!1)};return m(),p(Number(null!==(t=null==l?void 0:l.getValue())&&void 0!==t?t:0)),void 0!==i&&i.setOnChange(()=>{const e="True"===i.getValue();this.updatePremiumAllowed(e,d,c),e&&this.updatePremiumPrice(Number(a.getValue()),d,!0)}),void 0!==l&&l.setOnChange(()=>{p(Number(l.getValue()))}),m}updatePremiumPrice(e,t,i){const s=Number(t.value);let a=!1;for(let n=0;n<t.options.length;n++){const o=t.options[n];""===o.value?o.disabled=!0:Number(o.value)<=e?o.disabled=i:(o.disabled=!1,Number(o.value)!==s&&a||(t.selectedIndex=n),a=!0)}a||(t.selectedIndex=0)}updatePremiumAllowed(e,t,i){e?(this.enableSelector(t,!0),this.enableSelector(i,!1)):(t.options[0].disabled=!1,t.selectedIndex=0,this.disableSelector(t),this.disableSelector(i))}disableSelector(e){(0,S.fZ)(e,"disabled"),(0,J.ZM)(e,{pointerEvents:"none",cursor:"not-allowed"});for(let t=0;t<e.options.length;t++)e.options[t].disabled=!e.options[t].selected}enableSelector(e,t){(0,S.SA)(e,"disabled"),(0,J.ZM)(e,{pointerEvents:"auto",cursor:"auto"});for(let t=0;t<e.options.length;t++)e.options[t].disabled=!1;t&&(e.options[0].disabled=!0)}setupFanClubSpying(){const e=this.getField("fan_club_spy_on_private_show_tokens_per_minute"),t=this.getField("fan_club_cost"),i=this.getField("spy_on_private_show_tokens_per_minute");if(void 0!==e&&void 0!==t&&void 0!==i){const a=e.getHelpTextElement();(new be).styleHelpText(a);const n=e.getWidget();this.updateFanSpyPrice(Number(i.getValue()),e.getWidget());const o=()=>{const o=Number(t.getValue())>0,r=Number(i.getValue())>0;a.style.display="block",a.innerText=s.i._({id:"rNa4cc",message:"'Free' allows Fan Club Members to spy on private shows for no token charge."}),r?o||(a.innerText=s.i._({id:"S5VMn8",message:"Fan club discount for spying on private shows is disabled because your fan club is disabled."})):a.innerText=s.i._({id:"pDlyT1",message:"Fan club discount for spying on private shows is disabled because spying is disabled."}),r&&o?(this.enableSelector(n,!1),this.updateFanSpyPrice(Number(i.getValue()),e.getWidget())):this.disableSelector(n)};n.options[0].text=r.R.disabled,n.options[1].text=r.R.free,o(),t.setOnChange(()=>{o()}),i.setOnChange(()=>{this.updateFanSpyPrice(Number(i.getValue()),e.getWidget()),o()})}}updateFanSpyPrice(e,t){let i,s=!1;const a=t.selectedIndex;for(let n=t.options.length-1;n>=0;n--){const o=t.options[n];Number(o.value)>e?o.disabled=!0:(o.disabled=!1,Number(o.value)===e?i=n:n===a&&(t.selectedIndex=n,s=!0))}0===e||s||(t.selectedIndex=null!=i?i:0)}setupF2FSection(){var e;const t=this.getField("allow_f2f_private_shows"),i=null==t?void 0:t.getWidget(),s=this.getField("private_show_tokens_per_minute"),a=this.getField("allow_private_shows");if(void 0===s||void 0===t||void 0===i||void 0===a)return()=>{};const n=this.getField("f2f_private_show_tokens_per_minute"),o=null==n?void 0:n.getWidget(),r=null===(e=this.getField("f2f_private_show_minimum_minutes"))||void 0===e?void 0:e.getWidget(),l=""!==(null==n?void 0:n.getValue());i.selectedIndex=l?1:0,o.remove(1),o.options[0].text="-",this.updatePremiumAllowed(l,o,r),l||this.updatePremiumPrice(0,o,!0);const d=()=>{"False"===a.getValue()?(i.selectedIndex=0,this.updatePremiumAllowed(!1,o,r),this.disableSelector(i)):this.enableSelector(i,!1)};return d(),t.setOnChange(()=>{const e="True"===t.getValue();this.updatePremiumAllowed(e,o,r),e?this.updatePremiumPrice(Number(s.getValue()),o,!1):this.updatePremiumPrice(0,o,!0)}),d}setupPrivatePriceListener(e,t){var i;const s=this.getField("private_show_tokens_per_minute"),a=this.getField("allow_private_shows");if(void 0===s||void 0===a)return;const n=null===(i=this.getField("premium_private_show_tokens_per_minute"))||void 0===i?void 0:i.getWidget(),o=this.getField("allow_premium_private_shows");s.setOnChange(()=>{const e=Number(s.getValue());"True"===(null==o?void 0:o.getValue())&&this.updatePremiumPrice(e,n,!0)}),a.setOnChange(()=>{e(),(0,me.YW)()&&t()})}}class be extends ce.Dr{styleLabel(e){super.styleLabel(e),e.style.width="100%",e.style.textAlign="left",e.style.padding="0",e.style.margin="0 4px 6px"}styleLabelContainer(e){super.styleLabelContainer(e),e.style.width="auto",e.style.minWidth="345px",e.style.display="",e.style.verticalAlign="top",e.style.paddingLeft="10px"}styleField(e){super.styleField(e),(0,S.SA)(e,"field"),(0,S.fZ)(e,"fieldInput")}styleHelpText(e){super.styleHelpText(e),e.style.width="auto",e.style.maxWidth=""}styleFieldContainer(e){super.styleFieldContainer(e),e.style.verticalAlign="middle",e.style.display=""}}class ye extends be{styleField(e){super.styleField(e),e.style.width=""}}class fe extends ye{styleField(e){super.styleField(e),e.size=10,e.style.height="160px",e.style.width="100%",e.style.marginBottom="10px"}styleLabelContainer(e){super.styleLabelContainer(e),e.style.width="130px"}}class ve extends be{styleFieldContainer(e){super.styleFieldContainer(e),e.style.paddingTop="6px"}styleField(e){(0,S.fZ)(e,"fieldInput")}}class xe extends ve{styleLabelContainer(e){super.styleLabelContainer(e),e.style.minWidth="465px"}}class we extends be{styleField(e){super.styleField(e),e.style.paddingLeft="0",e.style.border="none",e.style.background="none"}}class Te extends we{styleFieldContainer(e){super.styleFieldContainer(e),(0,S.fZ)(e,"highlightFieldContainer"),e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.padding="0 8px 6px 8px",e.style.borderRadius="4px"}styleField(e){super.styleField(e),(0,S.fZ)(e,"highlightField")}styleLabel(e){super.styleLabel(e),(0,S.fZ)(e,"highlightLabel")}}class _e extends be{styleField(e){super.styleField(e),e.style.display="none"}}class Ce extends o.y{constructor(e){super(),this.country=e,this.setResourceUrl("api/ts/accounts/editsettings/")}fetchData(e){return(0,k.Aw)(e)}parseData(e){return re.Z.parseData(e)}createContent(e){this.form=new ge(e,"api/ts/accounts/editsettings/"),this.form.element.dataset.testid="settings-tab-form",this.form.element.style.position="relative",this.addChild(this.form),this.form.prependFieldset(r.R.security),this.form.addFieldToFieldset(new le.ib({name:"security",customElement:this.createSecuritySection()}),r.R.security),this.form.addFieldset(r.R.statistics),this.form.addFieldToFieldset(new le.ib({name:"statistics",customElement:this.createStatisticsSection()}),r.R.statistics);let t="";"events_api_qr_img_data"in e.extra&&(t=e.extra.events_api_qr_img_data),this.updateAuthSection(t),this.form.setSubmitText(r.R.updateSettings),this.form.getSubmitButton().dataset.testid="update-settings-button",this.updateOptInFlagDisplaySection(),this.createSaveSettingsNotice(),Ae.listen(e=>{e===De.SETTINGS&&this.form.triggerExternalSubmit()}),this.createAutoRefillSection(),this.formatF2FSection()}createSaveSettingsNotice(){let e;this.saveNotice=document.createElement("div"),this.saveNotice.innerText=r.R.settingsSaved,(0,J.ZM)(this.saveNotice,{position:"absolute",top:"10px",right:"40px",fontFamily:"UbuntuRegular, Helvetica, Arial, sans-serif",color:"#000000",backgroundColor:"#d8deea",border:"1px solid #acacac",borderRadius:"4px",padding:"8px 12px",visibility:"hidden"}),this.saveNotice.dataset.testid="settings-saved-notice",this.form.element.appendChild(this.saveNotice),(0,a.wu)("scroll",document,()=>{this.setSaveNoticeScroll()}),this.form.settingsSavedRequest.listen(t=>{this.saveNotice.innerText=t?r.R.settingsSaved:r.R.settingsNotSaved,clearTimeout(e),this.saveNotice.style.visibility="visible",this.setSaveNoticeScroll(),e=window.setTimeout(()=>{this.saveNotice.style.visibility="hidden"},3e3)})}setSaveNoticeScroll(){(0,oe.J8)().scrollTop>this.element.offsetTop-15?this.saveNotice.style.top=(0,oe.J8)().scrollTop-this.element.offsetTop+20+"px":this.saveNotice.style.top="10px"}createSecuritySection(){const e=document.createElement("div"),t=this.createSubNav(),i=this.createSubNav(),s=document.createElement("a"),a=document.createElement("a");return e.appendChild(t),e.appendChild(i),t.appendChild(s),i.appendChild(a),(0,S.fZ)(s,S.aG.hrefColor),s.innerText=r.R.updateYourPassword,s.href=(0,k._Y)("/auth/password_change/"),s.target="_blank",s.dataset.testid="change-password-link",(0,S.fZ)(a,S.aG.hrefColor),a.innerText=r.R.viewSecurityCenter,a.href=(0,k._Y)("/security/"),a.target="_blank",a.dataset.testid="security-center-link",e}createStatisticsSection(){const e=document.createElement("div"),t=this.createSubNav(),i=document.createElement("a");return e.appendChild(t),t.appendChild(i),(0,S.fZ)(i,S.aG.hrefColor),i.innerText=r.R.authorizeThirdPartyStats,i.href=(0,k._Y)("/statsapi/authtoken/"),i.target="_blank",i.dataset.testid="authorize-stats-link",e}updateAuthSection(e){var t;const i=r.R.eventsApiSettingsHeader,s=this.form.getFieldset(i);if(void 0===s)return;const a=document.createElement("span");let n=r.R.authSectionInfo(null===(t=this.form.getField("events_url"))||void 0===t?void 0:t.getValue());var o;if(e.length>0&&(n=r.R.authSectionInfo2(null===(o=this.form.getField("events_url"))||void 0===o?void 0:o.getValue())),a.innerHTML=n,null==s||s.prepend(a),e.length>0){const t=document.createElement("img");t.classList.add("responsiveQrCode"),t.src=`data:image/svg+xml;base64,${e}`,t.style.float="left",t.style.marginRight="2rem",t.style.width="111px",t.style.height="111px",null==s||s.prepend(t)}}createAutoRefillSection(){var e;const t=this.form.getFieldset(s.i._({id:"7HAbUZ",message:"Token Auto Refill"}));if(void 0===t)return;this.applyAutoRefillStyles();const i=s.i._({id:"OkPnKF",message:'\n            When your account balance falls below\n            <span class="auto-refill-section-strong">10% of the refill amount</span>,\n            it will be automatically recharged using your saved payment method.\n        '}),a=document.createElement("span");a.innerHTML=i,null===(e=t.parentElement)||void 0===e||e.before(a)}applyAutoRefillStyles(){const e=this.form.getFieldset(s.i._({id:"7HAbUZ",message:"Token Auto Refill"})),t=this.form.element.querySelector("table"),i=this.form.element.parentElement;if(void 0===e||null===t||null===i)return;(0,J.ZM)(this.form,{overflow:"visible"}),(0,J.ZM)(i,{overflow:"visible"}),(0,J.ZM)(t,{width:"100%"});const a=e.closest("fieldset"),n=null==a?void 0:a.querySelector(".label");if(!n||!a)return;const o=(0,W.tT)("span",{className:"auto-refill-newSign"},(0,W.tT)(de,null),(0,W.tT)("span",{className:"auto-refill-newSign-text"},r.R.new));a.classList.add("auto-refill-fieldset"),n.classList.add("auto-refill-legend"),n.appendChild(o),this.animateIfFromAutorefillLink(a)}animateIfFromAutorefillLink(e){"1"===new URLSearchParams(window.location.search).get("from_autorefill_link")&&(e.classList.add("pulsate-background"),window.setTimeout(()=>{e.classList.remove("pulsate-background")},3e3))}createSubNav(){const e=document.createElement("div");return e.style.marginBottom="15px",e}getForm(){return this.form}updateOptInFlagDisplaySection(){const e=this.form.getField("opt_in_flag_display");if(void 0!==e){var t;const i=e.getLabelContainer();i.style.display="",i.style.visibility="hidden";const s=null===(t=this.country)||void 0===t?void 0:t.toLowerCase(),a=(0,te.BL)(s);e.getWidgetContainer().classList.add("opt-in-flag-display");const n=document.createElement("div");new(l.c.get("OptInFlagDisplayHelpText"))({countryCode:a.flagCode,countryName:a.flagName},n);const o=e.getHelpTextElement();o.style.display="flex",o.appendChild(n),o.appendChild(e.createUnsavedHeptextSpan())}}formatF2FSection(){var e;const t=this.form.getFieldset(s.i._({id:"ZAkY+h",message:"Two Way Video Call Settings"})),i=null==t||null===(e=t.parentElement)||void 0===e?void 0:e.parentElement,a=null==i?void 0:i.querySelector("table"),n=document.createElement("span");n.innerText=s.i._({id:"SWZ6qC",message:"Two Way Video Calls are real-time, two-way audio and video experiences between you and a viewer.\n"});const o=document.createElement("span");o.style.color="#DC0000",o.innerText=s.i._({id:"HNAH1l",message:"Two Way Video Calls are only available via the in-browser broadcaster at this time. Support for external software like OBS is coming soon."}),i&&a&&(i.insertBefore(n,a),i.insertBefore(o,a));const r=this.form.getField("appear_offline_when_f2f");r&&(r.getHelpTextElement().innerText=s.i._({id:"SPcOAZ",message:'Set this option to "Offline" to hide your Two Way Video Call status from other users.\nSet this option to "Online" to let users in your room know you are online and in a Two Way Video Call. This will make Two Way Video Calls function the same as other private shows and is useful if you want to let users know you are coming back.'}));const l=this.form.getField("f2f_private_show_tokens_per_minute");null==l||l.updateLabelText(s.i._({id:"hQyvlO",message:"Two Way Call Tokens Per Minute"}));const d=this.form.getField("f2f_private_show_minimum_minutes");null==d||d.updateLabelText(s.i._({id:"jhNOX8",message:"Two Way Call Minimum Minutes"}))}}var Se=i(4801);const ke="tip-menu-onboarding";class Re extends v.u{constructor(){super(),(0,J.ZM)(this.element,{width:"unset",height:"unset",overflow:"unset",position:"unset",padding:"14px"}),this.reactWrapper=new Se.T({component:"TipMenuBroadcasterEntry",className:"TipMenuBroadcasterEntry",componentProps:{show:!1}}),this.element.appendChild(this.reactWrapper.element)}show(){this.element.style.display="",this.reactWrapper.update({show:!0}),(0,b.bT)("TipMenuSelect",{location:"TipMenuBroadcasterTab"});const e=(0,u.e)("TipMenuOB"),t=(0,oe.Pf)()&&"true"===localStorage.getItem(ke);!e||t||this.onboardingModal||this.element.appendChild(this.createOnboardingPopup())}createOnboardingPopup(){const e=document.createElement("div");e.id=ke;const t=l.c.get("OnboardingModal");return this.onboardingModal=new t({isOpen:!0,onClose:()=>{this.onboardingModal&&(this.onboardingModal.dispose(),this.onboardingModal=void 0),e.remove()},onSave:()=>{this.onboardingModal&&(this.onboardingModal.dispose(),this.onboardingModal=void 0),e.remove(),(0,oe.Pf)()&&localStorage.setItem(ke,"true")},slides:[{title:s.i._({id:"a3eNxg",message:"New Built-In Tip Menu"}),description:s.i._({id:"yy1Xk/",message:"Now, you can build your tip menu into your room, making it easier than ever for fans to find and interact with."}),imgUrl:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_1.png`,imgUrlMobile:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_1_narrow.png`},{title:s.i._({id:"nAqjdf",message:"How to Create a Tip Menu"}),description:s.i._({id:"NQE7AD",message:"To get started, click the Tip Menu tab and select Add Tip Menu"}),imgUrl:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_2.png`,imgUrlMobile:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_2_narrow.png`},{title:s.i._({id:"3++hHL",message:"Set Up Your Menu"}),description:s.i._({id:"fEMHvN",message:"Name your menu and add, edit, arrange, or delete the activities you would like to offer."}),imgUrl:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_3.png`,imgUrlMobile:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_3_narrow.png`},{title:s.i._({id:"sDR+c1",message:"Create and Manage Multiple Menus"}),description:s.i._({id:"sGDbC3",message:"You can save, edit, and manage multiple built-in tip menus at once."}),imgUrl:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_4.png`,imgUrlMobile:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_4_narrow.png`},{title:s.i._({id:"KHO/kx",message:"Track Performance"}),description:s.i._({id:"XhWC+n",message:"Check the stats to see how your fans are interacting with your menus."}),imgUrl:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_5.png`,imgUrlMobile:`${STATIC_URL_ROOT}images/asp/tipmenu_onboarding_step_5_narrow.png`}],lastButtonText:s.i._({id:"tXkhj/",message:"Start"}),showStepNumbers:!0},e),e}hide(){this.element.style.display="none",this.reactWrapper.update({show:!1})}checkBeforeSwitch(e){e()}}function Ee(e){return{date:e.getString("date"),tokens:e.getNumber("tokens"),tokenBalance:e.getNumber("token_balance"),description:e.getString("description"),note:e.getString("note"),username:e.getString("username"),message:e.getString("message"),cashAmount:e.getString("cash_amount"),desiredTokenChange:e.getNumber("desired_token_change"),approved:e.getBoolean("approved"),broadcasterUsername:e.getString("broadcaster_username"),viewerUsername:e.getString("viewer_username"),memberUsername:e.getString("member_username"),subscriptionUsername:e.getString("subscription_username"),photoVideoSetName:e.getString("photovideo_set_name"),photoVideoSetUser:e.getString("photovideo_set_user"),socialMediaName:e.getString("socialmedia_name"),socialMediaOwner:e.getString("socialmedia_owner"),purchaser:e.getString("purchaser"),purchaser_username:e.getString("purchaser_username"),creator_username:e.getString("creator_username"),plan_duration_days:e.getNumber("plan_duration_days"),plan_duration_months:e.getNumber("plan_duration_months"),id:e.getNumber("id"),isPremium:e.getBoolean("is_premium",!1,!1),isFanDiscounted:e.getBoolean("is_fan_discounted",!1,!1),isF2F:e.getBoolean("is_f2f",!1,!1)}}class Ne extends o.y{constructor(e){super(),this.context=e,this.isLoading=!1,this.cashPage=0,this.hasReachedEndOfTransactions=!1,this.hasReachedEndOfCashouts=!1,this.activityColumns=[{header:r.R.dateText,colName:"date",width:"25%"},{header:r.R.actionText,colName:"description",width:"50%"},{header:r.R.tokensCC,colName:"tokens",width:"10%"},{header:r.R.tokenBalanceText,colName:"token_balance",width:"15%"}],this.earningsColumns=[{header:r.R.dateText,colName:"date",width:"40%"},{header:r.R.tokensCC,colName:"tokens",width:"30%"}],this.cashoutColumns=[{header:r.R.dateText,colName:"date",width:"33%"},{header:r.R.tokensCC,colName:"tokens",width:"33%"}],(0,S.fZ)(this.element,"TokenStatsTab"),this.setResourceUrl("api/ts/tipping/token-stats/",this.getResourceParams())}createContent(e){this.activityTableBody=document.createElement("tbody"),this.earningsTableBody=document.createElement("tbody"),this.cashoutTableBody=document.createElement("tbody"),this.activityTable=this.createTable(this.activityColumns,this.activityTableBody),this.earningsTable=this.createTable(this.earningsColumns,this.earningsTableBody),this.cashoutsTable=this.createTable(this.cashoutColumns,this.cashoutTableBody),this.siteDomain=e.domain,this.cashPage=0,this.isLoading=!1,this.hasReachedEndOfTransactions=!1,this.hasReachedEndOfCashouts=!1,this.createSubNav(),this.element.appendChild(this.createTokenBalance(e.token_balance)),this.element.appendChild(document.createElement("hr")),this.context.isAgeVerified?this.context.hasStudio||(this.element.appendChild(this.createTransferTokens(e.cashout_time_left)),this.element.appendChild(document.createElement("hr"))):(this.element.appendChild(this.createVerifyIdentity()),this.element.appendChild(document.createElement("hr"))),this.createTables(e)}createSubNav(){const e=document.createElement("div");if(this.element.appendChild(e),e.appendChild(this.createRefreshLink()),this.context.isAgeVerified){if(!this.context.hasStudio){const t=this.createLink(r.R.detailedIncomeStats,"/affiliates/stats/");t.dataset.testid="detailed-income-stats-button";const i=this.createLink(r.R.paymentInformationForm,"/affiliates/payoutinfo/");i.dataset.testid="payment-information-form-button",e.appendChild(this.createSeparator()),e.appendChild(t),e.appendChild(this.createSeparator()),e.appendChild(i),e.appendChild(this.createLightText(` (${r.R.requiredForPayments})`))}const t=this.createLink(r.R.broadcasterVerificationForm,"/accounts/age_verification/");t.dataset.testid="broadcaster-verification-form-button",e.appendChild(this.createSeparator()),e.appendChild(t)}e.appendChild(this.createSeparator());const t=this.createLink(r.R.downloadTransactionHistory,"/tipping/csv/history/");t.dataset.testid="download-transaction-form-button";let i=!1;t.onclick=e=>{e.preventDefault(),i?(0,n.Q$)(r.R.pleaseWaitForFileToGenerate):(0,n.mf)(r.R.download30Days,()=>{i=!0,window.location.href=(0,k._Y)("/tipping/csv/history")})},e.appendChild(t)}createTables(e){const t=e.txns_fully_loaded?void 0:()=>this.loadMoreTransactions();if(this.addTable(r.R.yourAccountsActivity,this.activityTable,this.activityTableBody,e.transactions,this.activityColumns,"account-activity-table","account-activity",t),this.context.isAgeVerified&&void 0!==e.periods&&this.addTable(r.R.periodEarnings,this.earningsTable,this.earningsTableBody,e.periods,this.earningsColumns,"period-earnings-table","period-earnings"),this.context.hasStudio&&void 0!==e.cashouts){const t=e.cashouts_fully_loaded?void 0:()=>this.loadMoreCashouts();this.addTable(r.R.latestCashOuts,this.cashoutsTable,this.cashoutTableBody,e.cashouts,this.cashoutColumns,void 0,void 0,t),this.cashPage=1}}addTable(e,t,i,s,a,n,o,r){const l=this.createTableSection(e,t,r);void 0!==n&&(l.dataset.testid=n),this.element.appendChild(l),this.addTableRows(i,s,a,o),this.element.appendChild(document.createElement("hr"))}parseData(e){const t=new C.N6(e),i={domain:t.getString("domain"),token_balance:t.getNumber("token_balance"),cashout_time_left:t.getString("cashout_time_left"),transactions:this.parseTransactions(t.getList("transactions")),txns_fully_loaded:t.getBoolean("txns_fully_loaded"),periods:this.parseEarnings(t.getList("periods")),cashouts:this.parseCashouts(t.getList("cashouts")),cashouts_fully_loaded:t.getBoolean("cashouts_fully_loaded",!0,!1)};return t.logUnusedDebugging("TokenStatsTab"),i}parseTransactions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},i=[];for(const s of e){const e=Ee(s);i.push({date:new Date(e.date).toLocaleString(void 0,t),description:this.makeAction(e),tokens:e.tokens,token_balance:e.tokenBalance}),this.maxTransactionID=e.id-1}return i}parseEarnings(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={year:"numeric",month:"short",day:"numeric",timeZone:"UTC"},i=[];for(const s of e){const e=new Date(s.getString("periodStart")).toLocaleString(void 0,t),a=new Date(s.getString("periodEnd")).toLocaleString(void 0,t);i.push({date:`${e} - ${a}`,tokens:s.getNumber("tokens")})}return i}parseCashouts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},i=[];for(const s of e){const e=s.getString("date");i.push({date:new Date(e).toLocaleString(void 0,t),tokens:s.getNumber("tokens")})}return i}createLightText(e){const t=document.createElement("span");return(0,S.fZ)(t,"lightText"),t.innerText=e,t}createRefreshLink(){const e=document.createElement("a");return(0,S.fZ)(e,S.aG.hrefColor),e.onclick=e=>{e.preventDefault(),this.load()},e.innerText=r.R.refreshStats,e.style.cursor="pointer",e.dataset.testid="refresh-stats-link",e}createSeparator(){const e=document.createElement("span");return(0,S.fZ)(e,"separator"),e.style.fontSize="12px",e.innerText=" | ",e}createLink(e,t){const i=document.createElement("a");return(0,S.fZ)(i,S.aG.hrefColor),i.innerText=e,i.href=(0,k._Y)(t),i}createTokenBalance(e){const t=document.createElement("h2");t.innerText=`${r.R.tokenBalanceText}: `;const i=document.createElement("span");return i.innerText=String(e),i.style.textDecoration="underline",t.appendChild(i),this.context.hasStudio&&t.appendChild(document.createTextNode(` (${r.R.tokensAutoCashedAtMidnight})`)),i.dataset.testid="token-balance",t}createVerifyIdentity(){const e=document.createElement("div"),t=document.createElement("p");t.innerText=`${r.R.verifyToEnableTokens}.`;const i=document.createElement("p");return i.appendChild(this.createLink(r.R.broadcasterVerificationForm,"/accounts/age_verification/")),e.appendChild(t),e.appendChild(i),e}createTransferTokens(e){const t=document.createElement("div"),i=document.createElement("h2");i.innerText=r.R.transferTokens,i.dataset.testid="transfer-tokens-label";const s=this.createLink(r.R.transferTokensToCash,"/tipping/cashout_tokens/");s.dataset.testid="transfer-tokens-to-cash-link";const a=document.createElement("p");a.innerText=r.R.transferTokensDateInfo;const n=document.createElement("p");return n.innerText=e,t.appendChild(i),t.appendChild(s),t.appendChild(a),t.appendChild(n),t}createTableSection(e,t,i){const s=document.createElement("div"),a=document.createElement("h2");a.innerText=`${e}:`;const n=this.createTableContainer();return s.appendChild(a),s.appendChild(n),n.appendChild(t),void 0!==i&&n.appendChild(this.createLoadMoreButton(i)),s}createTableContainer(){const e=document.createElement("div");return e.style.width="700px",e.style.height="250px",e.style.overflow="auto",e}createLoadMoreButton(e){const t=document.createElement("button");return(0,S.fZ)(t,"loadMoreButton"),t.dataset.testid="load-more-stats",t.textContent=r.R.loadMore,(0,a.wu)("click",t,()=>{t.textContent=r.R.loadingPlaceholderText,(0,S.fZ)(t,"disabled"),e().then(e=>{e&&(t.style.display="none")}).catch(U.yZ).finally(()=>{(0,S.SA)(t,"disabled"),t.textContent=r.R.loadMore})}),t}createTable(e,t){const i=document.createElement("table");(0,S.fZ)(i,"tokenStatsTable"),i.style.width="675px",i.style.padding="0px",i.style.margin="0px",i.style.borderWidth="1px",i.style.borderStyle="solid",i.style.borderCollapse="collapse",i.style.marginBottom="8px";const s=document.createElement("tr");(0,S.fZ)(s,"rowHeader"),s.style.textAlign="left",s.style.lineHeight="20px";for(const t of e){const e=document.createElement("th");e.style.borderWidth="1px",e.style.borderStyle="solid",e.innerText=t.header,e.style.width=t.width,e.style.fontWeight="normal",s.appendChild(e)}return i.appendChild(t),t.appendChild(s),i}createTableRow(e,t){const i=document.createElement("tr");return e?(0,S.fZ)(i,"rowEven"):(0,S.fZ)(i,"rowOdd"),i.style.textAlign="left",i.style.lineHeight="20px",void 0!==t&&(i.dataset.testid=`${t}-row`),i}addTableRows(e,t,i,s){let a=e.childElementCount;for(const n of t){const t=this.createTableRow(a%2==1,s);for(const e of i){const i=document.createElement("td");i.style.paddingLeft="4px",i.style.borderLeftWidth="1px",i.style.borderRightWidth="1px",i.style.borderLeftStyle="solid",i.style.borderRightStyle="solid",i.style.width=e.width;const s=n[e.colName];s instanceof HTMLElement?i.appendChild(s):i.textContent=String(s),"description"===e.colName&&(i.style.wordBreak="break-all"),t.appendChild(i)}e.appendChild(t),a+=1}}loadMoreCashouts(){return this.isLoading||this.hasReachedEndOfCashouts?Promise.resolve(this.hasReachedEndOfCashouts):(this.isLoading=!0,(0,k.Aw)(`api/ts/tipping/token-stats/?${(0,_.Go)(this.getResourceParams())}`).then(e=>{this.isLoading=!1;const t=new C.N6(e.responseText),i=this.parseCashouts(t.getList("cashouts"));return i.length>0&&(this.cashPage+=1,this.addTableRows(this.cashoutTableBody,i,this.cashoutColumns)),this.hasReachedEndOfCashouts=t.getBoolean("cashouts_fully_loaded"),this.hasReachedEndOfCashouts}).catch(e=>(this.isLoading=!1,this.hasReachedEndOfCashouts=!1,(0,n.Q$)("There was an error loading more data"),!1)))}loadMoreTransactions(){return this.isLoading||this.hasReachedEndOfTransactions?Promise.resolve(this.hasReachedEndOfTransactions):(this.isLoading=!0,(0,k.Aw)(`api/ts/tipping/token-stats/?${(0,_.Go)(this.getResourceParams())}`).then(e=>{this.isLoading=!1;const t=new C.N6(e.responseText),i=this.parseTransactions(t.getList("transactions"));return i.length>0&&this.addTableRows(this.activityTableBody,i,this.activityColumns),this.hasReachedEndOfTransactions=t.getBoolean("txns_fully_loaded"),this.hasReachedEndOfTransactions}).catch(e=>(this.isLoading=!1,this.hasReachedEndOfTransactions=!1,(0,n.Q$)("There was an error loading more data"),!1)))}getResourceParams(){return{max_transaction_id:void 0===this.maxTransactionID?"":String(this.maxTransactionID),cashpage:String(this.cashPage)}}makeAction(e){const t=document.createElement("div"),i=["Tip sent","Tip received"],a=e=>{let t="";return""!==e.broadcasterUsername?t=e.broadcasterUsername:""!==e.memberUsername?t=e.memberUsername:""!==e.subscriptionUsername&&(t=e.subscriptionUsername),t},n=e=>{const t=document.createElement("span");return t.textContent=e,t},o=e=>{const t=document.createElement("span");return t.innerHTML=e,t},l=e=>{const t=document.createElement("span");return t.textContent=e,t.innerHTML},d={"Tip sent":()=>o(r.R.tipSentAction(e.username)),"Tip received":()=>o(r.R.tipReceivedAction(e.username)),"Tokens cashed out":()=>n(this.context.hasStudio?r.R.transferTokensToCash:r.R.transferTokensToCashWithValue(e.cashAmount)),"Tokens cashed to ad credit":()=>n(this.context.hasStudio?r.R.transferTokensToAdvertising:r.R.transferTokensToAdvertisingWithValue(e.cashAmount)),"Tipping Program tokens":()=>n(r.R.referredMember),"Administrator adjusted your tokens":()=>n(r.R.adminAdjustmentAction(e.note)),"Overlimit Purchased tokens":()=>n(e.approved?r.R.overSpendingLimitResolved(e.desiredTokenChange):r.R.overSpendingLimitUnresolved(e.desiredTokenChange,`support@${this.siteDomain}`)),"Group show":()=>o(r.R.groupShowAction(e.broadcasterUsername)),"Private show":()=>o(r.R.privateShowAction(e.broadcasterUsername)),"Private show credited":()=>o(r.R.privateShowAction(e.viewerUsername)),"Group show credited":()=>o(r.R.groupShowAction(e.viewerUsername)),"Spy on private show":()=>o(r.R.spyShowAction(e.broadcasterUsername)),"Spy on private credited":()=>o(r.R.spyShowAction(e.viewerUsername)),"Fan club membership":()=>o(r.R.fanClubShowAction(a(e))),"Fan club credited":()=>o(r.R.fanClubShowAction(a(e))),"Photos/videos purchased":()=>{const t=l(e.photoVideoSetName);return o(r.R.purchasePhotoSet(t,e.photoVideoSetUser))},"Photos/videos sold":()=>{const t=l(e.photoVideoSetName);return o(r.R.sellPhotoSet(t,e.purchaser))},"Social media purchased":()=>{const t=l(e.socialMediaName);return o(r.R.purchaseSocialMediaFrom(t,e.socialMediaOwner))},"Social media sold":()=>{const t=l(e.socialMediaName);return o(r.R.sellSocialMediaTo(t,e.purchaser))},"Promoted room":()=>o(""!==e.broadcasterUsername?r.R.promotedRoomAction(e.broadcasterUsername):r.R.promotedRoom),"Message duration plan purchased":()=>{const t=e.plan_duration_days,i=e.plan_duration_months,a=e.creator_username;if(t){const e=s.i._({id:"kXnYXc",message:"{days, plural, one {{0}} other {{1}}}",values:{0:s.i._({id:"lfMwUW",message:"Outbound message access purchase for {days} day: <a class='hrefColor' href='/{creatorUsername}/' rel='noopener' target='_blank'>{creatorUsername}</a>",values:{days:t,creatorUsername:a}}),1:s.i._({id:"ajBptm",message:"Outbound message access purchase for {days} days: <a class='hrefColor' href='/{creatorUsername}/' rel='noopener' target='_blank'>{creatorUsername}</a>",values:{days:t,creatorUsername:a}}),days:t}});return o(e)}const n=s.i._({id:"7b9ynF",message:"{months, plural, one {{0}} other {{1}}}",values:{0:s.i._({id:"k3IzSQ",message:"Outbound message access purchase for {months} month: <a class='hrefColor' href='/{creatorUsername}/' rel='noopener' target='_blank'>{creatorUsername}</a>",values:{months:i,creatorUsername:a}}),1:s.i._({id:"LycbHo",message:"Outbound message access purchase for {months} months: <a class='hrefColor' href='/{creatorUsername}/' rel='noopener' target='_blank'>{creatorUsername}</a>",values:{months:i,creatorUsername:a}}),months:i}});return o(n)},"Message duration plan sold":()=>{const t=e.plan_duration_days,i=e.plan_duration_months,a=e.purchaser_username;if(t){const e=s.i._({id:"kXnYXc",message:"{days, plural, one {{0}} other {{1}}}",values:{0:s.i._({id:"MmOuXp",message:"Inbound message access purchase for {days} day: <a class='hrefColor' href='/{purchaserUsername}/' rel='noopener' target='_blank'>{purchaserUsername}</a>",values:{days:t,purchaserUsername:a}}),1:s.i._({id:"VidE30",message:"Inbound message access purchase for {days} days: <a class='hrefColor' href='/{purchaserUsername}/' rel='noopener' target='_blank'>{purchaserUsername}</a>",values:{days:t,purchaserUsername:a}}),days:t}});return o(e)}const n=s.i._({id:"7b9ynF",message:"{months, plural, one {{0}} other {{1}}}",values:{0:s.i._({id:"WR7Hh2",message:"Inbound message access purchase for {months} month: <a class='hrefColor' href='/{purchaserUsername}/' rel='noopener' target='_blank'>{purchaserUsername}</a>",values:{months:i,purchaserUsername:a}}),1:s.i._({id:"cF2LKE",message:"Inbound message access purchase for {months} months: <a class='hrefColor' href='/{purchaserUsername}/' rel='noopener' target='_blank'>{purchaserUsername}</a>",values:{months:i,purchaserUsername:a}}),months:i}});return o(n)},"Single message plan purchased":()=>{const t=e.creator_username,i=s.i._({id:"wl5LKX",message:"Outbound single message purchase: <a class='hrefColor' href='/{creatorUsername}/' rel='noopener' target='_blank'>{creatorUsername}</a>",values:{creatorUsername:t}});return o(i)},"Single message plan sold":()=>{const t=e.purchaser_username,i=s.i._({id:"I33Frq",message:"Inbound single message purchase: <a class='hrefColor' href='/{purchaserUsername}/' rel='noopener' target='_blank'>{purchaserUsername}</a>",values:{purchaserUsername:t}});return o(i)}},c={"Private show":()=>o(r.R.premiumPrivateShowAction(e.broadcasterUsername)),"Private show credited":()=>o(r.R.premiumPrivateShowAction(e.viewerUsername))},h=e=>{const t=(0,k._Y)(`/${e}`);return s.i._({id:"w35Lpa",message:"Two Way Private Show: <a class='hrefColor' href=\"{url}\" rel='noopener' target='_blank'>{username}</a>",values:{url:t,username:e}})},p={"Private show":()=>o(h(e.broadcasterUsername)),"Private show credited":()=>o(h(e.viewerUsername))},m=(e,t)=>s.i._({id:"8BsbDn",message:"Fan Discounted Spy Show: <a class='hrefColor' href=\"{url}\" rel='noopener' target='_blank'>{username}</a>",values:{url:t,username:e}}),u={"Spy on private show":()=>o(m(e.broadcasterUsername,(0,k._Y)(`/${e.broadcasterUsername}`))),"Spy on private credited":()=>o(m(e.viewerUsername,(0,k._Y)(`/${e.viewerUsername}`)))};if(e.description in d){let s=d[e.description]();if(e.isPremium?s=e.isF2F?p[e.description]():c[e.description]():e.isFanDiscounted&&(s=u[e.description]()),t.appendChild(s),i.includes(e.description)&&""!==e.message){const i=document.createElement("div");i.className="transactionMessage",i.textContent=e.message,t.appendChild(i)}}else t.textContent=e.description;return t}}var De;!function(e){e.APPS="apps",e.TIP_MENU="tip_menu",e.GAMES="games",e.BIO="Bio",e.SETTINGS="settings",e.PAID_MESSAGING="paid_messaging",e.CONTEST_STATS="Contest Stats",e.TOKEN_STATS="token_stats",e.BROADCASTER_STATS="broadcaster_stats",e.SHARE="Share",e.MEMBERSHIPS="memberships"}(De||(De={}));const Le={[De.BIO]:"bio",[De.SETTINGS]:"settings",[De.PAID_MESSAGING]:"paid_messaging",[De.CONTEST_STATS]:"contest",[De.TOKEN_STATS]:"tokens",[De.BROADCASTER_STATS]:"broadcasterStats",[De.SHARE]:"share",[De.MEMBERSHIPS]:"memberships",[De.APPS]:"",[De.TIP_MENU]:"",[De.GAMES]:""},Ae=new m.c_("broadcasterTabSwitched");class Fe extends f.S{constructor(e,t,i){var s;super(),this.context=t,this.tabStorageKey="selectedBroadcasterTab",this.allowTabPageActions=!1,this.element.style.minHeight="325px";const a=new Ce(this.context.country),n=new $.li(e,t.isAgeVerified,t.canUploadContent);if(!(0,y.j)()){const e=(0,u.e)("AppDirectoryV3")?Z:H;this.addTab(De.APPS,r.R.apps,new e(i)),(0,u.e)("TipMenuBI")&&this.addTab(De.TIP_MENU,r.R.tipMenu,new Re),this.addTab(De.GAMES,r.R.games,new Q)}this.addPaidMessagingTabIfEligible();const o=this.addTab(De.BIO,r.R.bioText,n),l=this.addTab(De.SETTINGS,r.R.settingsAndPrivacy,a),d=new ne({roomName:e,isBroadcastPage:!(0,y.j)(),optInFlagDisplay:null!==(s=t.optInFlagDisplay)&&void 0!==s&&s,country:t.country});d.shouldDisplayNotification&&(this.tabBar.addChild(d),d.renderNotification({positioningEl:l.anchor.element,onActivated:()=>{if(this.activeTabName===De.SETTINGS){const e=a.getForm().getField("opt_in_flag_display");void 0!==e&&e.setChecked(!0)}},onCleanup:()=>{this.tabBar.removeChild(d)}})),p.mG.isWhiteLabel||this.addTab(De.CONTEST_STATS,r.R.contestStatsText,new w),this.context.isTestbed||this.addTab(De.TOKEN_STATS,r.R.tokenStats,new Ne(t)),this.createStatsTab(t.statsDashboardEnabled),p.mG.isWhiteLabel||this.addTab(De.SHARE,r.R.shareText,new T.$),this.addTab(De.MEMBERSHIPS,r.R.memberships,new ee),this.tabBar.addChildBefore(new E(t),this.tabsWrapper),this.defaultTab=this.setInitialTab();const h=this.constructExpandableDropDownMenu();this.tabsWrapper.addChild(h),this.tabsWrapper.element.dataset.paction="RoomTabs",o.anchor.element.classList.add("nooverlay"),o.anchor.element.setAttribute("data-tab","bio"),A.eN.listen(()=>{this.makeTabActive(De.SETTINGS,void 0,()=>{const e=a.getForm().getField("allow_private_shows");void 0!==e&&e.getWidget().focus()})}),A.ww.listen(()=>{this.makeTabActive(De.BIO),n.setState($.zc.EDIT_BIO,()=>{var e,t;null===(e=n.editBroadcastForm)||void 0===e||e.focusField("spoken_languages_strict");const i=null===(t=n.editBroadcastForm)||void 0===t?void 0:t.getField("spoken_languages_strict");i&&i instanceof c.X&&i.checkboxesDropdown.showElement()})}),this.allowTabPageActions=!0}addPaidMessagingTabIfEligible(){if((0,g.d1)()&&this.context.isAgeVerified){const e={id:"3C8xr1",message:"Paid Messaging"};this.addTab(De.PAID_MESSAGING,s.i._(e),new d)}}setInitialTab(){let e=De.BIO;(0,y.j)()||(this.makeTabActive(De.GAMES),e=De.APPS,this.makeTabActive(e));const t=new URLSearchParams(window.location.search).get("tab"),i={settings_email:De.SETTINGS,settings:De.SETTINGS,paid_messaging:De.PAID_MESSAGING,bio:De.BIO,tokens:De.TOKEN_STATS,broadcasterStats:De.BROADCASTER_STATS,apps:De.APPS,tip_menu:De.TIP_MENU,contest:De.CONTEST_STATS,share:De.SHARE,memberships:De.MEMBERSHIPS},s=null===t?void 0:i[t],a=this.checkTabLocalStorage();return void 0!==s?this.makeTabActive(s):void 0!==a&&this.makeTabActive(a),e}makeTabActive(e,t,i){const s=this.activeTabName,a=this.getActiveTab();void 0===a||s!==De.BIO&&s!==De.PAID_MESSAGING||s===e?this.switchTab(s,e,t,i):a.instance.checkBeforeSwitch(()=>{this.switchTab(s,e,t,i)}),this.allowTabPageActions&&s!==e&&(0,b.bT)("RoomTabClicked",{tabName:e})}switchTab(e,t,i,s){let a=this.getActiveTab();a&&"function"==typeof a.instance.disableOutsideClickDetection&&a.instance.disableOutsideClickDetection(),super.makeTabActive(t,i,s),e!==t&&Ae.fire(e),a=this.getActiveTab(),a&&"function"==typeof a.instance.enableOutsideClickDetection&&a.instance.enableOutsideClickDetection()}navigate(e){super.navigate(e);const t=Le[this.activeTabName];(0,y.j)()&&void 0!==t&&""!==t&&(0,_.KZ)(new Map([["tab",t]]))}createStatsTab(e){var t;(0,y.j)()&&!0===(null===(t=h.Bm.current.loggedInUser)||void 0===t?void 0:t.isStaff)&&!0===e&&this.addTab(De.BROADCASTER_STATS,r.R.broadcasterStats,new V)}}},5417:(e,t,i)=>{i.d(t,{S:()=>c});var s=i(7623),a=i(9447),n=i(6039),o=i(4873),r=i(1848),l=i(2709),d=i(3955);class c extends l.u{constructor(){super(),this.tabs={},this.tabStorageKey="selectedRoomTab",this.element.id="roomTabs",this.element.style.position="static",this.element.style.boxSizing="border-box",this.element.style.overflow="visible",this.element.style.paddingBottom="1px",this.element.dataset.testid="room-tabs",this.tabBar=new r.m,this.tabBar.element.dataset.testid="room-tab-bar",(0,a.fZ)(this.tabBar.element,"tabBar"),(0,d.ZM)(this.tabBar,{height:"30px",padding:"8px 4px",boxSizing:"border-box",overflow:"visible",borderRadius:"2px 2px 0 0"}),this.addChild(this.tabBar),this.tabsWrapper=new r.m,(0,d.ZM)(this.tabsWrapper,{height:"24px",top:"-2px"}),this.tabBar.addChild(this.tabsWrapper)}addTab(e,t,i){const s=this.createBaseTab(e,t,i);return this.tabsWrapper.addChild(s.anchor),this.tabs[e]=s,s.anchor.element.dataset.testid=`room-tab-${e}`,s}hide(e){const t=this.tabs[e];void 0!==t&&(t.anchor.element.style.display="none")}navigate(e){this.makeTabActive(e,void 0),this.setTabLocalStorage(this.activeTabName)}createBaseTab(e,t,i){const s=new o.g2("a");(0,a.fZ)(s.element,"tabLink"),s.element.href="#",s.element.innerText=t,this.styleTabLink(s,e),e===this.activeTabName&&this.styleTabForOpen(s);const n={anchor:s,instance:i};return this.tabs[e]=n,i.hide(),this.addChild(i),s.element.onclick=t=>{this.navigate(e)},s.onCollapseEvent.listen(t=>{e===this.activeTabName?this.styleTabForOpen(s):this.styleTabForClose(s),t?((0,a.fZ)(s,"tabCollapsed"),s.element.style.cssFloat="",s.element.style.marginTop="2px"):((0,a.SA)(s,"tabCollapsed"),s.element.style.cssFloat="left",s.element.style.marginTop="0")}),n}styleTabLink(e,t,i){e.element.style.width="",e.element.style.height="17px",e.element.style.borderRadius="4px 4px 0 0",e.element.style.textDecoration="none",e.element.style.marginRight="2px",e.element.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",e.element.style.fontSize="13px",e.element.style.padding="4px 8px 4px 8px",e.element.style.position="relative",e.element.style.cssFloat="left",e.element.style.display="block",!0===i&&(e.element.style.display="none"),e.element.onpointerenter=t=>{"mouse"===t.pointerType&&this.styleTabForOpen(e)},e.element.onpointerleave=i=>{"mouse"===i.pointerType&&this.activeTabName!==t&&this.styleTabForClose(e)}}checkTabLocalStorage(){if((0,s.Pf)()){const e=window.localStorage.getItem(this.tabStorageKey);if(null!==e&&void 0!==this.tabs[e])return e}}setTabLocalStorage(e){(0,s.Pf)()&&window.localStorage.setItem(this.tabStorageKey,e)}styleTabForOpen(e){(0,a.fZ)(e.element,"tabOpen")}styleTabForClose(e){(0,a.SA)(e.element,"tabOpen")}hideTabAnchor(e){const t=this.tabs[e];void 0!==t&&(this.activeTabName===e&&this.makeTabActive(this.defaultTab),t.anchor.hideElement())}showTabAnchor(e){const t=this.tabs[e];void 0!==t&&t.anchor.showElement()}makeTabActive(e,t,i){if(this.activeTabName===e)return void(void 0!==i&&i());const s=this.tabs[e];if(void 0!==s&&(s.anchor.element.style.display="block"),void 0!==s&&s.anchor.isShown()){for(const e of Object.keys(this.tabs)){const t=this.tabs[e];void 0!==t&&(this.styleTabForClose(t.anchor),t.instance.hide())}this.styleTabForOpen(s.anchor),s.instance instanceof n.R3?s.instance.show(t):s.instance.show(void 0,i),this.activeTabName=e}}getActiveTab(){return this.tabs[this.activeTabName]}constructExpandableDropDownMenu(){const e=new o.Dw;return this.styleTabLink(e,"",!1),(0,d.ZM)(e,{display:"inline-block",height:"24px",width:"32px"}),(0,a.fZ)(e,"tabLink"),e.hideElement(),(0,d.ZM)(e.dropDown,{padding:"10px 1px",borderWidth:"1px",borderStyle:"solid"}),(0,a.fZ)(e.dropDown,"room-tabs-dropdown-border"),e.setSpacerWidth(15),e}}},5963:(e,t,i)=>{i.d(t,{zR:()=>N});var s=i(9512),a=i(2543),n=i(7623),o=i(9447),r=i(9603),l=i(6784),d=i(2939),c=i(2709),h=i(5020),p=i(8423),m=i(7463),u=i(7407),g=i(5173),b=i(7162),y=i(9937),f=i(634),v=i(213),x=i(5216),w=i(3955),T=i(4947),_=i(1372);const C=(e,t)=>(0,_.tT)("span",{style:{padding:"7px",borderRadius:"4px",borderWidth:"1px",borderStyle:"solid",boxSizing:"border-box",position:"relative",display:"inline-block",cursor:"pointer"},onClick:t,colorClass:"button"},e),S="notificationModalOptionsSaved",k={numTimeoutsKey:"numPushNotificationTimeouts2",timeoutDateKey:"pushNotificationTimeout2"};class R extends f.x4{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,!0),this.currentlyEmailSubscribed=!1,this.emailAddress="",this.verificationEmailSent=!1,this.emailOptHidden=!1,this.browserOptHidden=!1,this.submitting=!1}initUI(){var e,t=this;super.initUI();const i=e=>{void 0===e||400===e.status?(0,v.Q$)(`${T.R.browserSubmitErrorMessage} ${T.R.browserSubmitErrorMessagePt2}`):(window.localStorage.removeItem(this.numTimeoutsLocalStorageKey),window.localStorage.removeItem(this.timeoutDateLocalStorageKey))},s=e=>{b.textContent=e,b.style.display="block",!this.browserOptHidden&&this.browserCheckbox.isChecked()&&this.subscribeToBrowserPush(()=>{(0,o.fZ)(this.browserCheckbox.element,"greenCheckbox"),this.browserDiv.style.opacity="0.5",this.browserTextSpan.style.cursor="",this.browserCheckbox.element.style.cursor="",this.browserOptHidden=!0,this.browserCheckbox.disable(),this.browserTextSpan.textContent=T.R.browserNotificationEnabled,this.browserTextSpan.onclick=()=>{}},()=>{f.style.display="block"}),this.submitting=!1},a=(e,a,n)=>{const o=e?this.emailInput.value.trim().toLowerCase():this.emailAddress;a&&""===o?s(T.R.addEmailAddress):this.verificationEmailSent&&!n&&this.emailAddress===o?this.showSuccessScreen(!1):function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!e||t.emailIsValidated||t.verificationEmailSent&&t.emailAddress===i?(0,m.O3)(e):(0,m.O3)(e,i)}(e,o).then(e=>{this.showSuccessScreen(a&&"true"===e),!this.browserOptHidden&&this.browserCheckbox.isChecked()&&this.subscribeToBrowserPush(()=>{},e=>{i(e)})}).catch(e=>{s(e)})},n=()=>{!this.browserOptHidden&&this.browserCheckbox.isChecked()?this.subscribeToBrowserPush(()=>{this.showSuccessScreen(!1)},e=>{i(e),this.submitting=!1,this.close()}):this.showSuccessScreen(!1)},r=(0,h.Wj)("","","240px",1);(0,o.fZ)(r,"divot"),(0,o.fZ)(r,"divotTop"),this.emailInput=(0,_.tT)("input",{style:{position:"relative",height:"22px",width:"278px",padding:"5px",margin:"8px 0px",fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif",borderWidth:"1px",borderStyle:"solid",borderRadius:"4px",display:"none"},colorClass:"textInput",onInput:()=>{""!==this.emailAddress&&(this.emailVerificationDiv.style.display=this.emailInput.value===this.emailAddress?"inline-block":"none")}}),this.emailInput.placeholder=T.R.emailAddressText;const d={top:"4px",marginRight:"6px",cursor:"pointer"};this.emailInput.dataset.pactionName="Email Input";const c="denied"===(null===(e=window.Notification)||void 0===e?void 0:e.permission);this.emailCheckbox=new y.m(16),this.browserCheckbox=new y.m(16,!1,()=>{c&&((0,v.Q$)("Browser Notifications are disabled"),this.browserCheckbox.setCheckedDirectly(!1))}),(0,w.ZM)(this.emailCheckbox,d),(0,w.ZM)(this.browserCheckbox,d),(0,l.wu)("click",this.emailCheckbox.element,()=>{this.emailCheckbox.isChecked()?this.emailIsValidated||(this.emailInput.style.display="block",this.emailInput.focus()):this.emailInput.style.display="none",(0,u.bT)("FollowEmailSettingsClicked",{checked:this.emailCheckbox.isChecked()})}),this.browserTextSpan=(0,_.tT)("span",{style:{cursor:"pointer"},onClick:()=>{c?(0,v.Q$)("Browser notifications are disabled"):this.browserCheckbox.element.click()}},T.R.browserNotificationLabel);const p=(0,_.tT)("div",{style:{cursor:"pointer",marginBottom:"6px",paddingLeft:"2px",fontSize:"12px"},colorClass:"verifyLink",onClick:()=>{(0,x.KF)("emailvalidation/resend/",{}).then(()=>{p.style.display="none",g.style.display="block",this.verificationEmailSent=!0}).catch(()=>{(0,v.Q$)(T.R.emailSendErrorMessage)})}},T.R.resendVerificationEmail),g=(0,_.tT)("div",{style:{marginBottom:"6px",paddingLeft:"2px",display:"none",fontSize:"12px"}},T.R.checkYourEmailToVerifyText),b=(0,_.tT)("div",{style:{marginBottom:"6px",paddingLeft:"2px",display:"none"},colorClass:"errorMessage"}),f=(0,_.tT)("div",{style:{marginTop:"6px",paddingLeft:"2px",display:"none"},colorClass:"errorMessage"},T.R.browserSubmitErrorMessage);this.emailVerificationDiv=(0,_.tT)("div",{style:{display:"none"}},p,g),this.emailCheckboxDiv=(0,_.tT)("div",{style:{position:"relative",margin:"4px 0px"}},this.emailCheckbox.element,(0,_.tT)("div",{style:{width:"140px",display:"inline-block",cursor:"pointer"},onClick:()=>{this.emailCheckbox.element.click()}},(0,_.tT)("span",null,T.R.emailLabel),(0,_.tT)("span",{style:{position:"relative",fontFamily:"UbuntuBold, Arial, Helvetica, sans-serif",fontSize:"10px",padding:"2px",borderRadius:"2px",marginLeft:"6px",bottom:"1px"},colorClass:"popularBadge"},T.R.popularCAPS))),this.emailDiv=(0,_.tT)("div",{style:{position:"relative"}},this.emailCheckboxDiv,(0,_.tT)("div",null,this.emailInput),this.emailVerificationDiv,b),this.browserDiv=(0,_.tT)("div",{style:{position:"relative",display:"none",marginBottom:"12px"}},this.browserCheckbox.element,this.browserTextSpan,f),this.prompt=(0,_.tT)("span",{style:{position:"relative",lineHeight:"22px",display:"block",width:"304px"}},T.R.notifyWhenBroadcastersOnlineMessage,":"),this.notNowButton=(0,_.tT)("span",{style:{position:"relative",marginLeft:"12px",cursor:"pointer"},onClick:()=>{this.onDenyClick(),this.close()}},T.R.notNowText),this.confirmButton=C(T.R.saveNotificationSettings,()=>{if(this.submitting)return;this.submitting=!0;const e=this.emailCheckbox.isChecked(),t=e&&!this.emailIsValidated,i=e!==this.currentlyEmailSubscribed;this.emailOptHidden||!t&&!i?n():a(e,t,i)}),this.buttonsDiv=(0,_.tT)("div",{style:{position:"relative",marginBottom:"4px",cursor:"pointer"}},this.confirmButton,this.notNowButton),this.settingsOptionsDiv=(0,_.tT)("div",null,this.prompt,this.emailDiv,this.browserDiv,this.buttonsDiv),this.bodyDiv=(0,_.tT)("div",{style:{position:"relative",width:"100%",padding:"7px",fontSize:"14px",fontFamily:"UbuntuRegular, Arial, Helvetica, sans-serif",boxSizing:"border-box"}},this.settingsOptionsDiv),this.element=(0,_.tT)("div",{style:{position:"absolute",width:"max-content",top:"30px",right:"0px",borderStyle:"solid",zIndex:1001},id:"FollowSettingsModal",colorClass:"tooltip"},this.bodyDiv,r)}canRequestPermission(){return super.canRequestPermission()&&null===window.localStorage.getItem(S)}setOriginalState(e){this.currentlyEmailSubscribed=e.emailSubscribed,this.emailIsValidated=e.emailValidated,this.emailAddress=e.emailAddress,this.emailCheckbox.setChecked(this.currentlyEmailSubscribed),this.emailInput.value=this.emailAddress,""===this.emailAddress||this.emailIsValidated||(this.emailVerificationDiv.style.display="inline-block"),this.currentlyEmailSubscribed&&(this.emailIsValidated?(this.emailDiv.style.display="none",this.emailOptHidden=!0):this.emailInput.style.display="block")}showBrowserOption(){this.browserDiv.style.display="block",this.browserOptHidden=!1}showSuccessScreen(e){this.settingsOptionsDiv.style.display="none";const t={marginBottom:"16px",lineHeight:"22px"};let i;i=e?(0,_.tT)("div",{style:t,dangerouslySetInnerHTML:{__html:T.R.emailSavedAndVerifyText}}):(0,_.tT)("div",{style:t},T.R.preferencesSavedText),this.bodyDiv.appendChild((0,_.tT)("div",null,i,C(T.R.close,()=>{this.close()}))),this.submitting=!1,window.localStorage.setItem(S,"true")}}const E="FollowButton";class N extends c.u{constructor(e,t){super(),this.tabBar=e,this.element=document.createElement("div"),this.followApiPromiseChain=Promise.resolve(),this.followButton=new L(this,t),this.followNotificationButton=new A(this,t),this.unfollowButton=new D(this,t),this.element.style.display="inline-block",this.element.style.cssFloat="right",this.element.style.position="relative",this.element.style.width="auto",this.element.style.right="1px",this.buildTooltip(),e.appendChild(this.tooltip),this.element.appendChild(this.followButton.element),this.element.appendChild(this.followNotificationButton.element),this.element.appendChild(this.unfollowButton.element),(()=>{const e=t;d.X0.listen(t=>{t.dossier.room!==e&&this.hideFollowTooltip()})})()}buildTooltip(){this.tooltip=(0,r.q)({content:T.R.instantNotificationMessage,hasHTML:!1,width:220,divotPosition:h.Wi.Top,divotLeftOrTop:"170px",borderWidth:1}),this.tooltip.style.lineHeight="22px",this.tooltip.style.fontSize="14px",this.tooltip.style.padding="8px 0px 8px 8px"}showFollowTooltip(){this.tooltip.style.display="block",this.repositionChildren()}hideFollowTooltip(){this.tooltip.style.display="none"}showFollow(){this.followButton.element.style.display="inline",this.unfollowButton.element.style.display="none",this.followNotificationButton.element.style.display="none"}showUnfollow(e){this.followButton.element.style.display="none",this.unfollowButton.element.style.display="inline",this.followNotificationButton.updateFollowNotificationFrequency(e),this.followNotificationButton.element.style.display="inline"}repositionChildren(){const e=this.element.getBoundingClientRect();this.tooltip.style.top=`${this.tabBar.offsetHeight+8}px`,this.tooltip.style.left=e.left+(0,n.J8)().scrollLeft-this.tooltip.offsetWidth+this.element.clientWidth-16+"px"}queueFollowApi(e){this.followApiPromiseChain=this.followApiPromiseChain.then(e)}}class D extends b.r{constructor(e,t){super(t),(0,o.fZ)(this.element,"unfollowButton"),this.textContainer.innerText=T.R.unfollow,this.element.style.marginRight="0px",this.element.style.right="",this.element.style.borderRadius="3px 0px 0px 3px",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.dataset.testid="unfollow-button",this.element.onclick=()=>{e.queueFollowApi(()=>(0,m.QH)(this.roomName,void 0,E))},this.element.onmouseenter=()=>{e.showFollowTooltip()},this.element.onmouseleave=()=>{e.hideFollowTooltip()}}}class L extends b.r{constructor(e,t){super(t),this.settingsPopupTriggered=!1,(0,o.fZ)(this.element,"followButton"),this.textContainer.innerText=T.R.follow,this.element.style.marginRight="0px",this.element.style.right="",this.element.dataset.testid="follow-button",a._g.listen("followingEvent",t=>{var i;this.roomName===t.roomName&&(t.following?this.settingsPopupTriggered||t.followNotificationFrequency===s.JJ.NONE||(this.showNotificationSettingsModal(e),this.settingsPopupTriggered=!0):(null===(i=this.notificationSettingsModal)||void 0===i||i.close(),this.settingsPopupTriggered=!1))}),this.element.onclick=()=>{e.queueFollowApi(()=>(0,m.j4)(this.roomName,void 0,E))},this.element.onmouseenter=()=>{e.showFollowTooltip()},this.element.onmouseleave=()=>{e.hideFollowTooltip()}}showNotificationSettingsModal(e){const t=new R;if(this.notificationSettingsModal=t,t.canRequestPermission()){const i=window.isBrowserNotificationSupported,s=window.isSubscribedToBrowserNotifications,a=void 0===i||!0!==i()||void 0===s||!(0,n.Pf)();(0,m.iD)().then(i=>{if("boolean"==typeof i)return;const n={emailAddress:i.email,emailSubscribed:i.activated,emailValidated:i.validated},o=i.activated&&i.validated,r=()=>{const i=d.X0.listen(e=>{e.dossier.room!==this.roomName&&t.close()});t.setOriginalState(n),this.addChild(t,e.element),t.closed.once(()=>{this.removeChild(t),i.removeListener()})};a?o||r():(s(!1,()=>{t.showBrowserOption(),r()}),s(!0,()=>{o||r()}))}).catch(e=>{error(`Error fetching email settings: ${e}`)})}}}class A extends b.r{constructor(e,t){super(t),(0,o.fZ)(this.iconContainer,"notification-btn-icon"),(0,o.fZ)(this.iconContainer,"static"),this.iconContainer.style.width="20px",this.iconContainer.style.height="20px",this.iconContainer.style.display="inline-block",this.iconContainer.style.backgroundRepeat="no-repeat",this.updateFollowNotificationFrequency(s.JJ.SMART),this.textContainer.innerText="",(0,o.fZ)(this.element,"FollowNotificationButton"),this.element.style.padding="0px 2px 5px 2px",this.element.style.marginRight="0px",this.element.style.right="",this.element.dataset.testid="follow-notification-button",this.element.style.borderWidth="1px 1px 1px 0",this.element.style.borderRadius="0 3px 3px 0",this.element.style.borderStyle="solid",a._g.listen("followingEvent",e=>{this.roomName===e.roomName&&this.updateFollowNotificationFrequency(e.followNotificationFrequency)}),this.element.onclick=()=>{void 0===this.menu?(this.menu=new B(this.followNotificationFrequency),this.menu.selectionChange.listen(t=>{(0,u.bT)("FollowFrequencyBellClicked",{previous_frequency:this.followNotificationFrequency,frequency:t}),this.followNotificationFrequency=t,e.queueFollowApi(()=>(0,m.Tf)(this.roomName,t))}),this.menu.element.style.marginTop="36px",this.menu.toggle({top:-7,left:e.element.offsetWidth-117}),this.addChild(this.menu,e.element)):this.menu.makeVisible()},(()=>{const e=this.roomName;d.X0.listen(t=>{var i;t.dossier.room!==e&&(null===(i=this.menu)||void 0===i||i.hide())})})()}updateFollowNotificationFrequency(e){this.followNotificationFrequency=e,this.iconContainer.className="",(0,o.fZ)(this.iconContainer,"notification-btn-icon"),(0,o.fZ)(this.iconContainer,"static"),(0,o.fZ)(this.iconContainer,this.followNotificationFrequency.toString()),void 0!==this.menu&&this.menu.setSelectedItem(e,!1)}}function F(e){switch(e){case s.JJ.ALL:return T.R.notifyOptionAlways;case s.JJ.SMART:return T.R.notifyOptionAuto;case s.JJ.NONE:return T.R.never;default:return""}}class M extends c.u{constructor(e,t){super(),this.onItemClick=e,this.data=t,(0,o.fZ)(this.element,"notification-item"),this.element.style.padding="4px 0 4px 0",this.element.style.cursor="pointer",this.element.style.boxSizing="border-box",this.element.style.position="relative",this.element.style.overflow="visible",this.element.style.borderWidth="1px",this.element.style.borderStyle="solid",this.element.style.borderTop="0 none",this.element.style.borderBottom="0 none",this.element.dataset.testid="follow-notification-item",this.icon=document.createElement("span"),(0,o.fZ)(this.icon,"notification-btn-icon"),(0,o.fZ)(this.icon,t.toString()),this.icon.style.padding="0 8px 0 12px",this.icon.style.width="20px",this.icon.style.height="20px",this.icon.style.verticalAlign="middle",this.icon.style.display="inline-block",this.icon.style.backgroundRepeat="no-repeat",this.icon.style.backgroundPosition="center center",this.icon.title=F(t),this.element.appendChild(this.icon),this.name=document.createElement("span"),this.name.style.margin="0px",this.name.style.padding="0px 4px 0px px",this.name.innerText=F(t),this.name.dataset.testid=`${t.toLocaleLowerCase()}-notification-label`,this.element.appendChild(this.name),(0,l.wu)("click",this.element,()=>{this.onItemClick(t)})}select(){(0,o.fZ)(this.element,"selected"),this.name.style.fontWeight="bold",this.name.style.fontFamily="UbuntuBold, Helvetica, Arial, sans-serif"}deselect(){(0,o.SA)(this.element,"selected"),this.name.style.fontWeight="normal",this.name.style.fontFamily="UbuntuNormal, Helvetica, Arial, sans-serif"}}class B extends g.Q{constructor(e){super(),this.selectedItem=e,this.width=120,this.visible=!1,this.selectionChange=new p.c_("selectionChange");const t=[];(0,o.fZ)(this.element,"notificationBtnMenu"),this.element.style.padding="0px",this.element.style.width=`${this.width}px`,this.element.style.textAlign="left",this.element.style.fontSize="11px",this.element.style.lineHeight="14px",this.element.style.borderRadius="4px",this.overlay.style.zIndex="1002",this.element.style.zIndex="1003",this.element.style.overflow="visible",this.element.style.removeProperty("height");const i=document.createElement("div");(0,o.fZ)(i,"title"),i.innerText=T.R.notifyMe,i.style.padding="12px",i.style.boxSizing="border-box",i.style.position="relative",i.style.overflow="visible",i.style.borderWidth="1px",i.style.borderStyle="solid",i.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",i.style.fontSize="15px",i.style.borderTopWidth="1px",i.style.borderTopLeftRadius="4px",i.style.borderTopRightRadius="4px",this.element.appendChild(i),this.addBookend(!1);const a=[s.JJ.ALL,s.JJ.SMART,s.JJ.NONE];for(const e of a){const i=new M(e=>this.onItemClick(e),e);this.addChild(i),t.push(i)}this.addBookend(!0),this.menuItems=t,this.setSelectedItem(e,!1),this.overlayClick.listen(()=>{this.hide()})}addBookend(e){const t=document.createElement("div");(0,o.fZ)(t,"bookend"),t.style.height="4px",t.style.boxSizing="border-box",t.style.position="relative",t.style.borderWidth="1px",t.style.borderStyle="solid",t.style.borderTop="0 none",e?(t.style.borderBottomLeftRadius="4px",t.style.borderBottomRightRadius="4px",t.style.borderBottomWidth="1px",t.style.borderBottomStyle="solid",t.style.paddingTop="4px"):t.style.borderBottom="0 none",this.element.appendChild(t)}isVisible(){return this.visible}show(e){this.isVisible()||(this.element.style.top=`${e.top}px`,this.element.style.left=`${e.left}px`,this.makeVisible(),this.repositionChildrenRecursive())}makeVisible(){this.isVisible()||(this.element.style.display="inline-block",this.showOverlay(),this.visible=!0)}hide(){this.isVisible()&&(super.hide(),this.visible=!1)}toggle(e){this.isVisible()?this.hide():this.show(e)}setSelectedItem(e,t){e!==this.selectedItem&&(this.selectedItem=e,t&&this.selectionChange.fire(e));for(const t of this.menuItems)t.data===e?t.select():t.deselect()}onItemClick(e){this.hide(),this.setSelectedItem(e,!0)}}},6452:(e,t,i)=>{i.d(t,{$:()=>c});var s=i(9512),a=i(9447),n=i(5216),o=i(6844),r=i(2939),l=i(2709),d=i(4947);class c extends l.u{constructor(){super(),this.loadingMessage=document.createElement("span"),this.header=document.createElement("div"),this.shareRows=[],this.element.id="shareTab",(0,a.fZ)(this.element,a.aG.defaultColor),this.element.style.minHeight="395px",this.element.style.padding="15px",this.element.style.width="100%",this.element.style.boxSizing="border-box",this.element.style.position="static",this.loadingMessage.style.display="block",this.loadingMessage.style.fontSize="12px",this.loadingMessage.textContent="loading...",this.element.appendChild(this.loadingMessage);const e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div");e.textContent=d.R.tokenLinkCodesText,t.textContent=d.R.earnTokensForRegisteredUsers,i.textContent=d.R.linkCodeMessage,(0,a.fZ)(e,"title"),e.style.fontSize="14.4115px",e.style.lineHeight="20.1761px",e.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",e.style.marginBottom="20px",e.dataset.testid="share-title",t.style.fontSize="14.4115px",t.style.lineHeight="20.1761px",t.style.margin="14.4115px 0",t.dataset.testid="share-text",i.style.marginBottom="12.0108px",i.style.fontSize="12.0108px",i.style.lineHeight="16.8px",i.style.fontWeight="bold",i.dataset.testid="share-subtext",this.header.appendChild(e),this.header.appendChild(t),this.header.appendChild(i),this.element.appendChild(this.header),r.BR.listen(e=>{this.currentDossier=e.dossier,this.loadingMessage.style.display="block",this.header.style.display="none"}),r.X0.listen(e=>{this.currentDossier=e.dossier,this.loadingMessage.style.display="block",this.header.style.display="none",this.clean(),"block"===this.element.style.display&&this.show()})}loadContent(){return new Promise((e,t)=>{(0,n.Aw)(`api/ts/chat/share/?room=${this.currentDossier.room}`).then(t=>{const i=new s.N6(t.responseText),a={tourRoomUrl:i.getString("tourroomurl"),tourTopUrl:i.getString("tourtopurl"),embedRoomUrl:i.getString("embedroomurl"),embedTopUrl:i.getString("embedtopurl")};i.logUnusedDebugging("ShareTab"),e(a)}).catch(t)})}clean(){this.shareRows.forEach(e=>{this.element.removeChild(e)}),this.shareRows=[]}handleShareResponse(e){const t=(e,t)=>{const i=document.createElement("div"),s=document.createElement("label"),n=document.createElement("input");i.style.margin="12.0108px 0",i.style.lineHeight="16.8px",n.type="text",n.value=t,(0,a.fZ)(s,"link"),s.textContent=e,s.style.display="block",s.style.fontSize="12.012px",s.style.lineHeight="16.8px",s.style.fontWeight="bold",s.style.cursor="pointer",s.style.width="375px",s.dataset.testid="share-link",s.onclick=()=>{n.select()},(0,a.fZ)(n,"urlInput"),n.style.display="block",n.style.borderRadius="4px",n.style.fontSize="12px",n.style.fontFamily="Arial, Helvetica, sans-serif",n.style.verticalAlign="middle",n.style.width="375px",n.style.marginTop="4px",n.style.height="20px",n.style.lineHeight="18px",n.style.borderWidth="1px",n.style.borderStyle="solid",n.style.padding="2px 4px",n.readOnly=!0,n.dataset.testid="share-url-input",n.onclick=()=>{n.select()},this.shareRows.push(i),i.appendChild(s),i.appendChild(n),this.element.appendChild(i)},i="height=528 width=850 style='border: none;'",o=(0,s.VE)(this.currentDossier.room);t(`${d.R.shareCamText(o)}:`,e.tourRoomUrl),t(`${d.R.shareText} Chaturbate.com:`,e.tourTopUrl),t(`${d.R.embedCamText(o)}:`,`<iframe src='${e.embedRoomUrl}' ${i}></iframe>`),t(`${d.R.embedCBTopCamText}:`,`<iframe src='${e.embedTopUrl}' ${i}></iframe>`);const r=document.createElement("div"),l=document.createElement("a");(0,a.fZ)(l,"link"),l.href=(0,n._Y)("/affiliates/stats/"),l.textContent=d.R.affiliateProgramStatsText,l.dataset.testid="affiliate-stats-link",l.onmouseenter=()=>{l.style.textDecoration="underline"},l.onmouseleave=()=>{l.style.textDecoration="none"},(0,a.fZ)(r,a.aG.defaultColor),r.textContent=d.R.affiliateStatsDetails,r.style.fontSize="12.012px",r.style.lineHeight="16.8px",r.style.marginTop="30px",r.dataset.testid="share-more-details",r.appendChild(l),this.shareRows.push(r),this.element.appendChild(r)}show(){this.loadingMessage.style.display="block",this.header.style.display="none",this.element.style.display="block",this.clean(),(0,o.ok)()||this.loadContent().then(e=>{this.loadingMessage.style.display="none",this.header.style.display="block",this.handleShareResponse(e)}).catch(()=>{})}hide(){this.element.style.display="none",this.loadingMessage.style.display="none"}checkBeforeSwitch(e){e()}}},7162:(e,t,i)=>{i.d(t,{r:()=>n});var s=i(2939),a=i(2709);class n extends a.u{constructor(e){super(),this.iconContainer=document.createElement("span"),this.textContainer=document.createElement("span"),this.element.appendChild(this.iconContainer),this.element.appendChild(this.textContainer),this.hideElement(),this.element.style.width="auto",this.element.style.fontFamily="UbuntuMedium, Helvetica, Arial, sans-serif",this.element.style.fontSize="12px",this.element.style.padding="3px 8px 2px",this.element.style.position="relative",this.element.style.top="-4px",this.element.style.right="1px",this.element.style.cssFloat="right",this.element.style.borderRadius="3px",this.element.style.cursor="pointer",this.element.style.marginRight="5px",this.element.style.height="15px",this.element.style.lineHeight="1.4",void 0!==e&&this.setRoomName(e),s.X0.listen(e=>{this.setRoomName(e.chatConnection.room())})}setRoomName(e){this.roomName=e}}},8713:(e,t,i)=>{i.d(t,{Y:()=>y,j:()=>g});var s=i(6064),a=i(6844),n=i(2939),o=i(2709),r=i(6716),l=i(1456),d=i(74),c=i(3128),h=i(9447),p=i(3192),m=i(4947);class u extends o.u{constructor(e){super(),this.roomContentsPadding=4,(0,h.fZ)(this.element,"BaseRoomContents"),this.element.style.position="static",this.element.style.display="block",this.element.style.height="auto",this.element.style.borderRadius="4px",this.element.style.padding=`${this.roomContentsPadding}px`,this.element.style.margin="12px 0 17px 12px",this.element.style.overflow="visible",this.element.style.boxSizing="border-box",this.element.style.width="calc(100% - 22px)",this.offlineRoomNotice=document.createElement("div"),(0,h.fZ)(this.offlineRoomNotice,"offlineRoomNotice"),this.offlineRoomNotice.innerText=m.R.roomOfflineMessage,this.offlineRoomNotice.style.display="none",this.offlineRoomNotice.style.fontFamily="UbuntuRegular, Arial, Helvetica, sans-serif",this.offlineRoomNotice.style.fontSize="12px",this.offlineRoomNotice.style.fontWeight="bold",this.offlineRoomNotice.style.margin="13px 0",this.element.appendChild(this.offlineRoomNotice),this.topSectionWrapper=document.createElement("div"),(0,h.fZ)(this.topSectionWrapper,"topSectionWrapper"),this.topSectionWrapper.style.width="100%",this.topSectionWrapper.style.height="auto",this.element.appendChild(this.topSectionWrapper);const t=new p.t3(e.roomName,e,e.dossier);this.addChild(t)}}const g=()=>b;let b=!1;class y extends o.u{constructor(e){super(),b=!0;const t=document.getElementById("main");t.style.font="1em 'UbuntuRegular',Arial,Helvetica,sans-serif",t.appendChild(this.element),this.genderTabs=this.addChild(new l.q(e)),n.BR.listen(e=>{this.createRoomContents(e)}),n.t7.listen(e=>{this.createDeniedContents(e)}),r.VZ.listen(e=>{window.location.pathname=`/${e}/`}),this.element.style.position="static",this.element.style.marginRight="15px",this.element.style.boxSizing="border-box",this.element.style.minHeight="400px",this.element.focus(),this.setupLoginOverlay(),this.repositionChildrenRecursive(),this.afterDOMConstructedIncludingChildren()}setupLoginOverlay(){d.pL.listen(e=>{(0,s.DC)({fromFeature:e})}),(0,a.n)(()=>{d.pL.fire(!0)})}createRoomContents(e){const t=new u(e);this.profileContents=this.addChild(t),t.topSectionWrapper.style.position="fixed",t.topSectionWrapper.style.top="999999px"}createDeniedContents(e){this.profileContents=this.addChild(new c.G(e))}}}}]);
//# sourceMappingURL=8713-prod-dcad1450c19dce12ae05.js.map